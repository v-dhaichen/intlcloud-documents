

Aegis Anti-DDoS는 기초 보안 전략을 제공합니다. 전략은 AI 지능형 엔진, IP 프로필, 행위 모드 분석 등 알고리즘을 기반으로 하여, 일반적인 DDoS 공격에 효율적으로 대응할 수 있습니다. 어떠한 특별하거나 비즈니스 특징을 시뮬레이션할 공격 행위가 발생하는 경우, Aegis Anti-DDoS는 고급 전략을 제공하고 비즈니스 특징 또는 공격 행위에 따라 구체적인 방어를 제공합니다. 특정 공격에 대해 맞춤형 방어를 제공합니다.

고급 전략은 고도 방어 IP, 고도 방어 패키지가 방어하는 IP에 바인딩할 수 있습니다. 사용자는 비즈니스 플랫폼의 자체 요구에 따라 [고급 보안 전략](https://cloud.tencent.com/document/product/685/18807), [HTTP CC 방어 전략](https://cloud.tencent.com/document/product/685/18806), [워터마크 방어](https://cloud.tencent.com/document/product/685/18804)를 구성할 수 있습니다. 현재 비즈니스 요청이 공격 행위를 감지하면, 고급 전략 구성에 따라 공격 트래픽에 대해 클리닝을 진행합니다.

## 사용자 지정 고급 보안 방어 전략
|고급 보안 방어 전략|CC 방어 전략|
|--|--|
|프로토콜 사용 금지|HTTP QPS 요청 임계값|
|포트 사용 금지|블랙리스트/화이트리스트 구성(URL, IP)|
|IP 블랙리스트/화이트리스트|CC 사용자 지정 방어|
|메시지 필터링 특징|매치 모드: 차단, 인간-기계 검증|
|해외 트래픽 사용 금지|속도 제한 모드: 오리진 IP 접근 속도|
|널(Null) 링크 방어|-|

## 고급 보안 방어 전략

- 프로토콜 또는 포트 사용 금지
사용자는 비즈니스가 사용하지 않은 프로토콜 또는 포트를 사용 금지할 수 있습니다. 공격 행위를 감지하면, 방어 시스템은 해당 프로토콜 또는 포트의 트래픽을 클리닝합니다.
- IP 블랙리스트/화이트리스트 설정
화이트리스트 IP의 비즈니스 트래픽에 대해 방어 시스템은 공격 감지 또는 트래픽 클리닝을 하지 않습니다. 블랙리스트 IP의 비즈니스 트래픽은 클리닝됩니다. IP 블랙리스트/화이트리스트는 최대 50개 IP 주소를 추가할 수 있습니다
- 메시지 필터링 특징
비즈니스 메시지 특징 또는 공격 메시지 특징에 따라 메시지 길이, 또는 메시지 길이 + 로드 특징을 조건으로 하는 전략을 구성할 수 있습니다. 메시지가 전략 조건과 매칭되면, 오리진 IP를 버리거나 블랙리스트에 추가하거나 연결을 차단할 수 있습니다.
- 널(Null) 링크 방어
널(Null) 링크 공격에 대응합니다. 고도 방어 패키지가 방어하는 IP에 널(Null) 링크 방어가 필요한 경우, 해당 기능을 시작할 수 있습니다.
- 해외 트래픽 거부
중국(대륙 및 홍콩, 마카오, 대만)을 제외한 TCP 트래픽 요청을 금지할 수 있습니다.

**사례 설명:**
다음은 정상적인 비즈니스 메시지입니다.
![1](https://main.qcloudimg.com/raw/c52a92b15c4c99d0a581462b40ca536b.png)

분석하고 결과 특징은 다음과 같습니다.
- 대상 포트는 80입니다.
- 패킷 길이는 1000바이트 이내입니다.
- 로드는 “GET”으로 시작하며, “Host” 필드를 가집니다.

메시지 특징 필터링 전략을 구성하여 정상적인 비즈니스 특징에 부합하지 않는 메시지를 블록합니다.
다음의 조건에 부합하는 메시지:
- 대상 포트는 80입니다.
- 패킷 길이는 1000 바이트 이상입니다.
- 로드가 “GET”로 시작하지 않으며, “Host” 필드를 가지지 않습니다.

**조작 실행:**
상기 조건을 동시에 만족하면 블록합니다.

![2](https://main.qcloudimg.com/raw/ac5f39c3d4fb85446dda26ad7775d16d.png)

## CC 방어 전략

- HTTP 요청 수 임계값
HTTP 요청 수가 설정한 QPS 값을 초과하면 CC 방어를 트리거합니다.
- URL 화이트리스트
화이트리스트에 추가한 URL에 대해 방어 시스템이 더 이상 CC 공격 감지와 방어를 하지 않습니다.
- IP 블랙리스트/화이트리스트
화이트리스트 IP의 HTTP 접근 요청에 대해 방어 시스템이 CC 공격 감지와 방어를 하지 않습니다. 블랙리스트 IP의 HTTP 접근 요청이 거절됩니다. IP 블랙리스트/화이트리스트는 최대 50개 IP 주소를 추가할 수 있습니다
- CC 사용자 지정 방어
주로 HTTP 필드 헤더와 관련된 필드에 차단 또는 인간-기계 검증 등 작업을 실행합니다.
 - 매치 모드: HTTP 대응 필드 헤더의 요청과 매칭하면, 차단, 인간-기계 검증 등 작업을 실행합니다.
 - 속도 제한 모드: 오리진 IP 접근에 대해 속도 제한 처리를 진행합니다. 전역 또는 지정 URL의 오리진 IP에 대해 속도 제한을 지원합니다. 구성한 후에 모든 오리진 IP가 본 전략이 바인딩한 고도 방어 IP(또는 고도 방어 패키지 IP)에 접근하면, 접근 빈도는 구성값에 따라 속도 제한을 받게 됩니다. 구성값 0이면 활성화되지 않습니다. 지정 URL의 속도 제한 전략의 우선 순위는 전역 속도 제한 전략보다 높습니다.


## 워터마크 방어
- 방어 IP
해당 IP와 지정 포트에 접근하는 비즈니스 트래픽에 대해 워터마크 감지를 진행하고, 공격 메시지를 인식하여 버립니다.
- TCP 프로토콜 방어 포트, UDP 프로토콜 방어 포트
TCP/UDP 방어 포트는 최대 5개 포트를 구성할 수 있습니다. 다른 포트 세그먼트는 서로 겹칠 수 없습니다. 시작/종료 포트 번호가 같으면 동일한 포트로 간주됩니다. TCP 또는 UDP 포트 세그먼트 중 하나 이상을 구성해야 합니다.
- UDP 워터마크 스트리핑
"UDP 메시지 워터마크 자동 스트리핑"을 선택합니다. 데이터 메시지는 보안 방어 시스템을 통과하면 UDP 메시지의 워터마크를 자동 스트리핑하고 다시 오리진 서버에 전달합니다. 또한, UDP 메시지에 워터마크 라벨의 오프셋을 지정할 수 있습니다. 가능 범위: 0 - 100. 주의사항: 방어 시스템이 UDP 프로토콜 워터마크를 스트리핑할 필요가 없는 경우, 서비스측은 워터마크를 스트리핑할 개조도 여전히 필요합니다.
- 화이트리스트
"오리진 IP 화이트리스트 활성화"를 선택하여 IP를 추가합니다. 화이트리스트의 IP에 접근하는 메시지에 대해 워터마크 감지를 진행하지 않습니다.

사용자는 워터마크 방어를 액세스하여 가상 비즈니스 메시지 공격과 재전송 공격 등 4계층 CC 공격을 전면적으로 방어할 수 있습니다.
- 비즈니스와 Aegis Anti-DDoS 시스템이 워터마크 알고리즘과 키를 공유하고 있습니다.
- 클라이언트가 발송하는 메시지는 모두 워터마크 특징이 삽입되어 있습니다. 하지만 공격 메시지에는 워터마크 특징이 없습니다.
- 방어 시스템은 공격 메시지를 선별하여 버립니다.



