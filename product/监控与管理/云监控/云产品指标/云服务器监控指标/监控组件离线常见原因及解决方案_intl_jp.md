監視コンポーネントのオフライン判定条件：
>クラウドサービスの監視コンポーネント1台が継続して5分間データを報告しなかった場合、プラットフォームはこのCVMの監視コンポーネントが既にオフライン状態にあると見なします。

以下では、監視コンポーネントのオフラインの主な原因とそれに対応するトラブルシューティングをリストします。

### 1、ユーザーがコンソールまたはコマンドラインを介してCVMを操作します
CVMはシャットダウンの操作を行った後はシャットダウンの状態にあり、それにより監視コンポーネントがオフラインとなりデータがなくなります。

ユーザーはCVMコンソールを介してまたはCVMにログインして、再起動の操作を行い、CVMをアップグレードし、再インストールし、イメージを作成するなど一般的なCVMの維持管理操作を行うと、CVMの監視データの報告がタイムアウトによりオフラインとなります。

**トラブルシューティング方式：**その時の時刻に基づき、CVMに関連する維持管理操作が存在しているかをトラブルシューティングすることができ、操作ログはCVM詳細ページの操作ログで確認できます。

### 2、CVMの高負荷
CVMのCPUが高負荷で、メモリがフルに使用され、帯域幅がフルに使用されると、監視コンポーネントはデータ報告が異常です。


**トラブルシューティング方式：**CVMにログインし、または監視ビューでCPUとメモリが存在しているか、帯域幅の使用が`100%`に達している状況か確認することができ、`100%`に達している場合、実際の状況に基づきサービスを拡張ができます。



### 3、CVM内部のDNS構成エラー

CVMのプライベートネットワークのDNS構成エラーにより、監視コンポーネントがデータを報告できません。

**トラブルシューティング方法：**Tencent CloudのプライベートネットワークのDNS構成については、[プライベートネットワークのDNSのアクセスと設定](https://cloud.tencent.com/document/product/213/5225#dns-.E6.9C.8D.E5.8A.A1.E5.99.A8.E5.9C.B0.E5.9D.80)を参照することができます。



### 4、その他の問題のトラブルシューティングガイド

#### Linuxシステムー監視コンポーネント管理ツールを使用してトラブルシューティングを行います

1. 監視コンポーネント管理ツールをダウンロードします

   ```
   wget http://update2.agent.tencentyun.com/update/monitor_agent_admin && chmod +x monitor_agent_admin
   ```

2. 監視コンポーネントをインストールします

   ```
   ./monitor_agent_admin install
   ```

3. 以下のコマンドを実行し、検査して修復します。それでも問題が解決しない場合、チケットによりツールから出力されたファイル**monitor_agent_admin-\*.zip**を当社に提出してください。専門スタッフがお客様と一緒に処理します。

   ```
   sh ./monitor_agent_admin check
   ```

> 監視コンポーネント管理ツールのその他の操作
>
> 1. 監視コンポーネント管理ツールをダウンロードします
>
>    ```
>    wget http://update2.agent.tencentyun.com/update/monitor_agent_admin && chmod +x monitor_agent_admin
>    ```
>
> 2. 監視コンポーネントをインストールします
>
>    ```
>     ./monitor_agent_admin install
>    ```
>
> 3. 監視コンポーネントをアンインストールします
>
>    ```
>    ./monitor_agent_admin uninstall
>    ```
>
> 4. 監視コンポーネントを再インストールします
>
>    ```
>    ./monitor_agent_admin reinstall
>    ```
>
> 5. 検査して修復します
>
>    ```
>    ./monitor_agent_admin check
>    ```
>
> 6. 再起動します
>
>    ```
>    ./monitor_agent_admin restart
>    ```

### 

#### Windowsシステムー一般的な問題のトラブルシューティングのプロセス

1. ​



1. agentを既にインストールしている場合、barad_agentのログが1分ごとにリアルタイムにローリングされ、報告が完了しているかを判定します。 

   > windowsシステムログのパス：C:\Program Files\QCloud\Monitor\Barad\logs\info.log
   > また、各ログには「nws send succ」があります。

2. ログがローリングされない場合、agentスケジューリングの問題である可能性があります（一般的にlinuxシステムで発生し、システムの時間が変更される可能性があります）
   barad_agentを再起動して、同時にログ/usr/local/qcloud/monitor/barad/log/executor.logにエラーがないか確認することができます。

3. 報告できなかった場合（nws send fail）、ログに基づき具体的な問題を判定する必要があります（例：タイムアウト、サーバーに接続できない、ドメイン名を解析できないなど）。 
   報告アドレスはetcディレクトリのplugin.iniファイル中のnws_urlで見ることができます。

4. 報告にnws send failが現れなかった場合

   1）uuidが変更されていないか検査します

   uuidファイルのパス：

   > linux：/etc/uuid
   > windows：c:\windows\system32\drivers\etc\uuid
   > c:\windows\system32\drivers\etc\ディレクトリにおけるuuidフォーマットで命名された最新ファイル

   2）uuidファイルが変更されていない場合、CVMのタイムスタンプを検出します

    linuxはコマンド`/usr/sbin/ntpdate ntpupdate.tencentyun.com`を使用して時間調整が50S以内であるかを確認することができ、時間の関係が大きい場合、barad_agentを再起動後に回復できます。![](https://main.qcloudimg.com/raw/2be108329ee18a199ae1d5b28a571460.png)

5. 以上のステップでも問題が解決しない場合、チケットを提出してスタッフに処理を依頼してください。
