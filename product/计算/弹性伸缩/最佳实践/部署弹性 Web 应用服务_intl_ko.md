ㄹ본 프로젝트는 Tencent Cloud [AS](https://cloud.tencent.com/product/as)을 이용하여 Web 응용프로그램을 유연하게 배포할 수 있도록 도와줍니다. Auto Scaling은 가장 적합한 인스턴스 수량으로 비즈니스 상황에 대응하도록 돕습니다. 비즈니스 수요가 증가하면, 적당량의 CVM 인스턴스를 자동으로 늘리고, 비즈니스 수요가 감소하면, 불필요한 CVM 인스턴스를 제거하여 장치 이용률을 높임으로써 배포 및 인스턴스 비용을 절약합니다.
이 프로젝트는 클러스터를 기반으로 배포된 웹 사이트/APP에 적합합니다. 본 프로젝트의 웹사이트는 간단하게 구조됩니다. 응용프로그램 서버 클러스터가 한 개만 있습니다. 복잡한 웹사이트의 경우 응용프로그램 서버 클러스터, 프런트 엔드 서버 클러스터 및 캐시 서버 클러스터 등이 있습니다. 각 클러스터는 유사한 작업을 수행할 수 있으며 각 클러스터는 하나의 확장 그룹에 해당합니다.
**적합한 조건**
- 웹사이트가 클러스터를 기반으로 실행 중이며 클러스터에 둘 이상의 서버가 있습니다.
- 웹사이트에 비교적으로 긴 시간의 유휴가 있습니다. 대부분 웹사이트의 피크 시간은 8시간을 초과하지 않으며 남은 16시간은 유휴 서버를 제거할 수 있으며 이 방식으로 비용을 대폭적으로 절감할 수 있습니다.

이 프로젝트에서는 레저 웹사이트를 예로 들어 설명합니다. 이 기간의 피크 시간은 20:00에서 24:00 사이입니다.
- 오프 피크의 부하에 따라 고정 리소스를 배포하려면 연/월정액 요금제 CVM을 사용할 수 있습니다.
- 피크 시간은 사용량 기반 요금제 CVM을 적용합니다. 시간 제한 태스크를 통해 20:00에 1대의 CVM을 추가하고 24:00에 제거합니다.
![](//mc.qcloudimg.com/static/img/cd4f9a05923871165c6e7184b984336e/image.png)

### A. 클러스터 사용자 지정 이미지 생성
클러스터에 기존 1대의 CVM을 기반으로 이미지를 생성합니다. 사용자 지정 이미지 생성에 관한 정보는 [사용자 지정 이미지 생성](/doc/product/213/4942)을 참조하십시오.
1. [CVM 콘솔](https://console.cloud.tencent.com/cvm/index)에 로그인합니다.
2. 이미지를 생성하기 전에 인스턴스를 종료해야 합니다. 종료할 인스턴스를 체크하고 상단의 [종료]를 클릭합니다.
3. 이미지를 생성할 인스턴스의 우측에 [추가]를 클릭하고 [이미지 생성]을 클릭합니다.
4. 팝업창에서 **이미지 이름**과 **이미지 설명**을 입력하고 [확인]을 클릭한 후 제출합니다. 사용자 지정 이미지를 생성하는 데 일정한 시간이 걸리며 기다리십시오.
5. 생성 성공 후, 좌측 탐색 모음에서 [이미지]를 클릭하면 이미지 리스트로 이동하여 세부 정보를 볼 수 있습니다.

> **주의:**
> 이미지의 응용프로그램을 운영 체제와 함께 활성화할 수 있도록 미리 이미지 내의 환경을 배포해야 합니다. 이 경우 추가된 CVM은 수동으로 개입할 필요없이 직접적으로 작동할 수 있습니다.

### B. 시동 구성 생성

확장 시 AS는 **시동 구성**을 템플릿으로 하여 CVM을 생성합니다. 따라서 사전에 **시동 구성**을 통해 지역, 모델, 및 이미지를 지정해야 합니다.

1. [AS 콘솔](https://console.cloud.tencent.com/autoscaling/config)에 로그인하고 탐색 모음의 [시동 구성]을 클릭합니다.
2. 프로젝트와 지역을 선택하고 여기서 Web 응용프로그램이 위치한 프로젝트와 지역을 반드시 선택해야 합니다. 본 프로젝트는 "기본 프로젝트"와 "화남 지역(광저우)'를 선택합니다.
![](//mc.qcloudimg.com/static/img/653ebf516d940a90fd79728e5d319cdc/image.png)
3. 모델을 선택합니다. 서버 모델에 관련 더 많은 정보는 [권장 모델](https://cloud.tencent.com/act/recommended)을 참조하십시오. 본 프로젝트에서는 1계열 표준형 1코어 CPU 1GB 메모리를 선택합니다.
![](//mc.qcloudimg.com/static/img/301ed9b779010186705029631853a6ab/image.png)
4. 이미지를 선택합니다. [사용자 지정 이미지]에서 방금 생성한 이미지를 지정합니다. 본 프로젝트에서는 "Test"로 예를 듭니다.
![](//mc.qcloudimg.com/static/img/192691062ce8fa93f2bbcd0f02af5bc2/image.png)
5. 스토리지와 네트워크를 선택합니다.
![](//mc.qcloudimg.com/static/img/2ec4987b14f97966851f90849c016167/image.png)
6. 정보를 설정합니다. 비밀번호와 보안 그룹을 설정합니다.
![](//mc.qcloudimg.com/static/img/ee9caea59c347e581fb82c273407e28d/image.png)

### C. 조정 그룹 생성
1. [AS 콘솔](https://console.cloud.tencent.com/autoscaling)에서 [조정 그룹] > [생성]을 클릭하여 클러스터의 관련 관리 정보를 입력합니다. 정보를 확인한 후, [다음 단계]를 클릭합니다.
 - **이름**: 조정 그룹의 이름입니다. 본 프로젝트는 "응용프로그램 서버 클러스터"로 예를 듭니다.
 - **최소 조정 수**: 클러스터 서버의 하한입니다. 본 프로젝트는 0을 입력하면 됩니다.
 - **초시 인스턴스 수**: 조정 그룹을 막 생성한 경우 자동 생성한 서버 수량입니다. 일반적으로 조정 그룹을 만들 때 자동으로 CVM이 생성되지 않습니다. 0을 입력하는 것이 좋습니다.
 - **최대 조정 수**: 클러스터 서버의 상한으로 필요에 따라 입력합니다. 5를 예로 들면 이는 조정 그룹이 최대 5개 CVM을 가짐을 의미합니다.
 -**시동 구성**: 방금 생성한 시동 구성을 선택합니다.
 - **지원하는 네트워크**: 세션 서버의 네트워크 환경입니다. 본 프로젝트는 “기본 네트워크”를 선택합니다.
 - **지원하는 가용 영역**: CVM의 조정 가능 영역을 선택합니다. 세션 서버의 가용 영역에 따라 선택하면 됩니다. 본 프로젝트는 "광저우 2 지역"을 선택합니다.
 - **제거 전략**: "가장 오래된 CVM 제거"와 "최신 CVM 제거" 두 가지 전략을 제공합니다. 본 프로젝트는 "가장 오래된 CVM 제거"를 선택합니다.
![](//mc.qcloudimg.com/static/img/1dfcdab95c12ad0b999a09de98e8508a/image.png)
2. 로드밸런서를 선택합니다. 추가한 CVM은 연결한 로드벨런서에 자동으로 탑재됩니다. 사용자는 기존의 로드밸런서를 선택하거나 새로 생성할 수 있습니다. 확인 후, [완료]를 클릭하면 생성이 완료됩니다.
 - **CLB**: 클러스터의 CLB를 선택합니다. 본 프로젝트는 CLB를 선택하지 않습니다.
![](//mc.qcloudimg.com/static/img/2771bbfe477d54400fcb72b21014668b/image.png)

### D. 기존 CVM 인스턴스를 조정 그룹에 추가

1. [AS 콘솔](https://console.cloud.tencent.com/autoscaling)에서 조정 그룹 이름을 클릭하여 조정 그룹 관리 페이지에 들어가 [CVM 연결] > [CVM 추가]를 클릭합니다.
![](//mc.qcloudimg.com/static/img/9063e98237388d8bfbbb72f267103a42/image.png)

2. 팝업된 대화 창에서 클러스터에 기존 서버를 선택해 조정 그룹을 추가합니다. 현재 오프 피크이면 원가를 절감하도록 클러스터 중 충분히 이용되지 않는 서버를 반환하길 권장합니다.
![](https://mc.qcloudimg.com/static/img/8a3ba69a5ffc9e9004e91c8a300149c2/image.jpg)

3. [제거 보호 설정]을 클릭하면 해당 CVM에 제거 보호가 설정됩니다. 이럴 경우, 조정 그룹에서 축소를 위해 제거되지 않도록 합니다. 이 방법으로 이 CVM은 클러스터에서 항상 작동하며 AS는 이를 변경하지 않습니다.
![](https://mc.qcloudimg.com/static/img/de9840c7507a725d836f02ca77fd0490/image.jpg)

### 5. 확장/축소 전략 설정

AS는 시간 제한 확장/축소 및 알람을 기반으로 동적 확장을 지원하며 확장/축소 알림을 수신하고 확장/축소 기록을 확인할 수 있습니다. 
![](//mc.qcloudimg.com/static/img/9ff9af152c4d99a1955c837f1177f131/image.png)
본 프로젝트는 시간 제한 확장/축소를 예로 들어 설명합니다. 조정 그룹 관리 페이지에서 [시간 제한 태스크] > [+생성]을 클릭하면 새 시간 제한 작업 페이지가 나옵니다.
![](//mc.qcloudimg.com/static/img/98f7fd2432fd64b88c3090fa0487a2da/image.png)
-  **시간 제한 확장 태스크 설정**
![](https://mc.qcloudimg.com/static/img/e3c790c1fa7594643bcfb591e5ca949b/image.jpg)
> **주의:**
> Tencent Cloud의 CVM을 생성하는 데 약 1분 정도 걸립니다. 사용자 지정 이미지가 비교적 큰 경우 더 많은 시간이 필요할 수 있습니다. 시작 시간을 5분 정도로 미리 설정길 권장합니다.
- **시간 제한 축소 태스크 설정**
![](https://mc.qcloudimg.com/static/img/e0fce491429b83cc77fa244db5382778/image.jpg)
이 경우, 웹사이트의 백엔드 클러스터가 "1개의 고정 응용프로그램 서버 + 피크 시간 시 시간 제한 작업으로 생성한 응용프로그램 서버 1개"로 변경되었습니다.

