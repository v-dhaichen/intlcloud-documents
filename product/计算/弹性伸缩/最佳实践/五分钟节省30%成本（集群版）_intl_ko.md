이 방안은 클러스터를 기반으로 배포된 웹 사이트/APP에 적합합니다.

비즈니스가 다음의 조건을 만족하면 5분의 시간으로 해당 방안을 설정하면 30%의 비용을 절감할 수 있습니다.

- 웹사이트가 클러스터를 기반으로 실행 중이며 클러스터에 둘 이상의 서버가 있습니다.
- 웹사이트에 비교적으로 긴 시간의 유휴가 있습니다. Tencent Cloud의 통계에 따르면 90%의 클러스터가 00:00에서 09:00까지 부하가 30% 이하입니다.

대부분 웹사이트의 피크 시간은 8시간을 초과하지 않으며 남은 16시간은 유휴 서버를 제거할 수 있으며 이 방식으로 비용을 대폭적으로 절감할 수 있습니다.

이 문서에서는 레저 웹사이트를 예로 들어 설명합니다. 이 웹사이트의 피크 시간은 20:00에서 24:00까지입니다.

## 방안 설명

- 오프 피크의 부하에 따라 고정 리소스를 배포하려면 연/월정액 요금제 CVM을 사용할 수 있습니다.
- 피크 시간의 부족하는 부분은 사용량 기반 요금제 CVM을 적용합니다. 시간 제한 태스크를 통해 20:00에 1대의 CVM을 추가하고 24:00에 제거합니다.

기존 솔루션과 새로운 솔루션 비교:
![](https://mc.qcloudimg.com/static/img/cd4f9a05923871165c6e7184b984336e/image.png)

## 수익
원래 방안에는 2 개의 4코어 4GB CVM이 필요하다고 가정합니다. 이 새로운 방안은 4 코어 4GB CVM 1 대와 매일 4 시간 작동하는 임시 CVM으로 변경되어 비용을 약 30% 절약할 수 있습니다.

이 예시에서 작은 웹사이트의 경우 연간 1,500CNY를 절약할 수 있습니다.

![](https://mc.qcloudimg.com/static/img/a72443a68d6f16e0a8a37d39f3b73aa7/image.jpg)

### 구체적 조작

인스턴스의 웹사이트는 간단하게 구조됩니다. 응용프로그램 서버 클러스터가 한 개만 있습니다. 복잡한 웹사이트의 경우 응용프로그램 서버 클러스터, 프런트 엔드 서버 클러스터 및 캐시 서버 클러스터 등이 있습니다. 각 클러스터는 유사한 작업을 수행할 수 있으며 각 클러스터는 하나의 확장 그룹에 해당합니다.

![](https://mc.qcloudimg.com/static/img/ba977d67b59a73d6a137323b61d17ec4/image.png)

### 단계1. 클러스터 CVM의 사용자 지정 이미지 생성

이 단계는 매우 간단하여 한 대의 기성 클러스터 CVM을 기반으로 하여 제작하면 됩니다. 문의사항이 있으면 [사용자 지정 이미지 제작 >>](https://cloud.tencent.com/document/product/213/4942)을 참고하십시오.

> 주의:
> 이미지의 응용프로그램을 운영 체제와 함께 활성화할 수 있도록 미리 이미지 내의 환경을 배포해야 합니다. 이 경우 확장된 CVM은 수동으로 개입할 필요없이 직접적으로 작동할 수 있습니다.

### 단계2. 시동 구성 생성

확장 시 AS는 시동 구성을 템플릿으로 CVM을 생성합니다. 따라서 사전에 시동 구성을 통해 지역, 모델, 및 이미지를 지정해야 합니다.

1. [AS 콘솔](https://console.cloud.tencent.com/autoscaling/config)에 로그인하고 탐색 모음의 [시동 구성]을 클릭합니다.

2. 프로젝트와 지역을 선택하고 여기서 Web 응용프로그램이 위치한 프로젝트와 지역을 반드시 선택해야 합니다.
![](https://mc.qcloudimg.com/static/img/653ebf516d940a90fd79728e5d319cdc/image.png)

3. 다음 조작은 CVM 구매와 비슷하고 가이드에 따라 시동 구성 생성을 완료할 수 있습니다. 사용자 지정 이미지에서 막 생성한 이미지를 지정합니다.
![](https://mc.qcloudimg.com/static/img/4cecf25e8ad9caa67271159c67d0b770/image.png)


### 단계3. CVM을 위한 조정 그룹 생성

[AS 콘솔](https://console.cloud.tencent.com/autoscaling)에서 [생성]을 클릭하고 다음과 같이 클러스터 관리 정보를 입력합니다.

- **이름**: 요구에 따라 이름을 지정합니다. 예를 들어 “응용프로그램 서버 클러스터”를 입력합니다.
- **최소 조정 수**: 클러스터 서버의 하한입니다. 예시는 0을 입력하면 됩니다.
- **초시 인스턴스 수**: 조정 그룹을 막 생성했을 때의 **자동 생성**한 CVM 수량입니다. 일반적으로 조정 그룹을 만들 때 자동으로 CVM이 생성되지 않습니다. 0을 입력하는 것이 좋습니다.
- **최대 조정 수**: 클러스터 서버의 상한으로 필요에 따라 입력합니다. 5를 예로 들면 이는 조정 그룹이 최대 5개 CVM을 가짐을 의미합니다.
- **시동 구성**: 방금 생성한 시동 구성을 선택합니다.
- **지원하는 네트워크**: 세션 서버의 네트워크 환경입니다. 일반적으로 “기본 네트워크”를 선택합니다.
- **지원하는 가용 영역**: CVM의 조정 가능 영역을 선택합니다. 세션 서버의 가용 영역에 따라 선택하면 됩니다.
- **제거 전략**: 기본값을 선택합니다.
- **CLB**: 클러스터의 CLB를 선택합니다.
![](https://mc.qcloudimg.com/static/img/88d97cc3150b98741d52c4abd4b801df/image.jpg)

마지막으로 [확인]을 클릭하여 구성을 완료합니다.

### 단계4. 기존 CVM을 조정 그룹에 추가

1. [콘솔](https://console.cloud.tencent.com/autoscaling)에서 조정 그룹 이름 클릭해 관리 페이지로 진입해 페이지 하단에서 [CVM 추가]를 클릭합니다.
![](https://mc.qcloudimg.com/static/img/d940c118ffa3e443543ffbc5a7b71daf/image.jpg)

2. 팝업된 대화 창에서 클러스터에 기존 서버를 선택해 조정 그룹을 추가합니다. 현재 오프 피크이면 클러스터 중 충분히 이용되지 않는 서버는 반환되어 원가를 절감할 수 있습니다.
![](https://mc.qcloudimg.com/static/img/8a3ba69a5ffc9e9004e91c8a300149c2/image.jpg)

3. 추가된 CVM을 "축소 면제"로 설정하여 조정 그룹에서 축소를 위해 제거되지 않도록 합니다. 이 방법으로 이 CVM은 클러스터에서 항상 작동하며 AS는 이를 변경하지 않습니다.
![](https://mc.qcloudimg.com/static/img/de9840c7507a725d836f02ca77fd0490/image.jpg)

### 단계5. 확장/축소 전략 설정(중요!)

AS는 시간 제한 확장 또는 알람을 기반으로 동적 확장을 지원하며 확장/축소 알림을 수신하고 확장/축소 기록을 확인할 수 있습니다. 모든 것을 통제하고 있습니다.
![](https://mc.qcloudimg.com/static/img/b783799ed9140767ec456ed91ed985cb/image.jpg)

-  **먼저 20:00의 시간 제한 확장 태스크를 설정합니다.**
![](https://mc.qcloudimg.com/static/img/e3c790c1fa7594643bcfb591e5ca949b/image.jpg)
> 주의:
> Tencent Cloud의 CVM을 생성하는 데 약 1분 정도 걸립니다. 사용자 지정 이미지가 비교적 큰 경우 더 많은 시간이 필요할 수 있습니다. 시작 시간을 5분 정도로 미리 설정할 수 있습니다.

- **그 다음 24:00의 시간 제한 축소 태스크를 설정합니다.**
![](https://mc.qcloudimg.com/static/img/e0fce491429b83cc77fa244db5382778/image.jpg)

모두 완료되었습니다!

웹사이트의 백엔드 클러스터가 "1개의 고정 응용프로그램 서버 + 피크 시간 시 시간 제한 작업으로 생성한 응용프로그램 서버 1개"로 변경되었습니다.
조정 그룹에 추가되지 않은 다른 클러스터 CVM의 경우 대부분의 시간 동안 활용되지 않습니다. 비용 절감을 위해 반환할 수 있습니다.

