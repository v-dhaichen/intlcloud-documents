## ASとは？

ASは、業務ニーズとポリシーに基づいてCVM計算リソースを自動的に調整するので、アプリケーションの負荷を処理するために適切な量のCVMインスタンスを確保できます。Webサービスにとって、スマートな拡張と圧縮は、コスト管理とリソース管理の重要な部分です。Webアプリケーションがより多くのリクエストトラフィックを取得し始めたら、余分な負荷を処理するためにサーバーを追加します。同時に、Webアプリケーションのトラフィックが減少し始めたら、十分に活用されていないサーバーを終了します。

ASによって調整すれば、事前に拡張条件と圧縮条件を設定するだけで済みます。ASは、条件が満たされたときにパフォーマンスを維持するために使用されるサーバーの数を自動的に増やします。ニーズが低下した場合は、ASはコストを出来る限り低減するため圧縮条件に基づいてサーバーの数を減らす。

次の図に示すように、ASの使用で、クラスタは常に適切なリソース量を維持し、正常に稼働することができます。トラディショナルモードの多くの問題がなくなります： 
 - 業務の急上昇やCC攻撃が、CVMの数の不足を引き起こすため、サービスの応答ないことが発生する場合があります
 - ピークトラフィックでリソースの見積もりを行いますが、通常のトラフィックがピークに達することはめったにないため、リソースの無駄になります
 - 個人監視および数量アラームの頻繁な取り扱いには、複数の手動変更が必要です

**トラディショナルモードでのクラスタメンテナンス：**
![Alt text](https://mc.qcloudimg.com/static/img/dad472d890863fea889cea359de94c28/image.jpg)

**ASを使用した後の効果：**
![Alt text](https://mc.qcloudimg.com/static/img/5ca21d066ffffe9093a6796e3739325b/AS.jpg)


## ASの作業方法

一般的なWebアプリケーションサービスでは、通常、クラスタは顧客のトラフィックを満たすためにアプリケーションの複数のコピーを実行します。例えば、アクセスレイヤのフロントエンド・サーバー・クラスタ、論理レイヤのアプリケーションサーバークラスタ、バックエンドのキャッシュ・サーバー・クラスタなどです。各インスタンスは顧客のリクエストを処理できます。

これらの類似または同一のインスタンスは、通常、数量が調整可能です。これらの同じまたは類似のCVMを単一のスケーリンググループに管理できます：

- 各スケーリンググループ内のインスタンスの最小数を指定できます。ASは、スケーリンググループ内のインスタンスがこの数を下回らないようにします；
- 各スケーリンググループ内のインスタンスの最大数を指定できます。ASは、スケーリンググループ内のインスタンスがこの数より大きくならないようにします；
- スケーリングポリシーを指定すると、アプリケーションのニーズが増減したとき、ASはインスタンスを起動または終了します。スケーリングポリシーは2種類があります：
   a) アラームトリガポリシー：指定された条件に従って動的に拡張します（例えば、スケーリンググループのCVMのCPU使用率が60％を超える場合）
   b) 定時スケーリングポリシー：指定された時間に応じて拡張します（例えば：毎日21:00で拡張します） 
- ポリシーを設定したら、スケーリングイベント通知を設定することもできます。スケーリングイベントが発生すると、ASはEメール、SMS、またはサイト内メッセージで通知します。業務ニーズの変更をタイムリーに監視する必要はありません。AS通知に気を付けてはOKです。
- いつでも必要なCVMの数をクイックで指定したり、既存のCVMをスケーリンググループに追加して管理することもできます。

## ASの基本概念

**AS製品は以下の基本概念があります：**

- スケーリンググループ
- 起動構成
- スケーリングポリシー
- クールダウン時間


## 1. スケーリンググループ
スケーリンググループは、同じ規則に従い、同じシナリオに向けるクラウドサーバーインスタンスのセットです。スケーリンググループは、グループ内のCVMインスタンス数の最大値、最小値およびそれらに関連付けられたCLBインスタンスなどの属性を定義します。

## 2. 起動構成
起動構成は、イメージID、CVMインスタンスのタイプ、システムディスクとデータディスクのタイプと容量、キーペア、セキュリティグループなどを含む、クラウドサーバーを自動的に作成するテンプレートです。

スケーリンググループを作成するときに起動構成を指定する必要があります。起動構成が作成されると、そのプロパティは編集できません。

## 3. スケーリングポリシー
つまりスケーリング動作の実行条件です。トリガ条件が時間またはCMのためのアラートである可能性があり、動作はCVMの除去または追加である可能性があります。
スケーリングポリシーは以下の2つがあります：

- **定時スケーリングポリシー**
一定の時点に達すると、CVMインスタンスは自動的に増減され、定期的な繰り返しがサポートされます。

- **アラームスケーリング**
CMメトリック（CPU、メモリ、ネットワークトラフィックなど）に基づいて、CVMインスタンスを自動的に増減します。

## 4. クールダウン時間
クールダウンとは、同一のスケーリンググループ内で、1つのスケーリングイベント（CVMインスタンスの追加または除去）の実行が完了した後のロック時間を指します。この間、このスケーリンググループはスケーリングイベントを実行しません。クールダウン時間は0〜999999（秒）の範囲で指定できます。

