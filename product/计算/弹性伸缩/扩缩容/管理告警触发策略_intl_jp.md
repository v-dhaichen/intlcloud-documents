## 概要

ASは、監視メトリックに基づいて、スケーリンググループのインスタンス数を動的に拡張することをサポートします。アラームトリガーポリシーを定義する必要があります。つまり、拡張した監視メトリックのステータスをトリガーし、また、ニーズの変化に応じて拡張する方法です。

アラームポリシーを作成するには、条件とアクションを指定する必要があります。
- 条件のフォーマット：あるメトリック+しきい値+周期+継続的にしきい値に達する周期数。つまり、メトリックはＮ個の連続した周期にしきい値に達しました。
- 実行アクション：通知を送信+指定数のCVMを増減します。

各スケーリンググループに対して、2つのポリシーを作成することをお勧めします。1つのポリシーは拡張に使用され、もう一つのポリシーは圧縮に使用されます。ビジネス量がアラームポリシーで指定された条件に達すると、ASは関連付けられたポリシーを実行してスケーリンググループを圧縮、（インスタンスを終了することによって）または拡張（インスタンスを起動することによって）します。

以下の通りです。

![](https://mc.qcloudimg.com/static/img/cca3aaed563b1a5b97e32fa22eebdfa6/4.jpg)


## シナリオの例

例えば、EコマースWebサイトアプリケーションは現在5つのインスタンスを使用しています。運営活動を行って、アクセス量が予想よりはるかに大きいことを心配しています。現在のインスタンスの負荷が70％に上がったときに、2つの新しいインスタンスを起動し、負荷が40％に低下したときに、余分なインスタンスを終了することを設定できます。スケーリンググループを構成して、この条件に基づいて自動的に拡張します。



![](https://mc.qcloudimg.com/static/img/d3320376422b51e1241591e432e2f3c5/7.jpg)

## 操作手順

1. [コンソール](https://console.cloud.tencent.com/autoscaling/config)を開き、ナビゲーションバーの【スケーリンググループ】を選択します。

2. 変更するスケーリンググループを選択します。スケーリンググループIDをクリックして、スケーリンググループの基本情報ページに入ります。
![](http://mccdn.qcloud.com/static/img/bae3ec563534769d6c38143b60299d74/image.png)

3. 上のナビゲーションバーで、【アラームトリガーポリシー】を選択して、このページでスケーリンググループに関連付けられているアラームトリガーポリシーを管理します。
	- 【新規作成】をクリックして、新しいアラームトリガーポリシーを追加できます。
	- 【削除】をクリックして、このアラームトリガーポリシーを削除します。

![](http://mccdn.qcloud.com/static/img/7b4b02c3f0aa3fe5921029b6471d3ada/image.png)


## アラームスケーリングポリシーの影響を受けないように、あるサーバーを指定します
ASを使用する前に、システムにすでに共通のサーバーがある可能性がありますが、次の理由を考慮して、CVMをアラームスケーリングポリシーによって除去したくありません。

- **1台のサーバーの多目的使用**：クラスター内のあるサーバーは、クラスターのこと以外に、他の用途にも役立ちます。例えば、Webサイト構築の初期段階では、あるサーバーがキャッシュサーバーとファイルサーバーの両方として使用されています。キャッシュサーバークラスターがスケーリンググループに配置されている場合、それをアラートスケーリングポリシーによって除去したくありません。

- **データ保存**：このサーバーはステートフルであるか、他のサーバーにないデータを持っています。例えば、クラスター内の他のサーバーが動作する中に生成した増分データはすべてそのサーバーに統一に保存されます。

- **イメージ/スナップショットのアップデート**：このサーバーを使用して定期的にイメージとスナップショットを作成します。


**設定方法：**


**step 1** ：[スケーリンググループリスト](https://console.cloud.tencent.com/autoscaling)でサーバーが配置されているスケーリンググループをクリックして管理ページに入ることができます。

**step 2**：管理ページの下部にある「CVMリスト」で、設定するCVMについて、「除去保護の設定」をクリックします。

