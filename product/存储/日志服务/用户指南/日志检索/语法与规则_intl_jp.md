CLSには豊富な検索機能があり、クエリ構文と検索規則を使用してリアルタイムでログを照合し、結果を数秒で取得してビジネスの状況を素早く理解することができます。

## 検索開始

ログ検索は、CLSによって提供される非常に重要な機能です。1億レベルのログデータを数秒でクエリするようにクエリ条件をカスタマイズできます。具体的な手順は次のとおりです。

1.[CLSコンソール](https://console.cloud.tencent.com/cls)にログインしてください。
2.コンソール左側の【ログ検索】を選択して検索ページに入ります。
3.照合の時間範囲、ログセット、およびログトピックを選択します。
4.キーワードを入力したら、【照合】をクリックして照合結果を取得します。

## クエリ構文
以下のクエリ構文をサポットしています。

|構文|意味|
|--|--|
|A and B| 「および」ロジック、AおよびBの共通部分が返されます。複数のキーワードがコンマ、セミコロンまたはスペースで区切られている場合は、デフォルトで"AND"ロジックが使用されます|
|AまたはB|「または」ロジック、AまたはBの和集合が返されます|
|not B|「非」ロジック、Bが含まれていない結果を返します|
|A not B| 「マイナス」ロジック、Aに一致するがBには一致しない結果、つまりA-Bが返されます|
|(A , B)| 演算子の優先順位を制御するために、複数のqueryを一つのqueryにマージします|
|A:B |key-value照合フォーマットです。keyまたはvalueにスペースやコロンなどのキー文字が含まれている場合は、それらを引用符で囲む必要があります。たとえば、"error level"：highです |
|'a'| 文字aは通常の文字として扱われ、構文キーワードとしては扱われません|
|"A" | Aのすべてのキーワードは通常の文字として扱われ、構文キーワードとしては扱われません|
|\ |エスケープ文字。エスケープ文字は、エスケープ引用符`\"`、エスケープコロン`\:`などの記号そのものを表します。
|* |あいまい検索のキーワードは、ゼロ、単一または複数の任意の文字と一致し、\*で始まることをサポートしません。たとえば、`abc *`を入力すると、abcで始まるヒットログがすべて返されます|
| ?|あいまい検索のキーワード。特定の場所にある単一の文字と一致します。ab？cを入力すると、abで始まりcで終わり、かつ2つの文字の間に1文字が含まれるすべてのヒットログを返します|
|>| より大きい。数値型フィールドに使用されます|
|>=| 以上。数値型フィールドに使用されます|
|<| より小さい。数値型フィールドに使用されます|
|<=| 以下。数値型フィールドに使用されます|
|=| 等しい。数値型フィールド、またはテキスト型にすることができます|
| in | 数値範囲照合。閉じた区間の場合は角括弧 `[]`、開いている区間の場合は `()`です。たとえば、>0かつ <=100`の場合は(0 100]` が > です|
| \_source_ |ソースのログを照合します。例：\_source_：127.0.0.1|

>!
>- 演算子の優先順位は`:` > `"` > `()` > `and` > `not` > `or`のように降順でソートされています。
>- 範囲検索を実行する前に、数値型をdoubleまたはlongに設定する必要があります。そうしないと、返される結果が予想される結果と一致しません。
>- bがテキストの場合、`a = b`と`a：b`の違いは前者aがbと等しく、後者aがbを含むということです（単語分割論理により、あいまい検索をサポートします）。
>- 構文キーワードは大文字と小文字を区別しません。



## 検索規則
ログの検索を実行する場合、時間範囲、ログセット、およびログトピックの検索は3つの不可欠な照合条件です。デフォルトの検索時刻はその日の有効なログデータです。ログセットとログトピックでは、照合のニーズに基づいて選択する必要があります。検索ボックスのコンテンツは空にすることができ、空の場合はフィルタ条件なしと見なされ、システムはすべての有効なログデータを返します。

### フルテキストインデックス
フルテキストインデックスを有効にするログトピックについては、システムが区切り記号を使用して各ログデータを複数のフレーズに分割されるため、特定のキーワードでログを検索できます。

たとえば、キーワード`error`を含むログデータを検索するには、検索ボックスに`error`を入力して検索できます。

### キー値検索
キー値インデックスを有効にするログトピックについては、指定されたkvキー/値のペアに基づいてログデータを管理します。keyフィールドを指定してログを検索できます。

たとえば、`status`フィールドが`error`のログデータを検索するには、検索ボックスに`status：error`を入力して検索できます。

### あいまいキーワード検索
CLSはあいまい検索の能力を提供し、特別なあいまいキーワードでログ検索を行います。詳細は以下のとおりです。

|メタ文字|説明|
|-----|:-----|
| * |あいまい検索のキーワード。たとえば、ゼロ、単一または複数の任意の文字と一致します。たとえば、`abc *`を入力すると、`abc`で始まるすべてのヒットログが返されます|
|？|あいまい検索のキーワード。特定の場所にある単一の文字と一致します。`ab？c`を入力すると、`ab`で始まり`c`で終わり、かつ2つの文字の間に1文字が含まれるすべてのヒットログを返します|

### クロストピック検索
ログ検索を使用すると、1つのログセットだけを選択し、そのログセットの下に複数のログトピックを選択できます。つまり、1つのログセットの下にある複数のログトピックを同時に検索できるため、分析問題を見つけるのは便利です。

## 注意事項
1.ログ検索を行うときは、該当するログトピックが検索されていることを確認してください。そうしないと有効なログが検索されません。
2.キー値検索を実行するときは、照合されたインデックス付きフィールドがログトピックのインデックス構成に正常に構成されていることを確認してください。
3.ログ検索結果がデフォルトでは降順で表示されます。

