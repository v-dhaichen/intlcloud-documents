##　概要
COSは複数のデータ移行方式をサポートし、ユーザーは異なる移行シナリオに従って異なるデータ移行方式を選択できます。このドキュメントは、いくつかの典型的な移行シナリオに適用可能な移行方式、対応する移行操作ステップおよび操作スキルを要約し、ユーザーがデータをCOSに効率的かつ安全に移行することに役立ちます。

| 移行タイプ | 移行方式                                                     |
| -------- | ------------------------------------------------------------ |
| オンライン移行 |  [COS Migration ](#cos)、[移行サービスプラットフォーム](#msp)、[COSプル](#huiyuan) |
| オフライン移行 | [クラウドデータ移行 CDM](#cdm )                                      |

## 移行シナリオ

### 1. ローカルデータをCOSに移行します
ローカルIDCを持つユーザーの場合、COSは異なる移行タイプで以下のいくつかの移行方式をサポートし、ユーザーがローカルIDCの大量のデータをCOSに迅速に移行することに役立ちます。

- オンライン移行：[COS Migration](#cos)
- オフライン移行：[クラウドデータ移行 CDM](#cdm)

ユーザーは、データ移行量、IDCアウトバウンド帯域幅、IDCアイドルロケーションリソース、許容される移行完了時間などの要素に基づいて、移行方式をどのように選択するかを考慮できます。以下の図は、オンライン移行を使用する時に推定される所要時間を示していますが、図から見られるように、今回の移行期間が10日を超えるか、または移行データ量が50TBを超える場合は、[クラウドデータ移行 CDM](#cdm) を選択してオフライン移行を実行することをお勧めします。そうでない場合は、オンライン移行を選択してください。
![](https://main.qcloudimg.com/raw/b07948f0626973d2d64753df39add6f4.png)
>**注意：**
> 多数の1MB未満の小ファイル、不十分なディスクIOパフォーマンスなども、データ移行の進行状況に影響を与えます。

### 2. 第三者クラウドストレージ上のデータをCOSに移行します
第三者クラウドストレージを使用するユーザーが、クラウドプラットフォーム間のデータ移行を実現しようとする場合、COSは以下の2つの選択可能な移行方式をサポートします：

- オンライン移行：[COS Migration](#cos)、[移行サービスプラットフォーム  MSP](#msp)


この2つの移行方式はいずれもデータ移行の進行状況の確認、ファイル整合性チェック、失敗再送信、ブレークポイント連続送信などの機能をサポートし、ユーザーデータの基本的な移行要件を満たすことができます。しかしながら、この2つの移行方式は、対話形式と機能特性などの点で異なり、以下の表に示すとおりです。ユーザーは、以下の相違度比較表に基づいて、データ移行のための最適な方式を選択できます。移行サービスプラットフォームMSPを使用してデータ移行を実行するには、使用権限を申請する必要があることは注意してください。

| 移行方式         | 対話形式                   | 大ファイルと小ファイルを区別するしきい値 | 移行並行性                     | HTTPS セキュリティ転送                        |
| ---------------- | -------------------------- | ------------------ | ------------------------------ | -------------------------------------- |
| COS Migration    | 構成ファイルを変更し、非視覚的操作 | カスタマイズして調整可能       | 大容量ファイルと小容量ファイルに対して並行性をそれぞれ定義する | 有効化するかどうかを選択でき、無効化すれば移行速度の向上に役に立つ |
| 移行サービスプラットフォームMSP | 視覚的ページ操作             | デフォルト設定を採用      | 全体的に統一                       | 有効化                                   |

### 3. URLをソースアドレスとしてデータをCOSに移行します

ユーザーがURLリストをデータソースアドレスとして使用してデータ移行を実行しようとする場合、COSは以下の3つの方式をサポートします：

- オンライン移行：[COS Migration](#cos)、[移行サービスプラットフォーム MSP](#msp)、[COSプル](#huiyuan)

COS Migrationおよび移行サービスプラットフォームMSPの選択については、上述したシナリオ2の紹介セクションを参照してください。データオリジンサーバーをクラウドに移行する過程において、ユーザーがデータオリジンサーバー内のすべてのホットデータのみをクラウドに移行し、コールドデータをオリジンサーバーに残しようとする場合、［COSプル］（#huiyuan）の移行方式を採用できます。COSプルは、読み書きアクセスリクエストを有するホットデータをCOSに移行し、低頻度アクセスのビジネスデータを自動的にホットコールドに分けることを実現できます。

### 4. COS間のデータ移行
COSを使用しているユーザーが、1つのバケットのデータを同じアカウントにおける別のバケット（またはアカウント間地域間のバケット）に移行する必要がある場合、COSが提供する地域間コピー機能を使用してデータ移行を実行することができ、現在、この機能はまだ正式に開始されていないので、しばらくお待ちください。

## 移行実践

### <span id="cos"> COS Migration </span>

COS Migrationは、COSデータ移行機能を統合する統合ツールです。ユーザーは簡単な構成操作によりデータをCOSに迅速に移行できます。

移行操作は以下のいくつかのステップを備えます：

1. Java環境をインストールします
2. COS Migrationツールをインストールします
3. 構成ファイルを変更します
4. ツールを有効化します

具体的な操作方法については、 [COS Migration ドキュメント](https://cloud.tencent.com/document/product/436/15392 )を参照してください。
#### 操作スキル

以下、移行速度を最大にするためにCOS Migrationをどのように構成するかを紹介します：

1. ネットワーク環境に応じて大容量ファイルと小容量ファイルを区別するしきい値と移行並行性を調整し、大容量ファイルをマルチパートで転送し、小容量ファイルを並行転送するという最適な移行方式を実現します。
  構成ファイル`config.ini`内の`[common]`セクションで、`smallFileThreshold`小容量ファイルしきい値パラメータを変更し、このしきい値以上であれば、マルチパートアップロードを使用し、デフォルトでは、5MBに設定します。 大容量ファイルの並行性`bigFileExecutorNum` と小容量ファイルのの並行性`smallFileExecutorNum` をそれぞれ変更し、パブリックネットワークを介してCOSに接続され、かつ帯域幅が小さい場合、この並行性を低下させてください。 小容量ファイルと大容量ファイルの並行性は、デフォルトでは、それぞれ64と8です。

2. ツールの実行時間を調整し、帯域幅の制限を設定し、自分のビジネスが移行データの帯域幅の占用による影響を受けないように保証します。
  構成ファイル`config.ini`内の`[common]`セクションで、パラメータ`executeTimeWindow`を変更し、このパラメータは移行ツールの毎日の実行期間を定義し、他の時間にはスリープ状態に入り、スリープ状態では移行を一時停止し、かつ移行の進行状況を保留し、次のタイムウィンドウに至ったら、自動的に実行し続けます。

3. 分散型並行転送を使用すれば、移行速度をさらに向上させることができます。ユーザーは、複数のマシンでCOS Migrationをインストールし、かつ異なるソースデータの移行タスクをそれぞれ実行することを考慮できます。


### <span id="msp"> 移行サービスプラットフォームMSP</span>

移行サービスプラットフォームMSPは、複数の移行ツールを統合し、かつ視覚的APIを提供するプラットフォームであり、ユーザーが大規模なデータ移行タスクを楽に監視し管理することに役立つことができます。そのうち、「ファイル移行ツール」は、ユーザーが様々なパブリッククラウドおよびデータオリジンサーバーからCOSにデータを移行することに役立ちます。

移行操作は以下のいくつかのステップを備えます：

1. コンソールナビゲーションバーの【移行ツール】により「ファイル移行ツール」ポータルを見つけて有効にします。
2. 移行タスクを新規作成し、タスク情報を構成します。
3. タスクを有効化します。

具体的な操作については、[移行ツール](https://cloud.tencent.com/document/product/659/15313)のドキュメントを参照してください。
#### 操作スキル

データ移行プロセスにおいて、ネットワーク環境によってデータソースの読み取り速度が異なるが、顧客が実際の状況に応じて「ファイル移行タスクを新規作成する」時に高いQPS並行性を選択すれば、移行速度の向上に役立ちます。


### <span id="cdm"> クラウドデータ移行CDM</span>

クラウドデータ移行CDMは、Tencent Cloudが提供するオフライン移行専用デバイスを利用して、ユーザーがローカルデータをクラウドに移行することに役立つ移行方式であり、ローカルデータをネットワークを介してクラウドに転送し移行する時間が長く、コストが高く、安全性が低いという問題を解決できます。

移行操作は主に以下のいくつかのステップを備えます：

1. クラウドデータ移行CDMコンソールに申請を提出します。
2. 申請が承認された後、ユーザーはデバイスの受け取りを待ちます。
3. デバイスを受け取った後、移行デバイスのマニュアルに従ってデータをデバイスにコピーします。
4. データのコピーが完了した後、コンソールで申請を提出して送信し、かつTencent CloudがデータをCOSに移行することを待ちます。

詳細については、 [クラウドデータ移行 CDM ](https://cloud.tencent.com/document/product/623) の製品ドキュメントを参照してください。

#### 操作スキル

以下、どのようにしてオフライン移行によりデータをTencent Cloud COSに効率的かつ安全に移行するかを紹介します。

1. IDCにおいて10Gbpsのネットワーク環境を構成し、ローカルデータ環境が転送のボトルネックにならないようにするために、高性能のマウントポイントマシンを装備してコピー速度を最大化することができます。
2. CDMのデータ転送に適する最速の方式はデータ並行転送であり、ユーザーはデバイスのCPUとメモリの使用率を監視することにより、現在の移行速度が予想より低い場合、以下の並行転送方式を選択できます。
 - 複数のデバイスは異なるネットワークAPIを介して同じCDMデバイスに接続されます。
 - 複数のデバイスは異なるネットワークAPIを介して複数のCDMデバイスに接続されます。

### <span id="huiyuan">COSプル</span>

COSプルは、データオリジンサーバーにおける読み書きアクセスリクエストを有するデータを、Tencent CloudのCOSに自動的に移行します。この移行方式は、ユーザーがデータを迅速にホットコールドに分けることに役立つことができるだけでなく、ビジネスシステムにおけるホットデータの読み書きアクセス速度を向上させることができます。

移行操作は主に以下のいくつかのステップを備えます：

1. COSのコンソールに入り、移行されるデータの目的バケットにプル設定を有効化します。
2. バケットのプルアドレスを構成して保存します。
3. ビジネスシステムの読み書きリクエストをTencent Cloud COSに転送します。

具体的な操作については、[プル設定](https://cloud.tencent.com/document/product/436/13310) コンソールガイドドキュメントを参照してください。

#### 操作スキル

以下のステップでソースデータのホットコールドの分離を完了でき、ホットデータをTencent Cloud COSにシームレスに移行することで、ホットデータの読み取りリクエスト速度を向上させます。

1. ビジネスシステムの読み書きリクエストをCOSに切り替え、COSコンソールでプル設定機能を開き、プルアドレスはデータオリジンサーバーであり、この時、システムの構成は以下の図に示すとおりです。
  ![](https://main.qcloudimg.com/raw/c30ed0391380420007bf9e2d89df89eb.png)

2. ある時間経過した後、コールドデータは依然としてオリジンサーバーに残されますが、ホットデータはTencent Cloud COSに移行されます。移行過程において、ビジネスシステムは影響を受けません。
