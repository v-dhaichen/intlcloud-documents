COSリソースに対して、異なる企業間または同じ企業の複数のチーム間で、異なるチームまたはメンバーに異なるアクセス権限を構成する必要があります。CAM（アクセス管理、以下、CAMと呼ばれる）を介して構成して、バケット/オブジェクトの粒度で異なるチームまたはメンバーに対して、異なる操作の権限設定を実現することができます。
要するに、構成は、サブアカウントの作成、サブアカウントに対する権限付与、およびサブアカウントのアクセスという3つのステップに分けられます。

まず、いくつかの重要な概念を理解する必要があります。
## 名詞の説明
CAMの関連用語、構成の詳細については、[CAM概要](/doc/product/598/10583)を参照してください。
### ルートアカウント
ルートアカウントは開発者とも呼ばれます。ユーザーがTencent Cloudアカウントを申請すると、システムはTencent Cloudサービスにログインするためのルートアカウント身分を作成します。ルートアカウントは、Tencent Cloudリソース使用量の計測と課金の基本的な部分です。
ルートアカウントは、デフォルトでは、そのアカウント内の利用可能なすべてのリソースに対するフルアクセス権限を持ち、請求情報へのアクセス、ユーザーパスワードの変更、ユーザーとユーザーグループの作成、および他のクラウドサービスリソースへのアクセスなどを含みます。デフォルトでは、リソースはルートアカウントのみによってアクセスでき、他のユーザーがアクセスしようとする場合、ルートアカウントに承認される必要があります。

### サブアカウント（ユーザー）およびユーザーグループ
- サブアカウントは、ルートアカウントによって作成されたエンティティであり、明確な身分IDと身分認証情報を持ち、Tencent Cloudコンソールにログインする権限を持っています。
- サブアカウントはデフォルトではリソースを所有していないため、所属するルートアカウントによって承認される必要があります。
 - 1つのルートアカウントは複数のサブアカウント（ユーザー）を作成できます。
 - 1つのサブアカウントは複数のルートアカウントに帰属し、それぞれのクラウドリソースを管理するように複数のルートアカウントを補助することができますが、同じ時刻に、1つのサブアカウントは1つのルートアカウントのみにログインして、このルートアカウントのクラウドリソースを管理することができます。
- サブアカウントは、コンソールを介して開発者（ルートアカウント）を切り替え、あるルートアカウントから別のルートアカウントに切り替えることができます。
 - サブアカウントがコンソールにログインすると、自動的にデフォルトのルートアカウントに切り替え、かつデフォルトのルートアカウントによって付与されたアクセス権限を持っています。
 - 開発者を切り替えた後、サブアカウントは切り替えたルートアカウントによって付与されたアクセス権限を持ち、切り替える前のルートアカウントによって付与されたアクセス権限は直ちに無効になります。
- ユーザーグループは同じ機能の複数のユーザー（サブアカウント）の集合です。ビジネスニーズに応じてさまざまなユーザーグループを作成し、ユーザーグループに適切なポリシーを関連付けて、さまざまな権限を割り当てることができます。

## サブアカウントの権限構成
### ステップ1：サブアカウントの作成
CAMコンソールでサブアカウントを作成し、かつサブアカウントにアクセス権限を付与されるように構成することができます。具体的な操作は以下のとおりです：
1. [CAMコンソール](https://console.cloud.tencent.com/cam)にログインし、左側のメニューバー【ユーザー管理】をクリックし、ページボタン【ユーザーの新規作成】をクリックします：
 ![サブアカウント1](//mc.qcloudimg.com/static/img/5d9194888617f10bfde81afa01c69e0b/image.png)

2. 必要に応じてユーザー関連情報を入力します。
 ![サブアカウント2](//mc.qcloudimg.com/static/img/97dbdb848557f0195f90e1a78561eb37/image.png)
>!「ログインアカウント」はTencent Cloudにログインできるアカウントであり、サブアカウントとして3種類のアカウントを追加でき、追加方式は以下のとおりです：
 - メールアドレス：Tencent Cloudに登録したメールアドレスまたは対応するアカウントIDを入力してください。
 - WeChat公式アカウント：Tencent CloudにおけるそのアカウントIDを入力してください。
 - QQ番号：QQ番号またはそのアカウントIDを入力してください。

3. システムによって提供されるポリシー選択に従って、COSの読み書き権限、読み取り専用権限などの簡単なポリシーを構成できます。より複雑なポリシーを構成する必要がある場合、 [ステップ2：サブアカウントに対する権限の付与](#サブアカウントに対する権限の付与)を参照してください。
![サブアカウント3](//mc.qcloudimg.com/static/img/8c3be83e576d892c99b90190d5f5c0b2/image.png)

<span id="サブアカウントに対する権限の付与"></span>
### ステップ2：サブアカウントに対する権限の付与
サブアカウントに権限を付与する際に、CAMを介してサブアカウント（ユーザー）またはユーザーグループにポリシーを構成できます。
1. [CAMコンソール](https://console.cloud.tencent.com/cam)にログインし、左側のメニューバー【ポリシー管理】をクリックし、タブ【カスタマイズポリシー】をクリックし、ボタン【カスタマイズポリシーの新規作成】をクリックします：
![4](//mc.qcloudimg.com/static/img/c1edfdc87bc078d8bc8f0fb052313d28/image.png)
2. 【ポリシー構文に基づく作成】を選択して、作成ページに入ります。
![5](//mc.qcloudimg.com/static/img/94801671fcdff7b80dc973d9ee0e1165/image.png)
3. 選択可能なテンプレートには、空白のテンプレートと既存のCOSテンプレートがあり、実際の状況に基づいて選択できます。
![6](//mc.qcloudimg.com/static/img/8ee0f66634765849bb90a1a2d60806a5/image.png)
4. ポリシーを編集し、COSの一般的なシナリオのポリシーについては、[CAM製品ドキュメント](/doc/product/598) のコマーシャルケース部分を参照してください。ポリシーコンテンツをコピーして【ポリシーコンテンツの編集】入力ボックスに貼り付けることができます。
![7](//mc.qcloudimg.com/static/img/2a5ce2ce4863f1a537dc74d45284ee5d/image.png)
5. 作成が完了した後、ポリシーをサブアカウントに関連付けることができます。
![8](//mc.qcloudimg.com/static/img/3517b05ee79c818883d1ecf96dbbad89/image.png)
サブアカウントに対する権限付与が完了した後、サブアカウントは権限の範囲に基づいてCOSリソースにアクセスできます。
![9](//mc.qcloudimg.com/static/img/606cdbcdccb90cf65dbc8826bc7d92da/image.png)


ここで、さらに以下のポリシーの例によっていくつかの典型的なシナリオを説明し、詳細については、[ポリシーの例](#ポリシーの例)を参照してください。
- COSを使用する時に、どのようにしてサブアカウントに読み書き権限を構成しますか？
- COSを使用する時に、どのようにしてサブアカウントに読み取り専用権限を構成しますか？
- COSを使用する時に、どのようにしてあるIPアドレス範囲のみで読み書き権限を設定しますか？

### ステップ3：サブアカウントはルートアカウントのCOSリソースにアクセスします
COSアクセス（APIまたはSDK）は以下のリソースを必要とします：APPID、SecretId、SecretKey。
サブアカウントを使用してCOSリソースにアクセスする時、ルートアカウントのAPPID、サブアカウントのSecretIdおよびSecretKeyを使用する必要があり、CAMコンソールでサブアカウントのSecretIdおよびSecretKeyを作成できます。
1. サブアカウントが[CAMコンソール](https://console.cloud.tencent.com/cam/capi)にログインする時、対応するルートアカウント（開発者アカウント）を選択する必要があります。
![10](//mc.qcloudimg.com/static/img/7f109890f04a9f57f3b8c924b3788e2d/image.png)
2. ログインした後、ボタン【暗号鍵の新規作成】をクリックして、サブアカウントのSecretIDおよびSecretKeyを作成でき、APPIDをルートアカウントによって提供する必要があります。
![11](//mc.qcloudimg.com/static/img/294e294ef54662dedf57af975b7bea75/image.png)


>!
- サブアカウントはXML APIまたはXML APIベースのSDKを介してCOSリソースにアクセスする必要があります。
- サブアカウントがCOSリソースにアクセスする時に、ルートアカウントのAPPID、サブアカウントのSecretIdおよびSecretKeyを使用する必要があります。

#### XMLベースのJava SDKのアクセスの例
XMLベースのJava SDKコマンドラインを例とし、以下のパラメータを入力する必要があります：
```
// 1 身分情報の初期化
COSCredentials cred = new BasicCOSCredentials("<ルートアカウントAPPID>", "<サブアカウントSecretId>", "<サブアカウントSecretKey>");
```

インスタンスは以下のとおりです：
```
// 1 身分情報の初期化
COSCredentials cred = new BasicCOSCredentials("1250000011", "AKIDasdfmRxHPa9oLhJp9wqwraCdtzvfPasdfaqW", "e8Sdeasdfas2238ViAXjpkU6XloeN2Wpxue");
```

#### COSCMD TCCLIのアクセスの例
COSCMD `config`コマンドラインを例とし、以下のパラメータを入力する必要があります：
```
coscmd config -u <ルートアカウントAPPID> -a <サブアカウントSecretId> -s <サブアカウントSecretKey>  -b <ルートアカウントbucketname> -r <ルートアカウントbucketname地域>
```
インスタンスは以下のとおりです：
```
coscmd config -u 1250000011 -a AKIDasdfmRxHPa9oLhJp9wqwraCdtzvfPasdfaqW -s e8Sdeasdfas2238ViAXjpkU6XloeN2Wpxue -b bucket1 -r ap-beijing
```
<span id="ポリシーの例"></span>
## ポリシーの例
カスタマイズポリシーを構成する時、以下の参照ポリシーをコピーして【ポリシーコンテンツの編集】入力ボックスに貼り付けることができ、実際の構成に従って変更すればよいです。

### サブアカウントに読み書き権限を構成します
サブアカウントに読み書き権限のみを構成し、具体的なポリシーは以下のとおりです：
```
{
    "version": "2.0",
    "statement": [
        {
            "action": [
                "name/cos:*"
            ],
            "resource": "*",
            "effect": "allow"
        },
        {
            "effect": "allow",
            "action": "monitor:*",
            "resource": "*"
        }
    ]
}
```
### サブアカウントに読み取り専用権限を構成します
サブアカウントに読み取り専用権限のみを構成し、具体的なポリシーは以下のとおりです：
```
{
    "version": "2.0",
    "statement": [
        {
            "action": [
                "name/cos:List*",
                "name/cos:Get*",
                "name/cos:Head*",
                "name/cos:OptionsObject"
            ],
            "resource": "*",
            "effect": "allow"
        },
        {
            "effect": "allow",
            "action": "monitor:*",
            "resource": "*"
        }
    ]
}
```
### サブアカウントにあるIPアドレス範囲の読み書き権限を構成します
この例では、IPアドレス範囲が`192.168.1.0/24`と`192.168.2.0/24`のアドレスのみが読み書き権限を持つように制限し、以下に示すとおりです。
より豊かな有効化条件の入力については、[有効化条件](/doc/product/598/10608)を参照してください。
```
{
    "version": "2.0",
    "statement": [
        {
            "action": [
	"cos:*"
            ],
            "resource": "*",
            "effect": "allow",
            "condition": {
                "ip_equal": {
                    "qcs:ip": ["192.168.1.0/24", "192.168.2.0/24"]
                }
            }
        }
    ]
}
```
