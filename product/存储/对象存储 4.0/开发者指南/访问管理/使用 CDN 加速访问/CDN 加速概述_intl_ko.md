CDN을 사용하여 COS를 가속하면 버킷의 콘텐츠에 큰 범위의 다운로드와 배포를 진행할 수 있으며 특히, 동일한 콘텐츠를 반복적으로 다운로드하는 시나리오에 적용됩니다. 오리진 요청 인증 기능을 통해 CDN 가속을 사용하여 버킷 중 콘텐츠의 비공개 읽기를 구현할 수 있습니다. CDN 인증 기능을 통해 콘텐츠가 유효한 사용자에 의해서만 다운로드될 수 있도록 하여 공개 다운로드로 인해 발생하는 데이터 보안 및 트래픽 비용 등 문제를 피할 수 있습니다.

## CDN

### CDN 의 정의

CDN은 기존 Internet에 추가되는 새로운 네트워크 아키텍처로서, 전 세계에 퍼져있는 고성능 가속 노드로 구성되었습니다. 이러한 고성능 서비스 노드는 모두 일정한 캐시 정책에 따라 비즈니스 콘텐츠를 저장하며 사용자가 어떤 비즈니스 콘텐츠에 요청을 보낼 때 해당 요청은 가장 가까운 사용자의 서비스 노드로 스케줄링되고 서비스 서버가 직접 신속하게 응답하여 사용자 접근 지연을 효과적으로 낮추고 가용성을 향상시킵니다.

CDN은 캐시와 오리진 요청 작업을 진행할 수 있습니다. 즉, 사용자가 URL에 접근할 때, 만약 해석되는 엣지 서버가 응답해야 할 캐시 콘텐츠를 적중하지 못하거나 캐시가 이미 만료되었을 경우 오리진 서버로 돌아가 응답해야 할 콘텐츠를 획득합니다.

### 적용 시나리오

- 응답 지연과 다운로드 속도에 높은 요구가 있는 시나리오.
- 지역 간, 국가 간, 대륙 간 GB 단위에서 TB 단위 까지의 데이터 전송 시나리오가 필요합니다.
- 동일 콘텐츠의 고밀도로 반복적으로 다운로드하는 시나리오.

### 보안 유형

- 오리진 요청 인증: 사용자가 요청한 데이터가 엣지 서버에서 캐시를 적중하지 않았을 경우, CDN은 오리진 요청에서 데이터 콘텐츠를 획득해야 합니다. COS를 오리진 서버로 사용하고 오리진 요청 인증을 활성화한 후, CDN 엣지 서버는 특별한 서비스 ID를 사용하여 COS 오리진 서버에 접근하여, 비공개 접근 버킷 중의 데이터 획득 및 캐시를 구현합니다.
  - CDN 서비스 권한 부여: CDN 엣지 서버는 CDN 서비스 권한 부여 추가를 통해 특별한 서비스 ID를 사용하여 COS 오리진 서버에 접근할 수 있습니다. CDN 서비스 권한 부여를 추가한 후 오리진 요청 인증을 활성화할 수 있습니다.
- CDN 인증 구성: 엣지 서버 접근을 통해 캐시 데이터를 불러올 때, 엣지 서버는 인증 구성에 규칙에 따라 접근 URL의 ID 인증 필드를 인증하여 권한을 부여받지 않은 접근을 차단하며 이로써 핫 링크 보호를 구현하고 엣지 서버 캐시 데이터의 보안성과 신뢰성을 향상합니다.

## COS의 접근 노드

### 접근 노드 정의

접근 노드는 버킷 생성 시, 버킷의 지역과 이름에 따라 버킷의 접근 도메인 이름에 배포하며 해당 도메인 이름으로 버킷의 데이터에 접근할 수 있습니다.

정적 웹사이트 기능을 활성화하면, 하나의 정적 웹사이트의 접근 노드를 추가 획득하며 기본 노드의 구현과 다른, 특별한 구성의 응답 내용을 나타나는 데 사용됩니다.

### 접근 노드

- XML 노드: 하나의 버킷을 생성한 후 COS 는 하나의 XML 접근 노드를 버킷에 직접 할당합니다. 접근 노드의 대체적인 형식은 `<bucketname>-<APPID>.cos.<region>.myqcloud.com`이며 RESTful API 접근에 적용됩니다. 사용자는 XML 접근 노드를 사용하여 [API 문서](https://cloud.tencent.com/document/product/436/7751)의 실행 규범에 따라 버킷을 구성하거나 객체의 업로드 및 다운로드 작업을 진행할 수 있습니다.
- 정적 웹사이트 노드: 콘솔의 버킷 기본 구성 인터페이스에서 정적 웹사이트 호스팅 기능을 활성화할 수 있습니다. 활성화 후, 하나의 접근 노드를 제공하며 접근 노드의 대체적인 형식은 `<bucketname>-<APPID>.cos-website.<region>.myqcloud.com`입니다. 정적 웹사이트는 인덱스 페이지(IndexPage), 오류 페이지(ErrorPage) 및 리디렉션 등을 지원하고 객체에 대상한 다운로드 유형 작업만 지원하며 사용자는 정적 웹사이트 노드를 통해 콘텐츠를 획득할 수 있습니다.

### 접근 권한

-  공개 읽기: 버킷을 공개 읽기로 설정하면 모든 사용자가 버킷의 접근 도메인 이름을 통해 접근할 수 있습니다. 만약 사용자가 공개 읽기 버킷을 오리진 서버 오리진 요청으로 사용한다면 CDN 가속을 직접 활성화할 수 있으며 CDN 인증과 오리진 요청 인증을 사용할 필요가 없습니다.
- 비공개 읽기: 버킷을 비공개 읽기로 설정하면 사용자는 접근 정책 편집을 통해 접근자를 관리할 수 있으며 CDN 서비스 권한 부여 관리 등을 포함합니다. 만약 비공개 읽기 버킷을 오리진 서버 오리진 요청으로 사용하고 오리진 요청 인증을 활성화하고 CDN 인증을 활성화하지 않았을 경우, 비권한 범위 내의 사용자들이 CDN을 통해 버킷에 직접 접근할 수 있으므로 비공개 읽기 버킷은 CDN 인증과 오리진 요청 인증을 동시에 활성화하여 데이터의 보안을 보장할 것을 강력히 권장합니다.

## CDN으로 COS 접근 가속화

사용자는 다음 두가지 도메인을 관리하여 COS에 가속 접근할 수 있습니다.

- 기본 가속 도메인 이름: COS가 사용자에게 제공하는 기본 CDN 가속 도메인 이름입니다. 형식은 ` <bucketname>-<APPID>.file.mycloud.com`입니다. 사용자는 활성화/비활성화를 선택할 수 있습니다.
- 사용자 지정 도메인 이름: 사용자는 자체로 이미 ICP 라이센싱된 사용자 지정 도메인 이름을 준비할 수 있으며 오리진 서버를 COS 버킷으로 지정하여 사용자 지정 도메인 이름 가속을 사용한 버킷 중 객체의 접근을 구현할 수 있습니다.

> **주의:**
> 기본 가속 도메인 이름과 사용자 지정 도메인 이름은 CDN 가속 도메인 이름으로 통칭할 수 있습니다.

### 공개 읽기 버킷

버킷을 공통 접근 허용으로 설정하고 CDN 오리진 요청을 COS 접근 노드로 구성 시, 오리진 요청 인증을 활성화할 필요가 없고. CDN 엣지 서버는 버킷 중의 객체 데이터를 직접 획득하고 캐싱할 수 있습니다.

여전히 CDN 콘솔을 통해 [인증 구성](https://cloud.tencent.com/document/product/228/13677)을 활성화할 수 있습니다. **제한적으로** 버킷 중의 데이터를 보호할 수 있습니다.그 이유는 CDN 중의 이 기능의 활성화 여부와 상관없이, 버킷 접근 도메인 이름을 아는 사용자는 여전히 버킷의 모든 객체에 접근할 수 있기 때문입니다. 서로 다른 CDN 인증 구성에 대해, 도메인 이름의 공개 읽기 버킷 접근 능력은 다음과 같습니다.

| CDN 인증 구성 | CDN 가속 도메인 이름 접근 | COS 도메인 이름 접근       | 일반적인 시나리오         |
| ------------ | ---------------- | ------------ | ----------------------------------------------- |
| 비활성화 (기본) | 접근 가능           | 접근 가능       | 웹사이트 전체 내용 공통 접근 허용, CDN 또는 오리진 서버로 접근 가능      |
| 활성화         | URL 인증 사용 필요  | 접근 가능       | CDN 접근에 핫 링크 보호 활성화. 단, 오리진 서버의 접근은 보호하지 않으며 추천하지 않음 |

### 비공개 읽기 버킷

버킷 기본값이 비공개 읽기일 경우, CDN 오리진 요청을 COS 접근 노드로 구성하며, CDN 엣지 서버는 **모든 데이터를 획득하거나 캐시할 수 없습니다**. 따라서, CDN 서비스 ID를 버킷 접근 정책(Bucket Policy)에 추가하고 해당 ID가 다음 작업을 할 수 있도록 허용해야 합니다.

- GET Object -  객체 획득
- HEAD Object - 객체 메타데이터 획득
- OPTIONS Object - 객체 실행 전 요청 발송

CDN 콘솔과 COS 콘솔은 모두 퀵 권한 부여 기능을 제공합니다. [CDN 서비스 권한 부여 추가]를 클릭하면 됩니다. 이 작업을 완료한 후, [오리진 요청 인증] 항목을 활성화해야 하며 CDN 엣지는 이 서비스 ID를 사용하여 COS 중의 데이터에 접근합니다.

> **주의:**
> 1. 만약 버킷이 비공개 읽기로 설정되어 있다면 반드시 권한 부여를 추가하고 오리진 요청 인증을 활성화해야 합니다. 그렇지 않으면 COS는 접근을 거부합니다.
> 2. CDN 엣지는 각 루트 계정에 따라 유일한 서비스 계정을 생성합니다. 따라서 계정의 권한 부여는 가속 도메인 이름에 속한 루트 계정에만 유효하며 계정 간 바인딩 가속 도메인 이름은 접근 거부됩니다.

CDN 서비스 권한 부여를 추가하고 오리진 요청 인증을 활성화하면, CDN 엣지 서버는 직접 데이터를 획득하고 캐싱할 수 있습니다. 따라서 사설 데이터 보호가 필요할 경우 [인증 구성](https://cloud.tencent.com/document/product/228/13677)을 활성화하고 버킷의 데이터를 보호할 것을 권장합니다. 서로 다른 CDN 인증 구성에 대해, 도메인 이름의 비공개 읽기 버킷 접근 능력은 다음 표와 같습니다.

| CDN 인증 구성 | CDN 가속 도메인 이름 접근 | COS 도메인 이름 접근    | 일반적인 시나리오                            |
| ------------ | ---------------- | --------------- | ----------------------------------- |
| 비활성화(기본) | 접근 가능           | COS  인증 필요 | CDN 도메인 이름 직접 접근 가능, 오리진 서버 데이터 보호   |
| 활성화         | URL 인증 필요  | COS 인증 필요 | 전체 링키지 접근 보호, CDN 인증 핫 링크 보호 지원 |
