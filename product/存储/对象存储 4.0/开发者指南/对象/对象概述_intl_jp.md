## 定義

オブジェクト（Object）はCOSの基本的なユニットであり、オブジェクトはバケットに保存されています（例えば一枚の写真が一つのアルバムに保存されている）。Tencent Cloudコンソール、API、SDK等の様々な方式を通じてオブジェクトを管理できます。API、SDKの例において、オブジェクトの命名フォーマットは`<ObjectKey>`です。

>!オブジェクトのアップロードは2種類に分けられ、それぞれ簡単なアップロードとマルチパートアップロードです。
>- 簡単なアップロードの場合、オブジェクトのサイズは5GB以内に限られています。
>- マルチパートアップロードの場合、パートごとのサイズは5GB以内に、パート数は10000以下に限られています。すなわち、最大でアップロード可能なオブジェクトは48.82TBまでです。

それぞれのオブジェクトはオブジェクト鍵(ObjectKey)、データ値（Value）とオブジェクトのメタデータ（Metadata）からなります。

- オブジェクト鍵（ObjectKey）：オブジェクト鍵は、バケットにおけるオブジェクトの一意な識別子です。
- データ値(Value)：すなわち、アップロードするオブジェクトのサイズです。
- オブジェクトのメタデータ（Metadata）：一連の名称値ペアです。オブジェクトをアップロードする時、これを設定できます。

コンソールを通じてオブジェクトに対して構成することができます。詳しくは、下記の内容を参照してください。

- [オブジェクトの検索](https://cloud.tencent.com/document/product/436/13325)
- [オブジェクト情報の表示](https://cloud.tencent.com/document/product/436/13326)
- [オブジェクトのアクセス権限の設定](https://cloud.tencent.com/document/product/436/13327)
- [カスタマイズHeadersの設定](https://cloud.tencent.com/document/product/436/13361)

## オブジェクト鍵

### 定義

Tencent Cloud COSにおいて、オブジェクトには正当なオブジェクト鍵が必要です。オブジェクト鍵（ObjectKey）はバケットにおけるオブジェクトの一意な識別子です。
例えば：オブジェクトのアクセスアドレス`examplebucket-1250000000.cos.ap-guangzhou.myqcloud.com/folder/picture.jpg`において、オブジェクト鍵は`folder/picture.jpg`です。

### 命名規則

- オブジェクト鍵の名称については、任意のUTF-8文字を使って良いです。名称とその他アプリとの最大限の互換性を確保できるように、大文字と小文字のアルファベット、数字、すなわち[a-z、A-Z、0-9]と記号 `-`、`!`、`_`、`.`、`*` 及びその組み合わせを使用することをおすすめします。
- エンコーディング長さは最大で850バイトです。
- オブジェクト鍵は、ASCIIコントロール文字におけるアップ(↑)、ダウン(↓)、ライト(→)、レフト(←)に対応せず、それぞれCAN(24)、EM(25)、SUB(26)、ESC(27)に対応しています。
- ユーザーのアップロードするファイルまたはフォルダ名に日本語がある場合、そのファイルまたはフォルダにアクセスしたりリクエストを送信したりすると、日本語の部分はURL Encodeの規則でパーセント記号にエンコーディングされます。
例えば：`ドキュメント.doc`にアクセスする場合、オブジェクト鍵は：`ドキュメント.doc`であり、実際に読取内容はURL Encodeの規則でパーセント記号：`%e6%96%87%e6%a1%a3.doc`にエンコーディングされます。

下記はオブジェクト鍵の有効命名例です。

- my-organization
- my.great_photos-2016/01/me.jpg
- videos/2016/birthday/video.wmv

#### 特殊文字

一部の文字はオブジェクト鍵において16進数の形でURLにてエンコーディングされ、または引用される必要があります。ひいては、その一部はプリントアウトできません。故にブラウザはこれらの文字に対応できないかもしれません。これらの文字について、特殊な処理が必要です。特殊処理する必要のある文字を下記に示します。

|  ，  |                              :                               |    ;     |  =   |
| :--: | :----------------------------------------------------------: | :------: | :--: |
|  &   |                              $                               |    @     |  +   |
|  ?   | ASCII文字範囲：00-1F 16進数（0-31 10進数）<br />および7F（127 10進数） | （スペース） |      |

また、一部の文字は大量の特殊処理を経て、はじめてすべてのアプリ間の一致性を確保できます。故にその使用を避けることをおすすめします。使用を避けるべき文字を下記に示します。

|  `   |  ^   |             "              |  \|
| :--: | :--: | :------------------------: | :--: |
|  {   |  }   |             [              |  ]   |
|  ~   |  %   |             #              |  \   |
|  >   |  <   | ASCII <br />128-255 10進数 |

### 関連説明

#### アクセスアドレス

オブジェクトのアクセスアドレスは、バケットアクセスアドレスとオブジェクト鍵からなり、その構造のフォーマットは`[バケットドメイン名]/[オブジェクト鍵]`です。

例えば：オブジェクト`exampleobject.txt`を広州（華南）のバケット`examplebucket-1250000000`にアップロードする場合、`exampleobject.txt`のアクセスアドレスは`examplebucket-1250000000.cos.ap-guangzhou.myqcloud.com/exampleobject.txt`となります。

#### フォルダとディレクトリ

COS自体にはフォルダとディレクトリの概念はありません。COSでは、オブジェクト`project/a.txt`のアップロードによって`project`フォルダが作成されません。ユーザーの使用習慣に合わせるように、COSはコンソールやCOS browser等のグラフィカルツールに「フォルダ」または「ディレクトリ」の表示方法をシミュレートしています。具体的にはキー値が`project/`で、中身が空のオブジェクトを作成することで、従来のフォルダをシミュレートする表示方法で実現します。

例えば：API、SDKアップロードオブジェクト`project/doc/a.txt`を通じて、区切り記号`/`が「フォルダ」の表示方法をシュミレートするので、コンソールには「フォルダ」`project`と`doc`が表示されます。そのうち、`doc`は`project`の下位レベルの「フォルダ」であり、`a.txt`が含まれています。

>!バケットにおける各オブジェクトはフラット化されて分散型クラスタに分布しているため、特定のオブジェクト鍵のプレフィックス容量のサイズを取得できません。各オブジェクトのサイズを累加して取得する必要があります。

フォルダとディレクトリの削除は複雑で、その詳細を下記に示します。

| 削除経路 | 削除                              | 結果                                                         |
| -------- | --------------------------------- | ------------------------------------------------------------ |
| コンソール   | フォルダ`project`                  | オブジェクト鍵のプレフィックスが`project/`であるすべてのオブジェクトは削除されます。               |
| コンソール   | オブジェクト`project/doc/a.txt`          | `project`と`doc`フォルダは留保されます                            |
| API、SDK | オブジェクト`project/`または`project/doc/` | オブジェクト`project/doc/*.txt`は相変わらず留保されます。フォルダ内のオブジェクトを合わせて削除するには、コード走査でフォルダ内のオブジェクトを削除する必要があります。 |

## COSのタイプ

アクセス頻度により、COSはスタンダートストレージ、低頻度ストレージ、CASの3種類のオブジェクトのストレージレベルを提供します。

>!デフォルトのストレージタイプはスタンダートストレージです。

### スタンダートストレージ

スタンダートストレージはユーザーに了高信頼性、高可用性、高パフォーマンスのCOSを提供します。

スタンダートストレージは低アクセス遅延と高スループットであり、大量のホットスポットファイルがあり、頻繁的にデータにアクセスする業務シナリオに適します。

**適用シナリオ**：人気映像、SNS写真、モバイルアプリ、ゲームアプリ、動的サイト。

### 低頻度ストレージ

低頻度ストレージはユーザーに高信頼性、低ストレージコストと低アクセス遅延のCOSを提供します。

低頻度ストレージはストレージ価格を低下させるうえで、TTFBをミリ秒レベルとし、ユーザーがデータを取り戻すシナリオで待つ必要なく、高速読取を実現します。データを取得すると費用が発生しますので、低アクセス頻度の業務シナリオに適します。

**適用シナリオ**：クラウドストレージデータ、ビッグデータ分析、政治・企業の業務データ、低周波数ファイル、監視データ。

### CAS

CASはユーザーに高信頼性、安価ストレージコストと長期保存可能なCOSを提供します。

CASは、最安のストレージ単価を提供しますが、データを読み取る時に長い解凍時間がかかりますので、長期保存用アーカイブデータに適します。

**適用シナリオ**：ファイルデータ、医療映像、科学資料、映像素材。

### ストレージタイプ比較

|              | スタンダートストレージ | 低頻度ストレージ | CAS            |
| ------------ | -------- | -------- | ------------------- |
| レスポンス         | ミリ秒レベル   | ミリ秒レベル   | 事前回復申請必要      |
| 最短課金時間 | -        | 30日    | 90日               |
| 対応地域     | 全地域 | 全地域 | 中国大陸地域のみ  |
| ストレージ費用     | 標準     | 低     | 非常低              |
| データ取戻し費用 | -        | 低     | 高                |
| 読み書きリクエスト費用 | 低     | 低     | 非常低（回復後リクエスト可能） |


## オブジェクトのメタデータ

### 定義

オブジェクトのメタデータはオブジェクトにおける一連の名称値ペアです。サーバーがHTTPプロトコルでHTML資料をブラウザに送信する前に送信した文字列です。HTTP Headerとも呼ばれます。オブジェクトをアップロードする時、HTTP Headerを変更すれば、ページの応答形式を変更でき、或いはキャッシュ時間の変更などの構成情報を送信することができます。

オブジェクトのメタデータには二種類のメタデータがあります：システムのメタデータとユーザーカスタムのメタデータ。

>!オブジェクトのHTTP Headerを変更してもオブジェクト自体を変更することはありません。

### システムのメタデータ

オブジェクトの属性情報、例えばアップロード或いは変更の時間等を指します。

| 名称             | 説明                                                         |
| ---------------- | ------------------------------------------------------------ |
| Date             | 現日付と時間。                                             |
| Content-Length         | RFC 2616で定義されたHTTPリクエスト内容の長さ（バイト）。一般的にはPUTタイプのAPIの操作に使われています。 |
| Last-Modified     | オブジェクトの作成日或いは前回変更日付（より遅いほうに準拠）。                  |
| Content-MD5      | RFC 1864で定義されるBase64エンコーディングされた128-bit内容MD5チェック値。このヘッダーはファイル内容が変更されたかどうかを検証することに用いられます |
| Authorization    | リクエストの署名情報の正当性を検証するために付けられた認証情報。パブリック読み取りのファイルに対して、このヘッダーを付ける必要はありません。 |
| x-cos-version-id | オブジェクトバージョン。バケットでバージョン制御を有効にした場合は、オブジェクトのバージョンIDを返します。      |
| ETag             | PUT Objectを通じてアップロードするオブジェクトの場合、アップロードするファイル内容のMD5値です。マルチパートアップロード或いは履歴バージョンAPIを通じてアップロードするオブジェクトの場合、アップロードするファイル内容の一意のIDであり、検証機能がありません     |
| Expect           | RFC 2616で定義されたHTTPリクエスト内容の長さ（バイト）                  |
| Connection       | クライアントとサーバー間の通信ステータスを宣言します。列挙値：keep-alive、close |

### ユーザーカスタムのメタデータ

オブジェクトのカスタマイズ可能なパラメータを指し、例えば、Content-Type、Cache-Control、Expires、x- cos-meta- 等が挙げられます。詳しくは、[オブジェクトHeadersのカスタマイズ](https://cloud.tencent.com/document/product/436/13361)を参照してください。

| 名称                              | 説明                                                         |
| --------------------------------- | ------------------------------------------------------------ |
| Cache-Control                     | RFC 2616で定義されたキャッシュポリシー。Objectのメタデータとして保存されます          |
| Content-Disposition/Encoding/Type | RFC 2616で定義されたファイル名/エンコードフォーマット/内容タイプ（MIME）。Objectのメタデータとして保存されます |
| Expires                           | RFC 2616で定義されるファイル名。Objectのメタデータとして保存されます          |
| x-cos-acl                         | ObjectのACL属性を定義します。有効値：private、public-read-write、public-read。デフォルト値：private |
| x-cos-grant-*                     | 権限が付与された者に特定の権限を付与します                                         |
| x-cos-meta- *                     | ユーザーカスタムを許可するヘッダー情報をオブジェクトメタデータとして返されます（サイズは2Kまで） |
| x-cos-storage-class               | Objectのストレージレベルを設定します。列挙値：STANDARD, STANDARD_IA、デフォルト値：STANDARD |
| x-cos-server-side-encryption      | オブジェクトに対してサーバーの暗号化を有効にする方法を指定します。COSマスタ暗号鍵で記入します：AES256 |

## オブジェクトサブリソース

COSにはバケットとオブジェクトに関わっているサブリソースがあります。サブリソースはオブジェクトに属し、すなわち、サブリソースは単独で存在せず、常にその他エンティティ(例えば、オブジェクト或いはバケット)に関わって存在します。アクセス制御リスト（Access Control List）とは、特定オブジェクトのアクセス制御情報リストを指し、COSにおけるオブジェクトのサブリソースです。

アクセス制御リストは権限が付与された者と、権限が付与された許可を識別できる認証リストを含むことで、オブジェクトへのアクセス制御を実現します。オブジェクトを作成する時、ACLは完全にオブジェクトを制御できるオブジェクト所有者を識別します。ユーザーはオブジェクトACLを検索し、あるいはそれを最新の認証リストにアップデートすることができます。

>!ACLへのすべてのアップデートは、既存ACLを置き換える必要があります。

## アクセス権限のタイプ

COSは、オブジェクトが2種類の権限を設定することに対応します：**共通権限**と**ユーザー権限**。
**共通権限**：権限の継承、プライベート読み書き、パブリック読み取り・プライベート書き込みを含みます。
- 権限の継承：オブジェクトが継承したバケットの権限はバケットのアクセス権限と一致するようになります。オブジェクトにアクセスする場合、COSはオブジェクト権限がバケットから継承される権限だと識別し、バケットの権限をマッチングすることで、アクセスに応答します。いかなる新しいオブジェクトが追加される場合、デフォルトではバケット権限は継承されます。
- プライベート読み書き：オブジェクトにアクセスする場合、COSは、オブジェクトの権限がプライベート読み書きだと識別します。この場合、バケットがどのような権限であっても、オブジェクトは[署名の認証](/document/product/436/6054)を通じてアクセスする必要があります。
- パブリック読み取り・プライベート書き込み：オブジェクトにアクセスする場合、COSは、オブジェクトの権限がパブリック読みだと識別します。この場合、バケットがどのような権限であっても、オブジェクトを直接ダウンロードできます。

**ユーザー権限**：ルートアカウントはデフォルトでオブジェクトのすべての権限を有します（すなわち完全に制御できる）。またCOSは、サブアカウントにデータの読み取り、データの書き込み、権限の読み取り、権限の書き込み、ひいては完全制御の最高権限を追加することに対応します。

### 適用シナリオ
プライベート読み書きのバケットにおいて特定オブジェクトに対してパブリックアクセスを許可するように設定し、またはパブリック読み書きのバケットにおいて特定オブジェクトに対して権限の認証によりアクセスを許可するように設定します。
