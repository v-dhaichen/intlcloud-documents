COS는 객체에 기반한 수명 주기 구성을 지원하며 버킷에 지정한 설명 언어를 발행함으로써 규칙에 부합하는 객체를 지정한 조건에서 자동으로 일부 조작을 진행할 수 있도록 합니다.

>?수명 주기 설정은 최대 3650일까지 지원합니다.

## 적용 시나리오

### 로그 기록

사용자가 COS로 로그 데이터를 저장할 경우, 수명 주기 구성을 통해 로그 데이터는 30일 후에 자동으로 보관되거나 2년 후에 자동으로 삭제될 수 있습니다.

### 콜드/핫 데이터 분류

핫 데이터는 업로드 후 짧은 시간 내에 대량 접근으로 열도가 높아지고 일정한 시간 후 열도가 점차 낮아지거나 더 이상 실시간 접근이 필요하지 않게 됩니다. 수명 주기 규칙을 통해 30일 전의 데이터를 저빈도 스토리지로 분류하고 60일 전의 데이터를 보관 스토리지로 분류할 수 있습니다.

### 스토리지 관리

COS를 사용하여 파일 스토리지 관리를 할 때 금융, 의료 등의 준법성에 따라 파일의 모든 이전 버전을 장기적으로 저장해야 합니다. 수명 주기 기능을 사용하여 이전 버전의 파일에 보관 스토리지 분류의 조작을 실행할 수 있습니다.

## 지원 설명

### 지원하는 조작

- 스토리지 클래스 전환: 생성한 객체를 지정한 시간 후에 저빈도 스토리지 클래스 STANDARD_IA 또는 보관 스토리지 클래스 ARCHIVE로 전환합니다.
- 만료 삭제: 객체의 만료 시간을 설정하여 객체가 만료된 후 자동으로 삭제되도록 합니다.

### 지원하는 리소스

- 접두사에 따른 구분: 접두사 규칙에 매칭되는 객체는 규칙에 따라 처리됩니다.
- 버전에 따른 관리: 현재 버전이 아닌 객체는 규칙에 따라 처리됩니다.
- 삭제 마크에 따름: 객체 이전 버전이 제거될 경우 삭제 마크 제거를 지정할 수 있습니다.
- 미완료 멀티파트 업로드에 따름: 미완료 멀티파트 업로드 태스크는 처리됩니다.

### 지원하는 시간 조건

- 일별 계산: 규칙에 지정된 작업이 수행될 때까지 객체의 마지막 수정 날짜로부터의 일수를 지정합니다.
- 날짜별 계산: 규칙에 해당하는 조작이 작업을 실행하는 날짜를 지정합니다.

## 주의 사항

### 스토리지 클래스 전환

#### 지원 지역

ARCHIVE 스토리지 클래스로 전환해야 할 경우 CAS가 제공하는 지역에서만 ARCHIVE 유형으로 전환할 수 있습니다.
현재 지원하는 지역: 베이징 ap-beijing, 상하이 ap-shanghai, 광저우 ap-guangzhou, 청두 ap-chengdu, 충칭 ap-chongqing.

#### 단방향 원칙

COS에서 발생하는 스토리지 클래스 전환은 단방향입니다. STANDARD → STANDARD_IA → ARCHIVE만 허용하고 크로스 단계 보관(예: STANDARD → ARCHIVE)도 지원하지만 반방향은 지원하지 않습니다. [PUT Object - Copy](https://cloud.tencent.com/document/product/436/10881)(비 ARCHIVE 유형에 한함)를 호출하거나 [POST Object restore](https://cloud.tencent.com/document/product/436/12633)(ARCHIVE 유형에 한함)을 호출하여 상대적 콜드 스토리지 클래스에서 상대적 핫 스토리지 클래스로 전환할 수 있습니다.

#### 최종 일관성

동일한 그룹의 객체가 여러 개의 규칙을 구성하고 충돌적 상황(만료 삭제 제외)이 존재할 경우, COS는 시간 순서에 따라 실행하고 콜드 스토리지 클래스로의 분류를 최종 실행 효과로 검사합니다.
>!COS는 동일한 그룹의 객체에 여러 개의 충돌적 조건을 포함하는 수명 주기 규칙을 구성하지 않을 것을 권장합니다. 충돌적 실행으로 인해 다른 비용 표현이 발생될 수 있습니다.

### 만료 삭제

#### 처리 로직

객체가 지정한 수명 주기 만료 삭제의 규칙을 매칭했을 경우, Tencent Cloud는 객체를 비동기의 삭제 대기열에 추가하고 실제적으로 발생한 삭제 시간은 생성 시간과 일정한 지연이 있을 것입니다. GET 또는 HEAD Object 조작을 통해 객체의 현재 상태를 획득할 수 있습니다.

#### 최종 일관성

동일한 그룹의 객체가 여러 개의 규칙을 구성하고 충돌적 상황이 존재할 경우, COS는 시간 순서에 따라 실행하고 만료 시간을 기준으로 실행합니다. **만료 삭제의 실행 효력은 스토리지 클래스 전환보다 강합니다**.
>!COS는 동일한 그룹의 객체에 여러 개의 충돌적 조건을 포함하는 수명 주기 규칙을 구성하지 않을 것을 권장합니다. 충돌적 실행으로 인해 다른 비용 표현이 발생될 수 있습니다.

### 비용 주의

#### 실행 설명

어떠한 시간으로 발행한 구성에 대해 COS는 베이징 시간(GMT+8) 익일 0시를 기준으로 조작을 실행합니다. 비동기 대기열에 의한 실행이므로 설정 후 업로드한 객체의 규칙 매칭에 대해 일반적으로 익일 24시 전까지 완료합니다.

수명 주기의 실행 효력은 이상 상황 또는 버킷 중 대량 스토리지 객체를 포함하는 상황을 포함하지 않습니다. 기타 상황으로 인해 완료하지 못했을 경우 GET 또는 HEAD Object 작업으로 객체의 현재 상태를 획득할 수 있습니다.

현재 Tencent Cloud는 수명 주기 실행 효력에 대해 청구서 승낙을 제공하지 않습니다. 즉, 객체의 요금제는 수명 주기 실행 완료 시 변경됩니다.

#### 시간에 대한 민감하지 않음

STANDARD_IA 유형은 최소 30일으로 저장해야 하고 ARCHIVE 유형은 최소 60일으로 저장해야 합니다. 지정한 시간이 지난 후 스토리지 클래스 전환 또는 삭제를 실행할 경우 별도의 비용을 발생하지 않음을 주의하시기 바랍니다. COS는 30/60일 미만의 수명 주기 구성을 검사하지 않으므로 정확한 구성은 사용자의 요구에 따라 실행됩니다.

예를 들어, 하나의 STANDARD_IA 객체가 30일 미만 저장 시 분류 전환이 실행될 경우 객체가 당일에 ARCHIVE 스토리지 비용을 발생하는 동시에 STANDARD_IA 유형은 여전히 30일까지의 비용으로 계산됩니다.

예를 들어 ARCHIVE 객체가 60일 동안 만료되지 않았을 때 만료 삭제된 경우 객체가 60일째까지 ARCHIVE 유형에 대해 계속 청구되게 합니다.

#### 크기에 제한 없음

STANDARD_IA, ARCHIVE 유형에서 별로 객체의 최소 점유 공간을 제한하였습니다. 예를 들어 STANDARD_IA에 64KB보다 작은 파일을 업로드될 경우 64KB로 계산됩니다. COS는 파일의 크기를 검사하지 않고 무조건 지정한 규칙에 따라 객체의 전환 조작을 실행합니다. 

