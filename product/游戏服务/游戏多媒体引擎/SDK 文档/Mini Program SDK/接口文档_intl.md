This article talks about integration for Mini Program in detail to help Mini Program developers debug and integrate APIs for Tencent Cloud's Game Multimedia Engine (GME).


## Applying for GME Service

Apply for GME service in the Tencent Cloud Console by referring to [Integration Guide](https://cloud.tencent.com/document/product/607/10782).

## Applying for Mini Program LVB Service
### 1. Go to Live service interface
Log in to the Tencent Cloud Console, search for the [Live] service, and then go to the [Live Service Application Interface](https://console.cloud.tencent.com/live).

### 2. Apply for Live service
Click **Agree**, and then click **Apply for Activation** to activate the Live service.

![](https://main.qcloudimg.com/raw/3cc2238c29b077c8c9b50a5f62ce0df6.png)

> Identity verification is required before you can apply for the Live service. You can apply for identity verification in **Account Info**.

### 3. Service activated successfully
The following figure indicates that you have applied for the Live service successfully.

![](https://main.qcloudimg.com/raw/53d626f2dea1eaecf459636db1481e4b.png)

### 4. Apply for playback domain name
After the service is activated successfully, click **Domain Name Management** on the left navigation pane to go to the domain name management interface.
The Live service will automatically generate a push domain name. Click **Add Domain Name** to apply for a playback domain name.

![](https://main.qcloudimg.com/raw/d24740621f990a6101ee031de1a78cc4.png)
> Add your domain name that has gone through the filing procedure with MIIT for LVB push and playback. For more information about how to manage and use domain names, see [Domain Name Management](https://cloud.tencent.com/document/product/267/30559) and [CNAME Configuration](https://cloud.tencent.com/document/product/267/30010).


### 5. Playback domain name enabled successfully
After the playback URL is enabled successfully, two domain names are displayed - the push domain name and the playback domain name.

![](https://main.qcloudimg.com/raw/df0850145ad53d12285e8e1b8f29cec5.png)


## Generating RTMP Stream URL
RTMP stream supports two modes: Pulling the RTMP stream of a member who is speaking in the room; or pulling the RTMP streams of all the members who are speaking in the room. In the first mode 1, only the voice of the specified member can be heard, while in the second mode, the voice of all members can be heard.

The following parameters are required for generating an RTMP stream URL:

| Parameter | Description | Where to Acquire |
|-----|-----|-----|
| AppID | The AppID the user applied for on the GME Console | Tencent Cloud Console |
| RoomID | The ID of the room that the user wants to listen to | Generated by developer in application |
| UserID | The ID of another user that the user wants to listen to | The developer generates it in App |
| BizID | The ID generated in the Live Console | See Step 1 below |
| StreamKey | The key generated in Live Console | See Step 1 below |
| StreamID | Unique identifier of RTMP stream | See Step 2 below |
| Timestamp | Timestamp (in sec) | Generated and entered by developer |


Generate an RTMP stream URL by following the steps below:
### 1. Obtain BizID and StreamKey

-  Go to the **Domain Name Management** interface, click **Management** in the **Playback Domain Name** column to go to the **Playback Domain Name Management** interface.
  
  ![](https://main.qcloudimg.com/raw/df0850145ad53d12285e8e1b8f29cec5.png)

-  As shown below, in the CNAME column, the playback domain name before the ".liveplay.myqcloud.com" suffix is the BizID parameter. For example, the BizID in the following figure is 38251.

-  The API Key in the interface is the StreamKey parameter.
  
  ![](https://main.qcloudimg.com/raw/6a0a8c119acd2d49b575a40aa7ededcc.png)


### 2. Generate StreamID

Mode 1:
```
{AppID}_{UserID}_{RoomID}_main
```
Mode 2:
```
mixer_{AppID}_{RoomID}
```

### 3. Generate final URL
```
rtmp://{BizID}.liveplay.myqcloud.com/live/MD5({StreamID})?txSecret= MD5({StreamKey}{streamidMd5}{timestamp})&txTime={timestamp}
```

> The MD5() is a function used to calculate MD5.

## Sample Code

The information required in the sample:

```
Bizid:38251
streamKey:4531cddc5bd6dc28a812bb87121a5853
AppID:1400089356
RoomID:20180301
Userid:123456
timestamp:1551438840
```

The RTMP URL is as follows:

```
Mode 1:
rtmp://38251.liveplay.myqcloud.com/live/38251_5a1d7c2f7e8fcb56942691035b49d960?txSecret=09fcc68fc320336c2b85071b11056bd6&txTime=5c7913f8

Mode 2:
rtmp://38251.liveplay.myqcloud.com/live/38251_fed2b77fb622dcbf978ed6041d9f52d9?txSecret=2d69cfbd346da4531d82624a0bed9368&txTime=5c7913f8
```


