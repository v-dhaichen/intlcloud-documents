開発者がTencent Cloud GME製品を容易にデバッグして導入するために、ここでは全てのプラットフォームに適用される認証暗号鍵関連の技術文書を紹介します。


## ボイス暗号鍵のバックグラウンド配置
Tencent Cloudゲームマルチメディアエンジン（GME）は、リアルタイムボイス及びオフラインボイス認証用の認証暗号鍵を提供しています。このドキュメントは、バックグラウンドの配置案です。
認証に用いる署名生成プロセスは、**プレーンテキスト**、**暗号鍵**と**アルゴリズム**に関連します。

### プレーンテキスト
プレーンテキストは、以下のフィールドのネットワーク配列をつなぎ合わせたものです。

|フィールドの説明    		| タイプ/長さ			| 値の定義/備考|
| ---------------- |-------------------|--------------|
| cVer				|unsigned char/1	|バージョン番号、入力する数値：1		|
| wOpenIDLen		|unsigned short/2	|ユーザーアカウントの長さ|
| strOpenID			|wOpenIDLen		|ユーザーアカウントの文字列|
| dwSdkAppid		|unsigned short/4	|開発者のSDKappid		|
| dwReserved1		|unsigned int/4		|入力する数値：0				|
| dwExpTime		|unsigned int/4		|期限が切れる時刻（現在の時間+有効期間[単位：秒、300秒を推奨]|
| dwReserved2		|unsigned int/4		|入力する数値：-1または0xFFFFFFFF|
| dwReserved3		|unsigned int/4		|入力する数値：0				|
| wRoomIDLen		|unsigned short/2	|ユーザーが参加するルーム番号の長さ。オフラインボイスサービスの場合、0を入力してください				|
| strRoomID			|wRoomIDLen		|ユーザーが参加するルームの番号文字				|

### 暗号鍵
Tencent Cloud GMEコンソールで関連する権限暗号鍵を取得します。
![](https://main.qcloudimg.com/raw/ce1853fb2542adff3fd287c3748f8cf7.png)

## アルゴリズム
TEA対称暗号化アルゴリズム。
一般的な推奨事項として、導入初期段階でクライアント配置案を使用することを推奨します。後でゲームAppのバックグラウンドに配置するよう最適化することができます。

|解決策       		| 強み        		| 弱み																																|
| ------------- |-------------|-------------| 
| バックグラウンド配置    		|安全性が高い	|バックグラウンド開発との共同デバッグが必要|
| クライアント配置      	|導入が迅速	|安全性が低い|

### バックグラウンド配置の使用方法
バックグラウンドで暗号化列を生成した後、クライアントに送信します。クライアントが以下のシナリオに適用し、API:EnterRoomを呼び出してルーム参加操作を行う時、暗号化列をルーム参加パラメータのauthBufferフィールドに伝送します。




### アルゴリズムの暗号化詳細
- 暗号鍵：APPIDは認証暗号鍵のmd5値に対応し、長さは16バイトです
- 暗号化アルゴリズム：TEA暗号化
- 暗号化ライブラリおよび例：添付ファイル[authbuffer.zip](https://main.qcloudimg.com/raw/c8be793e20c85114499f52e0f8c29190.zip)

>!コンソールで暗号鍵を変更した後、15分間～1時間以内に有効となります。頻繁な交換はお勧めしません。



#### 暗号化方法	
- 暗号文中の数字をネットワークバイトオーダに変換します（ビッグエンディアンバイトオーダ）。
- 暗号文を1つの文字列につなぎ合わせます。
- TEA暗号化を使用して文字列を暗号化し、symmetry_encrypt関数によって出力される文字列が権限暗号化列です。

>!2進列を16進法に変換する必要はありません。



