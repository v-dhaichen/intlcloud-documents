이 문서는 CentOS 시스템에서 Java Web 프로젝트를 배포하는 방법을 소개하며, 이제 막 Tencent Cloud를 사용하기 시작한 개인 사용자에게 적용됩니다.## 소프트웨어 버전예제 절차 중 이 문서의 소프트웨어 버전은 다음과 같습니다. 실제로 작업하는 과정에서 소프트웨어 버전을 기준으로 하십시오.- 운영 체제: CentOS 7.5- Tomcat 버전: apache-tomcat-8.5.37- JDK 버전: JDK 1.8.0_201## JDK 설치구매한 후, CVM 세부 정보 페이지에서 [로그인]을 클릭하면 CVM에 바로 로그인할 수 있으며, 사용자 이름과 비밀번호를 입력하면 Java Web 환경을 구축할 수 있습니다. CVM 인스턴스 생성 관련 내용은 [CVM 인스턴스 구매 및 시작](https://cloud.tencent.com/document/product/213/4855)을 참조하십시오.### JDK 다운로드, 명령 입력```mkdir /usr/java  # java 폴더 생성cd /usr/java     # java 폴더 진입# 명령: wget을 직접적으로 사용하여 링크를 다운로드하여 다운로드한 압축 패킷은 압축을 해제할 수 없습니다. 이는 직접 다운로드한 압축 패킷은 기본적으로 Oracle BSD 허가를 받지 않았고 사람마다 쿠키가 다르기 때문입니다. https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html페이지에 이동하여 허가 프로토콜에 동의하고 자신의 쿠키를 보유한 다운로드 링크(JDK 설치 압축 패킷을 직접적으로 다운로드하여 인스턴스에 업로드할 수도 있음)를 획득합니다.wget --no-check-certificate --no-cookies --header "Cookie: oraclelicense=accept-securebackup-cookie" https://download.oracle.com/otn-pub/java/jdk/8u201-b09/42970487e3af4f5aa5bca3f542482c60/jdk-8u201-linux-x64.tar.gz# 압축 해제chmod +x jdk-8u201-linux-x64.tar.gztar -xzvf jdk-8u201-linux-x64.tar.gz```### 환경 변수 설정1. /etc/profile을 엽니다.```vi /etc/profile```2. i 키를 눌러 편집 모드에 진입하여 해당 파일에 다음 정보를 추가합니다.```# set java environmentexport JAVA_HOME=/usr/java/jdk1.8.0_201export CLASSPATH=$JAVA_HOME/lib/tools.jar:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/libexport PATH=$JAVA_HOME/bin:$PATH```3. Esc 키를 눌러 편집 모드에서 벗어난 뒤 :wq를 눌러 파일을 저장 및 종료합니다.4. 환경 변수 로딩```source /etc/profile```### JDK 설치 성공 여부 확인java -version 명령을 운행하면 JDK 버전 정보를 표시할 때 JDK 설치가 완료되었다고 표시됩니다.![](https://main.qcloudimg.com/raw/42b10335d8bf6b38246bf2d853a7e08e.png)## Tomcat 설치### tomcat을 다운로드하고 명령을 입력합니다```# Tomcat 다운로드 및 압축 해제wget http://mirrors.shu.edu.cn/apache/tomcat/tomcat-8/v8.5.37/bin/apache-tomcat-8.5.37.tar.gztar -xzvf apache-tomcat-8.5.37.tar.gzmv apache-tomcat-8.5.37 /usr/local/tomcat/```/usr/local/tomcat/ 디렉터리에서:bin: 스크립트 파일로 Tomcat을 시작/종료할 수 있는 서비스 스크립트를 포함합니다.conf: 각종 전역 구성 파일로 그 중 가장 중요한 것은 server.xml과 web.xml입니다.webapps: Tomcat의 주요 Web 게시 디렉터리로 기본적인 상황에서 Web 응용프로그램 파일을 이 디렉터리에 놓습니다.logs: Tomcat 실행 시의 로그 파일을 저장합니다.### 사용자 추가```# 일반 사용자 www를 생성해 Tomcat을 운행합니다useradd www# 웹사이트 루트 디렉터리 생성mkdir -p /data/wwwroot/default# 배포해야 할 Java Web 프로젝트 문서 WAR 패킷을 웹사이트 루트 디렉터리에 업로드한 뒤, 웹 사이트 루트 디렉터리의 파일 권한을 www로 변경합니다. 이 예제는 웹사이트 루트 디렉터리에서 다음과 같은 Tomcat 테스트 페이지를 생성합니다.평가판echo Hello Tomcat! > /data/wwwroot/default/index.jspchown -R www.www /data/wwwroot```### JVM 메모리 매개변수 설정/usr/local/tomcat/bin/setenv.sh 생성```vi /usr/local/tomcat/bin/setenv.sh```i 키를 눌러 편집 모드에 진입하여 다음 내용을 추가하고 저장합니다.```JAVA_OPTS='-Djava.security.egd=file:/dev/./urandom -server -Xms256m -Xmx496m -Dfile.encoding=UTF-8'```### server.xml 구성1. /usr/local/tomcat/conf/ 디렉터리로 전환합니다.```cd /usr/local/tomcat/conf/```2. server.xml을 백업합니다.```mv server.xml server_default.xml```3. 새로운 server.xml 파일을 생성합니다.```vi server.xml```4. i 키를 눌러 편집 모드에 진입하여 다음 내용을 추가합니다.```<?xml version="1.0" encoding="UTF-8"?><Server port="8006" shutdown="SHUTDOWN"><Listener className="org.apache.catalina.core.JreMemoryLeakPreventionListener"/><Listener className="org.apache.catalina.mbeans.GlobalResourcesLifecycleListener"/><Listener className="org.apache.catalina.core.ThreadLocalLeakPreventionListener"/><Listener className="org.apache.catalina.core.AprLifecycleListener"/><GlobalNamingResources><Resource name="UserDatabase" auth="Container" type="org.apache.catalina.UserDatabase" description="User database that can be updated and saved" factory="org.apache.catalina.users.MemoryUserDatabaseFactory" pathname="conf/tomcat-users.xml"/></GlobalNamingResources><Service name="Catalina"><Connector port="8080" protocol="HTTP/1.1" connectionTimeout="20000" redirectPort="8443" maxThreads="1000" minSpareThreads="20" acceptCount="1000" maxHttpHeaderSize="65536" debug="0" disableUploadTimeout="true" useBodyEncodingForURI="true" enableLookups="false" URIEncoding="UTF-8"/><Engine name="Catalina" defaultHost="localhost"><Realm className="org.apache.catalina.realm.LockOutRealm"><Realm className="org.apache.catalina.realm.UserDatabaseRealm"  resourceName="UserDatabase"/></Realm><Host name="localhost" appBase="/data/wwwroot/default" unpackWARs="true" autoDeploy="true"><Context path="" docBase="/data/wwwroot/default" debug="0" reloadable="false" crossContext="true"/><Valve className="org.apache.catalina.valves.AccessLogValve" directory="logs"prefix="localhost_access_log." suffix=".txt" pattern="%h %l %u %t &quot;%r&quot; %s %b" /></Host></Engine></Service></Server>```5. Esc 키를 눌러 편집 모드에서 벗어난 뒤 :wq를 입력하여 저장하고 편집에서 벗어납니다.## Tomcat 시작###방법 1Tomcat 서버의 bin 디렉터리에 진입한 뒤, “./startup.sh” 명령을 실행하여 Tomcat 서버를 시작합니다.```cd /usr/local/tomcat/bin./startup.sh```![](https://main.qcloudimg.com/raw/c118899986968ecd5982eb8cdb2beff9.png)###방법 2빠른 시작으로 설정하면 모든 지역에서 service tomcat start를 통해 Tomcat을 시작할 수 있습니다.```wget https://github.com/lj2007331/oneinstack/raw/master/init.d/Tomcat-initmv Tomcat-init /etc/init.d/tomcatchmod +x /etc/init.d/tomcat```다음 명령을 실행하고 시작 스크립트 JAVA_HOME을 설정합니다.```sed -i 's@^export JAVA_HOME=.*@export JAVA_HOME=/usr/java/jdk1.8.0_201@' /etc/init.d/tomcat```자동 시작 설정```chkconfig --add tomcatchkconfig tomcat on```Tomcat 시작```# Tomcat 시작service tomcat start# Tomcat 운행 상태 확인service tomcat status# Tomcat 종료service tomcat stop```![](https://main.qcloudimg.com/raw/78800e85c09820d98a0a15dc2792aaa8.png)권한 없음이 뜨면 다음을 입력합니다.```cd /usr/localchmod -R 777 tomcat```웹 브라우저 주소란에 http:// 공인 IP: 포트(포트는 server.xml에서 설정한 connector port)를 입력하여 접근을 진행합니다. 아래 그림과 같은 페이지가 나타나면 이는 설치가 성공하였음을 의미합니다.![](https://main.qcloudimg.com/raw/74ec003775915c33a61f7f2434d59a23.png)### 보안 그룹 구성접근이 안된면 보안 그룹을 검사하십시오. 위의 예시 중 server.xml의 connector port는 8080이기 때문에 해당 CVM이 바인딩한 보안 그룹을 TCP:8080에 개방해야 합니다.![](https://main.qcloudimg.com/raw/8f6fcdade7dec6c1a80dbb9af3711796.png)