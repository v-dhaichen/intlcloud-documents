## 仕様シリーズ
### Redis コミュニティ版エンジン

機能        |  スタンドアロン版 | マスタースレーブ版         | クラスタ版           |  
|:-------------: | :---------: |:-----------:| :----------: | 
| 互換性のある Redis バージョン | 2.8       | 2.8         | 4.0        |
| メモリ仕様          | 1GB - 60GB  | 0.25GB - 60GB | 12GB - 4TB |
| シャード数        | -         | -           | 3 – 128    | 
| QPS           | 8万 - 10万     | 8万 - 10万       | 1千万レベル     | 
| リンク数           |   10000   | 10000       | 10000/シャード     | 
| トラフィック制限           |  10MB/S - 64MB/S   | 10MB/S - 64MB/S       | 72MB/S - 5GB/S     | 
|マルチ DB       |          サポート           |      サポート        |      サポート対象外      |
|Mget、Mset |         サポート           |        サポート       |       サポート        |
|lua           |             サポート         |       サポート         |     限定的サポート    |
|水平方向の容量拡張|           -          |    -      |       サポート      |
|垂直方向の容量拡張|             -         |     -       |       サポート       |
|Read/Write Splitting|        サポート対象外               |    サポート対象外      |      サポート      |
|GEOサポート|          サポート対象外             |    サポート対象外      |     サポート      |

### CKV エンジン

|機能        | マスタースレーブ版 | クラスタ版        |   
| :-------------: | :---------: | :-----------: | 
| 互換性のある Redis バージョン | 3.2       | 3.2         |
| メモリ仕様          | 4GB - 384GB | 12GB - 48TB |
| シャード数        | -         | 3 - 128     |
| QPS           |  8万 - 12万    | 1千万レベル      |
| リンク数           |  12000 - 24000    | 12000/分片 - 24000/シャード      |
| トラフィック制限           |  16MB/S - 256MB/S    | 72MB/S - 32GB/S      |
|マルチ DB       |      サポート        |       サポート        |
|Mget、Mset |     サポート     |      サポート      |
|lua          |      サポート     |     限定的サポート     |
|水平方向の容量拡張|    -      |       サポート       |
|垂直方向の容量拡張|    -       |    サポート対象外      |
|Read/Write Splitting|    サポート対象外      |    サポート対象外      |
|GEOサポート|      サポート      |     サポート     |



### インスタンス仕様の対応接続数とトラフィック
**Redis エンジン版**

| 仕様（GB） | 最大接続数 | 最大スループット（MB/s） |
|  :----------: |  :----------: |  :-------------------: |
| 0.25          | 3000       | 10                  |
| 1          | 10000       | 16                  |
| 2          | 10000       | 24                  | 
| 4          | 10000       | 24                  |
| 8          | 10000       | 24                  |
| 12         | 10000       | 32                  | 
| 16         | 10000       | 32                  | 
| 20         | 10000       | 48                  |
| 24         | 10000       | 48                  | 
| 32         | 10000       | 48                  | 
| 40         | 10000       | 64                  | 
| 48         | 10000       | 64                  | 
| 60         | 10000       | 64                  | 

**CKV エンジン版**

| 仕様（GB） | 最大接続数 | 最大スループット（MB/s） | 
|  :----------: |  :----------: |  :-------------------: |
| 4          | 10000       | 24                  |
| 8          | 10000       | 24                  |
| 16         | 10000       | 32                  | 
| 24         | 10000       | 32                  | 
| 32         | 10000       | 32                  | 
| 48         | 18000      | 64                  | 
| 64         | 18000      | 64                  | 
| 80         | 18000      | 64                  |
| 96         | 18000      | 64                  | 
| 128        | 24000      | 128                 | 
| 160        | 24000      | 128                 | 
| 192        | 24000      | 128                 | 
| 256        | 24000      | 256                 | 
| 320        | 24000      | 256                 | 
| 384        | 24000      | 256                 | 

クラスタ版接続数 = シャード接続数 * シャード数
クラスタ版スループット = シャードスループット * シャード数
>!接続数9000の旧インスタンスが、容量拡張やダウングレード後には接続数が自動で10000になります。

## パフォーマンスデータ
### パフォーマンス参照値
Redis コマンドの実行にかかる時間はそれぞれ異なり、生産環境の中でサービスが異なればデータベースの操作コマンドも異なります。そのため、対応するパフォーマンスにも違いがあります。ここで挙げるテストデータは、指定されたパラメータにおける参照値であり、参考のためにのみ使用されます。実際の状況では、サービスの実際のテストが必要です。

 - シングルノードテストのパフォーマンス
  
|  Redis インスタンス仕様 | 接続数 | QPS 値 |
|:---------:|:---------:|:--------:|
| Redis スタンドアロン版8GB | 9000 | 8万 - 10万 |
| Redis マスタースレーブ版8GB | 10000 | 8万 - 10万 |
| Redis クラスタ版8GB | 10000 | 8万 - 10万 |
| CKV マスタースレーブ版8GB|  12000    |   8万 - 12万  |

 
 - クラスタ版テストパフォーマンス
   Redis クラスタ版パフォーマンス = Redis マスタースレーブ版パフォーマンス * シャード数
   CKV クラスタ版ラスタ版パフォーマンス = CKV マスタースレーブ版パフォーマンス * シャード数


### テスト方法

 - テスト環境
 
| 圧力テストクライアント CVM 数 | CVM コア数 | CVM メモリ | リージョン | Redis インスタンスサイズ |
|:---------:|:---------:|:---------:|:---------:|:---------:|
| 3 | 2コア |8GB | 広州2区 |Redis スタンドアロン版8GB | 
| 3 | 2コア |8GB | 広州2区 |Redis マスタースレーブ版8GB | 
| 3 | 2コア |8GB | 広州2区 |CKV マスタースレーブ版8GB |


 - テストパラメータ
 ```
redis-benchmark -h 10.66.187.x -p 6379 -a crs-1znib6aw:chen2016 -t set -c 3500 -d 128 -n 25000000 -r 5000000
redis-benchmark -h 10.66.187.x -p 6379 -a crs-1z5536aw:chen2016 -t set -c 3500 -d 128 -n 25000000 -r 5000000
redis-benchmark -h 10.66.187.x -p 6379 -a crs-090rjlih:1234567 -t set -c 3500 -d 128 -n 25000000 -r 5000000
```
 - QPS 計算
3台の圧力測定クライアント redis-benchmark の QPS の和を集計します。


