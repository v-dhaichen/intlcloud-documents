## Overview

CDN acceleration is used to speed up the download and delivery of COS bucket content, especially if the same content is downloaded repeatedly.

## Setup Instructions

You can manage the following domain names to quickly download and deliver objects in buckets:
- Default domain: This is COS origin server's domain name, which is automatically generated based on the bucket name and region when the bucket is created. It should be distinguished from the default accelerated domain name.
- Default accelerated domain: This is the domain name passing through CDN acceleration nodes and is generated by the system. You can choose to enable/disable it.
- Custom accelerated domain: You can bind the registered custom domain name to the bucket on Tencent Cloud's domestic CDN acceleration platform, and access the objects in the bucket via the custom domain name.
- Custom origin domain: You can bind the registered custom domain name to the current bucket, and access the objects in the bucket via the custom domain name.

>! You must activate CDN acceleration to use a custom domain name supported by COS:
1. Domain names bound to CDN Mainland China needs ICP filing, but it does not need to be through Tencent Cloud. 
2. Domain names bound to CDN Outside Mainland China do not need ICP filing, but note that the data and operations on Tencent Cloud still need to comply with the laws and regulations of relevant countries/regions and the [Tencent Cloud Service Agreement](https://cloud.tencent.com/document/product/301/1967).

With CDN acceleration enabled for the default accelerated domain name or the custom domain name, if the origin server is a public-read bucket, the objects in the origin server can be accessed directly via the CDN accelerated domain name or the custom domain name; if the origin server is a private-read bucket, it is recommended to enable the CDN origin-pull authentication and CDN authentication configuration options.

- Origin-pull authentication (CDN service authorization must be added before it can be enabled): If the data requested by a user is not cached in the edge node, CDN fetches the data from the origin server. If COS is used as the origin server and origin-pull authentication is enabled, the CDN edge server accesses the COS origin server using a special service identity (which must be authorized by CDN service) to acquire and cache the data in the private bucket.
- CDN authentication: When a user attempts to acquire cached data by accessing an edge server, the edge server verifies the authentication field in the accessed URL based on the authentication configuration rules to prevent unauthorized access and realize hotlink protection, thus improving the security and reliability of the data cached in the edge server.

CDN authentication configuration and CDN origin-pull authentication do not conflict with each other, but whether to enable them can affect the level of data protection, as shown below:


| Bucket access permission | CDN origin-pull authentication | CDN authentication configuration | Origin server can be accessed via CDN accelerated domain name | Origin server can be accessed via COS origin server's domain name | Scenarios |
| ------------------- | ------------ | ------------ | --------------- | --------------- | ------------ |
| Public read | Disabled | Disabled | Yes | Yes | Public read globally |
| Public read | Disabled | Enabled | URL authentication is required | Yes | Not recommended |
| Public read | Enabled | Disabled | No | Yes | Not recommended |
| Public read | Enabled | Enabled | URL authentication is required | Yes | Not recommended |
| Private read + CDN service authorization | Enabled | Enabled | URL authentication is required | COS authentication is required | Protection throughout link |
| Private read + CDN service authorization | Disabled | Enabled | URL authentication is required | COS authentication is required | Not recommended |
| Private read + CDN service authorization | Enabled | Disabled | Yes | COS authentication is required | Origin server protection |
| Private read + CDN service authorization | Disabled | Disabled | No | COS authentication is required | Not recommended |
| Private read | Disabled | Enabled or disabled | No | COS authentication is required | CDN is unavailable |

>!
>- For the first row of the above list, if the bucket access permission in origin server is public read, and neither CDN origin-pull authentication nor CDN authentication configuration is enabled, then CDN edge servers and buckets in origin server can be accessed directly via the CDN domain name, and buckets in origin server can be accessed directly via the COS domain name.
>- After CDN acceleration is enabled for a domain name, anyone can directly access the origin server via the domain name. Therefore, if you need to keep your data private, be sure to protect your data in the origin server through **Authentication Configuration**.

## Enabling Default Accelerated Domain Names
### Procedure
1. Log in to the [COS Console](https://console.cloud.tencent.com/cos5). Click **Bucket List** on the left sidebar to open the Bucket List page.
2. Click the bucket for which you need to set a domain name to go the COS configuration page, as shown below:
![](https://main.qcloudimg.com/raw/8a4ceacd4892f0f9f660a6f6fa9dacd0.png)
3. Click **Domain Name Management** at the top, click **Edit** in the **Default Accelerated Domain Name**, set the current status of the default accelerated domain name to **Enabled**, and configure as follows:
 - **Origin Server Type**: The origin server type usually defaults to **Default Origin Server**, but if you have enabled static website for the origin server bucket and want to accelerate content delivery for the static website, select **Static Website Origin Server**.
![](https://main.qcloudimg.com/raw/90169099da40a28451808e4f41d94f31.png)
 - **Origin-pull Authentication**: For public-read buckets, you don't need to enable **Origin-pull Authentication**. For private-read buckets, enable [Origin-pull Authentication](#step1) after adding CDN service authorization.
 >! If you have never used Tencent Cloud CDN service, you need to go to CDN Console to activate CDN service before you can access **Domain Name Management**.
4. Click **Save** to acactivate CDN acceleration.
>! For private-read buckets, if both origin-pull authentication and CDN service authorization are enabled, signature is not required for the access to origin server via CDN, and cached resources in CDN will be distributed on the public network, which will affect the data security. Therefore, it is recommended to enable CDN authentication.

<span id="step1"></span>
#### Enabling origin-pull authentication
1. For private-read buckets, **Origin-pull Authentication** needs to be enabled provided that CDN service authorization is added.
2. Enable **Origin-pull Authentication** on the bucket domain name management page. (CDN service authorization must be added before it is enabled.)
![](https://main.qcloudimg.com/raw/08c716a65196d653c56ae3a63e9f0605.png)
3. Click **Save** to activate CDN acceleration.
4. After clicking **Save**, you can see the default accelerated domain name is under deployment. The status of **CDN authentication** is displayed at the bottom. Click **Authentication Configuration** to configure authentication, as shown below:
![](https://main.qcloudimg.com/raw/996b8f07d0c026e314b8207a2ccbc5c5.png)
5. You can go to CDN authentication configuration page from [CDN Console](https://console.cloud.tencent.com/cdn) by clicking **Domain Management** -> **Management** for the domain name -> **Security Configuration**. For more information, see [Authentication Configuration](https://cloud.tencent.com/document/product/228/33115).

## Enabling Custom Accelerated Domain Name

>!
>- This document only describes how to add a custom accelerated domain name and enable CDN acceleration on the COS Console. For more information on how to add a custom domain name on the CDN Console, see [Domain Names Access](https://cloud.tencent.com/document/product/228/5734). 
>- A maximum of 10 custom domain names can be added on the COS Console.

### Procedure

1. Log in to the [COS Console](https://console.cloud.tencent.com/cos5). Click **Bucket List** on the left sidebar to open the Bucket List page.
2. Click the bucket for which you need to set a domain name to go the COS configuration page, as shown below:
![](https://main.qcloudimg.com/raw/8a4ceacd4892f0f9f660a6f6fa9dacd0.png)
3. Click **Domain Management** at the top, click **Add Domain** in the column **Custom Acceleration Domain**, and configure as follows:
 - **Domain Name**: Enter the custom domain name to be bound (e.g. `www.example.com`). Ensure that the domain name entered has gone through the filing procedure, and that CNAME corresponding to this domain name has been set at the DNS service provider for the domain name. For more information, see [CNAME Configuration](https://cloud.tencent.com/document/product/228/3121).
 - **Origin-pull Authentication**: Enable origin-pull authentication. For private-read buckets, enable **Origin-pull Authentication** to protect the origin server.
![](https://main.qcloudimg.com/raw/b70664a7da5a81e819a662a9e8253976.png)
>! For private-read buckets, if both origin-pull authentication and CDN service authorization are enabled, then signature is not required for accessing the origin server via CDN, and cached resources in CDN will be distributed on the public network, which will affect the data security. Therefore, it is recommended to enable CDN authentication (Step 5).
4. After the configuration, click **Save** on the operation column on the right to add the domain name. After it is saved, the Enable button for CDN authentication appears in the **CDN Authentication** column. You can click the button to enable the CDN authentication for custom domain name.
**CDN Authentication:**Timestamp authentication can be configured to prevent stealing by malicious users. You can enable the feature after adding the domain name.
5. Log in to [CDN Console](https://console.cloud.tencent.com/cdn/access). On the left sidebar, click **Domain Name Management**.
6. Locate the domain name you need to configure, click **Management** on the operation column on the right to go to the domain name management page, and then click **Security Configuration** at the top. For more information, see [Authentication Configuration](https://cloud.tencent.com/document/product/228/33115).

>! After CDN acceleration is enabled for a domain name, anyone can directly access the origin server via the domain name. Therefore, if you need to keep your data private, be sure to protect your data in the origin server through **Authentication Configuration**.

## Enabling Custom Origin Domain

>!
>- This step shows how to bind the custom domain name to the bucket. You can access the files in the bucket via the custom domain name.
>- A maximum of 20 custom domain names can be added on the COS Console. If you need to apply for a higher quota, [submit a ticket](https://console.cloud.tencent.com/workorder/category) to contact us.

### Procedure

1. Log in to the [COS Console](https://console.cloud.tencent.com/cos5). Click **Bucket List** on the left sidebar to open the Bucket List page.
2. Click the bucket for which you need to set a domain name to go the COS configuration page, as shown below:
![Custom Origin Domain Entry](https://main.qcloudimg.com/raw/8a4ceacd4892f0f9f660a6f6fa9dacd0.png)
3. Click **Domain Management** at the top, and click **Add Domain** in the column **Custom Origin Domain**. If your custom domain name has gone through the [filing](https://cloud.tencent.com/product/ba) procedures with MIIT, and resolution has been added on the [Domain Name Service Console](https://console.cloud.tencent.com/cns/domains), you can enter the custom domain name in the **Domain Name** input box, and click **Save**.
![](https://main.qcloudimg.com/raw/9c1b6532351fc4c0d1daf9fba724a55e.png)
4. If you have not added resolution for your custom domain name, add your custom domain name by following the steps below.
a. Log in to the [Domain Name Service Console](https://console.cloud.tencent.com/cns/domains), click **Domain Name Resolution List** from the left sidebar to go the All Domains page. Click **Add Resolution** to go to the **Add Resolution** dialog box.
![](https://main.qcloudimg.com/raw/77a68240b2ebcaf47352e7e8038a382c.png)
b. Enter the domain name, select the default project from Project Options, and click **OK** to save. Note: Select the default project from Project Options if there is no special requirement.
![Pop-Up Window for Adding Resolution](https://main.qcloudimg.com/raw/3c12489c4b45f223afd7f7cb43598e9c.png)
c. After the domain name is added successfully, click the domain name to go tor the resolution record management page. Click **Add Record** to go to the **Add Record** dialog box.
d. Enter the host record as prompted, select **CNAME** for **Record Type** and **Default** for **Line Type**, enter your bucket domain name in **Record Value**, leave **TTL** as is, and click **OK** to save them. After the resolution is added, it takes about 15 minutes to take effect. Then you can complete relevant configurations as described in Step 3.
![](https://main.qcloudimg.com/raw/ef12eca13884d5e70438c51afab39d29.png)

### Console Version Differences	
The two console versions differ in terms of bucket domain names. For example, the bucket region abbreviation for Guangzhou is `ap-guangzhou` in the new console version, but `cosgz` in the old one. For more information, see [Regions & Endpoints](https://cloud.tencent.com/document/product/436/6224).	

 Due to domain name differences, you need to configure CNAME while using the custom origin domain. We **recommend** that you use the new-version bucket domain name as CNAME, which allows more operations than the old one.	

 You can modify your CNAME information at the DNS vendor:	
- Configure on the [Tencent Cloud Domain Name Resolution Console](https://console.cloud.tencent.com/domain) if your DNS vendor is Tencent Cloud.	
- Configure on the [OSS Domain Console](https://dns.console.aliyun.com/?spm=5176.100251.111252.1.72014f15lWTwr6#/dns/domainList) if your DNS vendor is Alibaba Cloud.	
- Configure on the [AWS Route53 Console](https://console.aws.amazon.com/route53/home?#DomainListing:) if your DNS vendor is Amazon Cloud.	

>!The new and old console versions vary in not only the domain names, but also in the APIs they call. We **recommend** that you use the new version console, as well as the new-version APIs, tools, SDKs, which offers you more stable features. The APIs called to manipulate objects or buckets on the new-version COS Console are XML APIs, while those called on the old version are JSON APIs. For the API differences between the two versions, see [API and SDK](https://cloud.tencent.com/document/product/436/30746).
