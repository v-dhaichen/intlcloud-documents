## 작업 시나리오
본 문서는 Cloud Block Storage（CBS）가 2TB 미만을 예로 하며, CBS의 초기화 조작 가이드를 제공합니다. 디스크 초기화 시나리오의 자세한 설명은 [초기화 시나리오 소개](https://intl.cloud.tencent.com/document/product/362/31596)를 참조하십시오.


## 전제 조건
>! 
>- 데이터 디스크를 포맷하면 모든 데이터가 지워집니다. 데이터 디스크에 데이터가 없거나 중요한 데이터가 백업되었는지 확인하십시오.
>- 만일의 상황을 대비하여 포맷하기 전에 클라우드 서버가 외부 서비스를 중단했는지 확인하십시오.
>
클라우드 서버에 [CBS 마운트](https://intl.cloud.tencent.com/doc/product/362/5745)를 진행하십시오.

## 작업 순서

<span id="Windows2008"></span>
### CBS 초기화(Windows)
>?본 문서에서는 Windows Server 2008 운영 체제를 예시로 합니다. 다른 운영 체제의 포맷 작업은 다를 수 있으니 본 문서는 참조용으로만 사용하십시오.

1. [Windows 클라우드 서버에 로그인](https://intl.cloud.tencent.com/document/product/213/5435)
2. 클라우드 서버 데스크탑에서 [시작]을 클릭하십시오.
3. 시작 메뉴에서 [컴퓨터]를 마우스 우클릭하고 [관리]를 선택하십시오.
4. 왼쪽 사이드바에서 [스토리지]> [디스크 관리]를 선택하십시오. [디스크 관리] 페이지로 진입하십시오.


> 새로운 디스크가 오프라인 상태인 경우(위 이미지와 참조), [5단계](#online)를 수행한 다음 [6단계](#initialize)를 수행하여 초기화를 진행합니다. 그렇지 않은 경우 [6단계] (#initialize)를 직접 수행하여 초기화를 진행합니다.

<span id="online"></span>
5. 오른쪽 창에 디스크 목록이 나타나면 디스크1 영역을 마우스 우클릭하고 메뉴 목록에서 [온라인]을 선택하십시오. 연결 후 디스크1은 [오프라인]상태에서 [미초기화]로 변경됩니다.

 
<span id="initialize"></span>
6. 디스크1 영역을 마우스 우클릭하고 메뉴 목록에서 [디스크 초기화]를 선택하십시오.

7. [디스크 초기화] 대화 상자에서 초기화할 디스크를 표시하고 [MBR(마스터 부트 레코드)] 또는 [GPT(GUID 파티션 테이블)]을 선택한 다음 [확인]을 클릭하십시오.
>!디스크를 사용한 후 디스크 파티션 형식을 전환하면 디스크의 원본 데이터가 지워지므로 실제 필요에 따라 파티션 형식을 선택하십시오.
>

8. 디스크에서 할당되지 않은 영역을 마우스 우클릭하고 [단순 볼륨 생성]을 선택하십시오.

9. [단순 볼륨 마법사 생성] 대화 상자가 나타나면 인터페이스 지시에 따라 [다음]을 클릭하십시오.

10. 볼륨의 기본 값이 최댓값이며, 실제 상황에 따라 볼륨 크기를 지정하십시오. [다음]을 클릭하십시오.
11. 디스크 드라이버 번호를 지정하고 [다음]을 클릭하십시오.

12. [다음 설정에 따라 볼륨 포맷]을 선택하고 실제 상황에 따라 파라미터를 설정하여 새로운 파티션을 포맷 하십시오. [다음]을 클릭하여 파티션 생성을 완료하십시오.

13. [완료]를 클릭하여 마법사를 완료하십시오. 시스템이 초기화 작업을 완료할 때까지 잠시 기다려야 하며, 볼륨 상태가 [양호한 상태]이면 디스크 초기화에 성공했음을 나타냅니다.

  초기화가 완료되면 [컴퓨터] 인터페이스로 들어가서 새로운 디스크를 확인하십시오.


<span id="Linux"></span>
### CBS 초기화(Linux)

실제 사용 시나리오에 따라 초기화 방법을 선택하십시오.
- 전체 하드 디스크가 별도의 파티션으로 표시되는 경우(즉, vdb1 및 vdb2와 같은 여러 논리적 장치 디스크가 없는 경우), 파티션을 사용하지 않고 직접 [로우 디바이스에 파일 시스템 구축](# CreateFileSystemOnBareDevice)하는 것을 권장합니다.
- 전체 하드 디스크를 여러 개의 논리 파티션으로 표시해야 하는 경우(즉, 여러 개의 논리적 장치 디스크가 있는 경우), 파티션 작업을 진행하기 전에 [파티션에서 파일 시스템 구축](# CreateFileSystemOnPartition)을 해야 합니다.

<span id="CreateFileSystemOnBareDevice"></span>
#### 로우 디바이스에 파일 시스템 구축

1. [Linux 클라우드 서버에 로그인](https://intl.intl.cloud.tencent.com/document/product/213/5436)
2. root 사용자로 다음 커맨드를 실행하여 디스크 이름을 확인하십시오.
 ```
fdisk -l
```
 에코 정보는 다음 이미지와 유사합니다. 현재 클라우드 서버에 2개의 디스크가 있으며, "/dev/vda"는 시스템 디스크, "/dev/vdc”는 새로운 데이터 디스크입니다.
 ![](https://main.qcloudimg.com/raw/aad842b12fec3ca583790bff609c9fb7.png)
3. 다음 커맨드를 실행하여 "/dev/vdb"로우 디바이스에 대한 파일 시스템 형식을  직접 생성하십시오.
```
mkfs -t <파일 시스템 형식>/dev/vdb
```
파일 시스템마다 다른 파티션 크기를 지원하므로 실제 요구에 따라 파일 시스템을 선택하십시오. 파일 시스템을 'EXT4’로 설치한 경우를 예시로 합니다.
```
mkfs -t ext4 /dev/vdb
```
>포맷 시 일정 시간이 소모되므로 시스템 실행 상태를 확인하고 종료하지 마십시오.
4. 다음 커맨드를 실행하여 새로운 마운트 포인트를 생성하십시오.
```
mkdir <마운트 포인트>
```
새로운 마운트 포인트가 `/data`인 경우를 예시로 합니다.
```
mkdir /data
```
5. 다음 커맨드를 실행하여 새로운 파티션을 새로운로운 마운트 포인트에 마운트하십시오.
```
mount/dev/vdb <마운트 포인트>
```
새로운 마운트 포인트가 `/data`인 경우를 예시로 합니다.
```
mount /dev/vdb /data
```
6. 다음 커맨드를 실행하여 마운트 결과를 확인하십시오.
```
df -TH
```
> 자동 부팅 마운트 디스크를 설정할 필요가 없으면 다음 단계를 건너 뜁니다.
7. 마운트 방식을 확인하고 해당 정보를 얻습니다.
엘라스틱 CBS의 소프트 링크, 파일 시스템의 UUID(Universally Unique Identifier) 또는 장치 이름을 사용하여 디스크를 자동으로 마운트하도록 선택할 수 있습니다. 관련 지시 사항 및 정보는 다음과 같습니다.
<table>
 <tr>
      <th>마운트 방식</th>
      <th>장단점</th>
      <th>정보 획득 방식</th>
 </tr>
 <tr>
     <td nowrap="nowrap">엘라스틱 CBS의 소프트 링크를 사용합니다.<b>(권장)</b></td>
     <td><b>장점</b>: 엘라스틱 CBS의 소프트 링크는 모두 고정적이고 유일하여 언마운트에 따라 마운트되거나, 포맷에 따라 변하지 않습니다.</br><b>단점</b>:오직 엘라스틱 CBS만 소프트 링크가 있기 때문에 소프트 링크와 포맷 작업을 감지할 수 없습니다.</td>
		 <td nowrap="nowrap">다음 커맨드를 실행하여 엘라스틱 CBS의 소프트 링크를 확인하십시오.</br><pre>ls -l /dev/disk/by-id</pre></td>
	</tr>
	<tr>
	   <td nowrap="nowrap">파일 시스템의 UUID</td>를 사용합니다.
		 <td>파일 시스템의 UUID 변화에 따라 자동 마운트 설치가 유효하지 않을 수 있습니다.</br>예를 들어, 새로운 파일 시스템을 포맷 후, 파일 시스템의 UUID가 변경됩니다.</td>
		 <td nowrap="nowrap">다음 커맨드를 실행하여 파일 시스템의 UUID를 찾으십시오.</br><pre>blkid /dev/vdb</pre></td>
  </tr>
	<tr>
	   <td nowrap="nowrap">장치 이름 사용</td>     
		 <td>장치 이름이 변경되어 자동 마운트 설정이 유효하지 않을 수 있습니다.</br>예를 들어, 데이터가 마이그레이션되면 클라우드 서버의 엘라스틱 CBS가 언마운트된 후 다시 마운트됩니다 운영 체제가 파일 시스템을 다시 식별하면 이름이 변경될 수 있습니다.</td>
		 <td nowrap="nowrap">다음 커맨드를 실행하여 장치 이름을 찾으십시오.</br><pre>fdisk -l</pre></td>
 </tr>
</table>
8. 다음 커맨드를 실행하여 `/etc/fstab`  파일을 백업하십시오. /home 디렉터리에 백업하는 것을 예시로 합니다.
```
cp -r /etc/fstab /home
```
9. 다음 커맨드를 실행하여 VI 편집기를 사용하여 `/etc/fstab` 파일을 엽니다.
```
vi /etc/fstab
```
10. **i**를 눌러 편집 모드로 진입합니다.
11. 커서를 파일 끝으로 이동하여 **Enter**를 누르고 다음 내용을 추가하십시오.
```
<장치 정보> <마운트 포인트> <파일 시스템 형식> <파일 시스템 설치 옵션> <파일 시스템 덤프 빈도> <시작 시 파일 시스템 순서 검사>
```
 - **(권장)**엘라스틱 CBS의 소프트 링크를 사용하여 자동 마운트하는 경우를 예시로 하고 전문의 예시와 더불어 다음을 추가하십시오.
```
/dev/disk/by-id/virtio-disk-drkhklpe /data ext4 defaults 0 0
```
 - 디스크 파티션의 UUID를 사용하여 자동 마운트를 예시로 하고 전문의 예시와 더불어 다음을 추가하십시오.
```
UUID=d489ca1c-5057-4536-81cb-ceb2847f9954 /data  ext4 defaults     0   0
```
 - 장치 이름을 사용하여 자동 마운트를 예시로 하고 전문의 예시와 더불어 다음을 추가하십시오.
```
/dev/vdb /data   ext4 defaults     0   0
```
12. **Esc**를 누르고 **: wq**를 입력한 다음 **Enter**를 누르십시오.
설정을 저장하고 편집기를 종료하십시오.
13. 다음 커맨드를 실행하여 **/etc/fstab** 파일이 성공적으로 작성되었는지 확인하십시오.
```
mount -a 
```
실행이 통과되면 파일이 성공적으로 입력된 것을 의미합니다. 새로운 생성된 파일 시스템은 운영 체제가 부팅될 때 자동으로 마운트됩니다.

<span id="CreateFileSystemOnPartition"></span>
#### 파티션에 파일 시스템 구축

>본 작업은 CentOS 7.5 운영 체제의 fdisk 분할 도구를 사용하여 데이터 디스크 `/ dev / vdb`를 기본 파티션으로 설정합니다. 파티션 포맷은 기본적으로 MBR로 설정되고, 파일 시스템은 EXT4 포맷으로 설정되며 '/data/newpart'에 마운트되고, 부팅 시 자동 마운트되는 경우를 예로 들었습니다. 다른 운영 체제의 포맷 작업은 다를 수 있으니, 본 문서는 참조용으로만 사용하십시오.
>

1. [Linux 클라우드 서버에 로그인](https://intl.intl.cloud.tencent.com/document/product/213/5436)。
2. root 사용자로 다음 커맨드를 실행하여 디스크 이름을 확인하십시오.
 ```
fdisk -l
```
 에코 정보는 다음 이미지와 유사합니다. 현재 클라우드 서버에 2개의 디스크가 있으며 "/dev/vda"는 시스템 디스크, "/dev/vdb"는 새로운 데이터 디스크입니다.
 ![](https://main.qcloudimg.com/raw/aad842b12fec3ca583790bff609c9fb7.png)
3. 다음 커맨드를 실행하여 fdisk 파티션 도구에 진입해 새로운 추가된 데이터 디스크 파티션 조작을 시작하십시오.
 ```
fdisk <새로운 데이터 디스크>
```
 새로운 마운트된 데이터 디스크가 `/dev/vdb`인 경우를 예시로 합니다.
 ```
fdisk /dev/vdb
```
 에코 정보는 다음과 유사합니다.
 ![](https://main.qcloudimg.com/raw/db1fe212e2559ac635c52e5e397e7531.png)
4. `n`을 입력하고 **Enter**를 눌러 새로운 파티션 생성을 시작하십시오.
 에코 정보는 다음과 유사합니다.
 ![](https://main.qcloudimg.com/raw/c89b572c0ac2af1302189f8e7e1a849e.png)
 디스크를 나타내는 2가지 파티션 유형
  - [p]는 주요 파티션을 나타냅니다.
  - [e]는 확장 파티션을 나타냅니다.
5. 주요 파티션을 생성할 경우, `p`를 입력하고 **Enter**를 눌러 주요 파티션 생성하기를 시작하십시오.
 에코 정보는 다음과 유사합니다.
 ![](https://main.qcloudimg.com/raw/efb65b60631d95e9b0213e6fd6125bbb.png)
 [Partition number]는 주요 파티션 번호를 나타내며 1-4 중에서 선택할 수 있습니다.
6. 파티션 번호 1을 선택할 경우, 주요 파티션 번호 `1`을 입력 한 후 **Enter**를 누르십시오.
 에코 정보는 다음과 유사합니다.
 ![](https://main.qcloudimg.com/raw/e1a1a7755a3bb392ec6d623e6774c315.png)
 [First sector]는 초기 실린더 영역을 나타내며, 2048-20971519 중에서 선택할 수 있으며 기본값은 2048입니다.
7. 예로 초기 실린더 번호 2048을 선택하고, **Enter**를 누르십시오.
 에코 정보는 다음과 유사합니다.
 ![](https://main.qcloudimg.com/raw/58a8202531b239a73fd3182d0ea0cf34.png)
 [Last sector]는 컷오프 실린더 영역을 나타냅니다. 2048-20971519를 선택할 수 있으며 기본값은 20971519입니다.
8. 예를 들어, 컷오프 실린더 번호 20971519를 선택하고 **Enter**를 누르십시오.
 에코 정보는 다음과 유사합니다.
 ![](https://main.qcloudimg.com/raw/ad3a6459a6eaf154aed578b37dfc89d0.png)
 파티션이 완료되었음을 나타냅니다. 즉, 60GB 데이터 디스크에 대해 새로운 파티션이 생성된 것 입니다.
9. `p`를 입력하고 **Enter**를 눌러 새로운 파티션의 세부 사항을 확인하십시오.
 에코 정보는 다음과 유사합니다.
 ![](https://main.qcloudimg.com/raw/98427c11e0a181e02eb23a95fc1e908c.png)
 새로운 파티션 `/dev/vdb1`의 세부 사항을 나타냅니다.

>위의 파티션 작업이 올바르지 않으면 `q`를 입력하여 fdisk 파티션 도구를 종료하십시오. 이전 파티션 결과는 유지되지 않습니다.

10. `w`를 입력하고 **Enter**를 눌러 파티션 결과를 파티션 테이블에 작성하십시오.
 에코 정보는 다음 이미지와 유사하며 파티션 생성이 완료되었음을 나타냅니다.
 ![](https://main.qcloudimg.com/raw/7011369be260150fcddf272b4a4ab2fa.png)
11. 다음 커맨드를 실행하여 새로운 파티션 테이블 변경 사항을 운영 체제에 동기화하십시오.
 ```
partprobe
```
12. 다음 커맨드를 실행하여 새로운 파티션 파일 시스템을 시스템에 필요한 형식으로 설정하십시오.
 ```
mkfs -t <파일 시스템 형식> /dev /vdb1
```
 파일 시스템마다 다른 파티션 크기를 지원하므로 실제 요구에 따라 파일 시스템을 선택하십시오. 파일 시스템을 'EXT4’로 설치한 경우를 예시로 합니다.
 ```
mkfs -t ext4 /dev/vdb1
```
 에코 정보는 다음과 유사합니다.
 ![](https://main.qcloudimg.com/raw/6de097cea77634f8847816dd795292a7.png)
 포맷 시 일정 시간이 소모되므로 시스템 실행 상태를 확인하고 종료하지 마십시오.
13. 다음 커맨드를 실행하여 새로운 마운트 포인트를 생성하십시오.
 ```
mkdir <마운트 포인트>
```
 새로운 마운트 포인트가 `/data/newpart`인 경우를 예시로 합니다.
 ```
mkdir /data/newpart
```
14. 다음 커맨드를 실행하여 새로운 파티션을 새로운 마운트 포인트에 마운트하십시오.
 ```
mount/dev/vdb1 <마운트 포인트>
```
 새로운 마운트 포인트가 `/data/newpart`인 경우를 예시로 합니다.
 ```
mount /dev/vdb1 /data/newpart
```
15. 다음 커맨드를 실행하여 마운트 결과를 확인하십시오.
 ```
df -TH
```
 에코 정보는 다음과 유사합니다.
 ![](https://main.qcloudimg.com/raw/b7e5501fed8d7d648b48dc66685baf94.png)
 새로운 파티션 `/dev/vdb1`이 `/data/newpart`에 마운트되었음을 나타냅니다.
 
>자동 부팅 마운트 디스크를 설정할 필요가 없다면 다음 단계를 건너 뜁니다.
>
16. 마운트 방식을 확인하고 해당 정보를 획득합니다.
 엘라스틱 CBS의 소프트 링크, 파일 시스템의 UUID(Universally Unique Identifier) 또는 장치 이름을 사용하여 디스크를 자동으로 마운트하도록 선택할 수 있습니다. 관련 지시 사항 및 정보는 다음과 같습니다.
 <table>
     <tr>
         <th>마운트 방식</th>  
         <th>장단점</th>  
         <th>정보 획득 방식</th>  
     </tr>
	   <tr>      
         <td nowrap="nowrap">엘라스틱 CBS의 소프트 링크를 사용합니다.<b>(권장)</b></td>   
	       <td><b>장점</b>: 엘라스틱 CBS의 소프트 링크는 모두 고정적이고 유일하여 언마운트에 따라 마운트되거나, 포맷에 따라 변하지 않습니다.<br><b>단점</b>: 오직 엘라스틱 CBS만 소프트 링크가 있기 때문에 소프트 링크와 포맷 작업을 감지할 수 없습니다.</td>
	       <td nowrap="nowrap">다음 커맨드를 실행하여 엘라스틱 CBS의 소프트 링크를 확인하십시오.</br><pre>ls -l /dev/disk/by-id</pre></td>
     </tr> 
	   <tr>      
         <td nowrap="nowrap">파일 시스템의 UUID 사용</td>   
	       <td>파일 시스템의 UUID 변화에 따라 자통 마운트 설치가 유효하지 않을 수 있습니다.<br>예를 들어, 새로운 파일 시스템을 포맷 후, 파일 시스템의 UUID가 변경됩니다.</td>
	       <td nowrap="nowrap">다음 커맨드를 실행하여 파일 시스템의 UUID를 확인하십시오.</br><pre>blkid /dev/vdb1</pre></td>
     </tr> 
	   <tr>      
         <td nowrap="nowrap">장치 이름 사용</td>   
	       <td>장치 이름이 변경되어 자동 마운트 설정이 유효하지 않을 수 있습니다.<br>예를 들어, 데이터가 마이그레이션되면 클라우드 서버의 엘라스틱 CBS가 언마운트된후 다시 마운트됩니다. 운영 체제가 파일 시스템을 다시 식별하면 이름이 변경될 수 있습니다.</td>
	       <td>다음 커맨드를 실행하여 장치 이름을 확인하십시오.</br><pre>fdisk -l</pre></td>
     </tr> 
</table>
17. 다음 커맨드를 실행하여 `/etc/fstab 파일을 백업하십시오. /home 디렉터리에 백업하는 것을 예시로 합니다.
```
cp -r /etc/fstab /home
```
18. 다음 커맨드를 실행하여 VI 편집기를 사용하여 `/etc/fstab` 파일을 엽니다.
 ```
vi /etc/fstab
```
19. **i**를 눌러 편집 모드에 진입합니다. 
20. 커서를 파일 끝으로 이동하여 **Enter**를 누르고, 다음 내용을 추가하십시오.
 ```
<장치 정보> <마운트 포인트> <파일 시스템 형식> <파일 시스템 설치 옵션> <파일 시스템 덤프 빈도> <시작 시 파일 시스템 순서 검사>
```
 - **(권장)**엘라스틱 CBS의 소프트 링크를 사용하여 자동 마운트하는 경우를 예시로 하고 전문의 예시와 더불어 다음을 추가하십시오.
 ```
/dev/disk/by-id/virtio-disk-drkhklpe-part1 /data/newpart   ext4 defaults     0   2
```
 -  디스크 파티션의 UUID를 사용하여 자동 마운트를 예시로 하고 전문의 예시와 더불어 다음을 추가하십시오.
```
UUID=d489ca1c-5057-4536-81cb-ceb2847f9954 /data/newpart   ext4 defaults     0   2
```
 - 장치 이름을 사용하여 자동 마운트를 예시로 하고 전문의 예시와 더불어 다음을 추가하십시오.
```
/dev/vdb1 /data/newpart   ext4 defaults     0   2
```
20. **Esc**를 누르고 **: wq**를 입력한 다음 **Enter**를 누르십시오.
 설정을 저장하고 편집기를 종료하십시오.
21. 다음 커맨드를 실행하여 `/etc/fstab`파일이 성공적으로 생성되었는지 확인하십시오.
```
 mount -a 
```
실행이 통과되면 파일이 성공적으로 입력된 것을 의미합니다. 새로 생성된 파일 시스템은 운영 체제가 부팅될 때 자동으로 마운트됩니다.

## 관련 작업
[CBS 초기화(2TB 이상)](https://intl.cloud.tencent.com/document/product/362/6735)

