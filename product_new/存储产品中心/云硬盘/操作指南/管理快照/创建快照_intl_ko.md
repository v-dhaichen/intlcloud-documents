## 작업 시나리오
CBS(Cloud Block Storage)를 사용하여 스냅샷을 생성함으로써, 지정된 시간의 CBS 데이터를 저장할 수 있습니다. Tencent Cloud는 증분 방식으로 스냅샷을 생성합니다. 이전 스냅샷과 비교하여 새로 변경된 데이터만 생성하므로, 데이터 볼륨을 크게 변경하지 않고도 비교적 빠른 시간 내에 스냅샷 생성을 완료할 수 있습니다. 스냅샷을 증분 방식으로 생성하는 경우여도, 삭제한 스냅샷은 사용하는 스냅샷 데이터에는 영향을 미치지 않으며, 삭제되지 않은 스냅샷은 CBS를 해당 스냅샷 상태로 복구할 수 있습니다.
CBS는 어떠한 상태에서도 스냅샷을 생성할 수 있지만, 현재 시점에서 이미 입력된 데이터만 스냅샷으로 저장할 수 있습니다. 만약 애플리케이션 프로그램이나 프로세스가 데이터를 입력 중인 경우, 이 부분의 데이터는 해당 시점에 작성된 스냅샷에 저장되지 않을 수 있습니다. 실제 서비스 상황에 따라, 모든 입력을 잠시 중지한 후 스냅샷을 즉시 생성하는 경우와 CVM에서 CBS를 먼저 [언마운트](https://intl.cloud.tencent.com/document/product/362/ 32400)하여 스냅샷을 생성한 후, 다시 [마운트](/doc/product/362/5745)하여 완전한 스냅샷 데이터를 획득하는 경우에 선택할 수 있습니다.

## 전제 조건
- [CBS 생성](https://intl.cloud.tencent.com/document/product/362/5744)에 성공한 경우
- 현재 리전 내의 스냅샷 수와 총 용량이 최댓값이 아닌 경우. 자세한 내용은 [스냅샷 할당량 제한](https://cloud.tencent.com/document/product/362/5754#Constraint)을 참고하십시오.

## 주의사항
스냅샷은 해당 시점에 디스크에 입력된 데이터만 보존하며, 해당 시점에 메모리의 디스크에 입력되지 않은 데이터는 보존하지 않습니다. 스냅샷을 생성하기 전에 전원을 종료하거나 입력된 디스크의 메모리 데이터를 확인하며 디스크 판독이 잠시 정지된 경우, 다음 두 가지 방식으로 작업을 진행하길 권장합니다.
### 데이터베이스 레이어
데이터베이스 유형 서비스의 경우, 먼저 데이터베이스의 모든 테이블을 읽기 전용 상태로 고정시켜 스냅샷을 생성할 때 새로운 데이터 입력을 방지하여 새 데이터가 스냅샷에 찍히지 않도록 합니다. mysql을 예로 들어 다음 작업을 진행하십시오.
1. 'FLUSH TABLES WITH READ LOCK' 명령어를 실행하여 열려 있는 모든 테이블을 닫은 후 전역 읽기 잠금을 사용하여 아래와 같이 모든 데이터베이스의 모든 테이블을 고정하십시오.
![](https://main.qcloudimg.com/raw/287ad27cec557a52a3386a60b937dc9b.png)
2. CBS의 스냅샷을 생성하십시오.
3. ‘UNLOCK TABLES’를 실행하여 아래와 같이 잠금을 해제하십시오.
![](https://main.qcloudimg.com/raw/8a5fdcb0df254f0f9afcf3ef86679fc0.png)

### 시스템 레이어
시스템적인 관점으로 데이터는 처리 과정 중 일반적으로 먼저 메모리 버퍼에 저장된 후 적절한 타이밍에 CBS에 입력됨으로써 시스템 운행 효율성을 향상시킵니다. 이로써 스냅샷이 생성 시 CBS에 기록되지 않은 버퍼의 데이터는 스냅샷에 입력되지 않으며, 스냅샷의 복구와 데이터 일관성에도 영향을 미칩니다.
‘sync' 명령어를 실행하여 시스템 메모리 버퍼 파일의 데이터를 CBS 내에 즉시 입력하도록 하고, 스냅샷을 생성하기 전 새로운 데이터를 입력하지 않도록 하십시오. 명령어가 실행된 후, 캐시의 데이터가 CBS 내에 입력된 경우, 아래와 같이 오류 정보가 리턴되지 않습니다.
![](https://main.qcloudimg.com/raw/e1b0ac245e325281a0693f7ae43946ff.png)



## 작업 순서
## 콘솔을 이용해 스냅샷을 생성할 경우
1. [CBS 콘솔](https://console.cloud.tencent.com/cvm/cbs)에 로그인하십시오.
2. CBS가 있는 라인에서 [스냅샷 생성]을 클릭하십시오.
3. [스냅샷 생성] 대화 상자에서 스냅샷 명칭을 입력하고 [확인]을 클릭하십시오.

### API를 이용해 스냅샷을 생성할 경우
CreateSnapshot 인터페이스를 사용하여 스냅샷을 생성할 수 있습니다. 작업에 대한 자세한 내용은 [스냅샷 생성](https://cloud.tencent.com/document/product/362/15648)을 참조하십시오.
