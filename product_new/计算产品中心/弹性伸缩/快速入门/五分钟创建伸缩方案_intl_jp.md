完全なAuto Scalingソリューションの作成は、以下の3つの手順に従ってください：
![](https://main.qcloudimg.com/raw/bb6c41ddc7c79cb3c76580f9ae42a008.png)

>以下の例で使用されるコンソール方式、API方式を利用したい場合は、[API 使用事例](https://cloud.tencent.com/document/product/377/4232)をご参照ください。。

## 起動設定を作成する
起動設定は、Auto Scalingに使用されるCVMインスタンスの構成情報を定義しました。CVMのイメージ、ストレージ、ネットワーク、セキュリティグループ、ログイン方式と他の構成情報が含まれます。

>起動設定サービスの作成は**を完全無料**です。お気軽に作成してください。

1. [ Auto Scalingコンソール](https://console.cloud.tencent.com/autoscaling/config)にログインします。
2. 左側ナビゲーションバーで、【起動設定】をクリックし、起動設定の管理画面に入ります。

### リージョンの選択

1. 下図に示すように、起動設定の項目とリージョンを選択します。
リージョンの選択は、手動で追加できるインスタンスとバインディング可能なCloud Load Balancerを制限します。例えば、起動設定のリージョンが広州を選択された場合、広州のインスタンスはスケーリンググループに自動的に追加されます。リージョンが広州のスケーリンググループでは、上海、北京、中国香港、トロントなどの他のリージョンからインスタンスを手動で追加したり、上海、北京、中国香港、トロントなどの他のリージョンでCloud Load Balancerをバインディングしたりことはできません。
![](https://main.qcloudimg.com/raw/014744e64c1b5bb3f251a478baa84540.png)
2. 【新規作成】をクリックし、ポップアップの画面に起動設定の基本情報を記入します。

### モデルの選択

「インスタンスの新規作成」画面で、起動設定の名を記入し、アベイラビリティーゾーンとモデルを選択します。下図に示すように：
![](https://main.qcloudimg.com/raw/0bd50d2d909e34deadd5d9681ba5f7e6.png)

- 設定名の命名
- スケーリンググループにバインディングしたいインスタンスと同じモデルを選択します。

### イメージの選択

起動設定の作成はパブリックイメージまたはカスタマイズイメージを使用できます。
環境をデプロイしたカスタマイズイメージを使用してください。原因は下記の通り：
- パブリックイメージを選択した場合、スケーリングされたインスタンスはまっさらなOSであり、アプリケーション環境を手動でデプロイする必要があります。
- カスタマイズイメージを選択すると、既に環境をデプロイしたCVMインスタンスのイメージを作成し、そのイメージを使用してCVMインスタンスを一括的に作成できます。CVMインスタンスが正常に作成されると、元のCVMインスタンスと同じソフトウェア環境になります。 これにより、一括デプロイの目的を達成できます。

「スケーリンググループがバインディングしたいインスタンス」のイメージをバインディングします。“スケーリンググループがバインディングしたいインスタンス”イメージを作成する場合、[カスタマイズイメージの作成](https://intl.cloud.tencent.com/document/product/213/4942)をご参照ください。
![](https://main.qcloudimg.com/raw/51d1974f89849862c8a4536f02864c2a.png)

### ストレージと帯域幅の選択

「3.ストレージと帯域幅の選択」画面で、ディスクとネットワークを設定します。下図に示すように：
![](https://main.qcloudimg.com/raw/2ef5c1920b6e1fbb46a9a17c5de91529.png)

>! システムディスクがCloud Block Storageを選択する場合、データディスクはデータディスクスナップショットを選択できます。

大量のデータを持つユーザーに対して、データの保存にはデータディスクがよく使用されます。 データディスクAがスナップショットファイルを作成すると、ユーザーはこのスナップショットファイルを使用して複数のディスクを速やかにクローンし、サーバーの快速デプロイを実現できます。

Auto Scalingが新しいCVMインスタンスを自動的に追加する時、起動設定データディスクがデータディスクスナップショットを指定した場合、Tencent Cloud　CBSは「CVMインスタンスを起動してから、設定データを含むデータディスクを自動的にマウントすること」をサポートします。データを自動でコピーする需要を満たします。

起動設定でデータディスクスナップショットを指定した場合、データディスクが確実に自動でマウントされることを保証してからこそスケーリンググループの自動スケールアウトが成功できます。利用者はAuto Scalingを設定する前に、データディスクスナップショットの元のインスタンスに対していくつかの操作をしないと、新規CVMインスタンスを起動する際にデータディスクを自動でマウントすることができません。詳細については、[カスタマイズイメージの利用およびデータディスクスナップショットで新規インスタンスを起動する際にデータディスクを自動マウントする方法](https://cloud.tencent.com/doc/product/362/5564)をご参照ください。

>Auto Scalingサービスは無料です。新規追加したサーバー、ディスクおよびネットワークはCVMのインスタンス、ディスク、ネットワークによって従量課金されます。この画面は利用者の設定によって価格を表示しています。

### 設定情報

1. 「4. セキュリティグループとホストの設定」画面で、ログイン方法とセキュリティグループを選択します。Auto Scalingサービスを通じて追加されたCVMインスタンスはデフォルトでクラウドセキュリティとクラウドモニタリングサービスを無料で利用できます。 下図に示すように：
![](https://main.qcloudimg.com/raw/26b2f98e3a32eb5d9a50af56fbe6eb1e.png)
2. 設定が完了すると、このエントリは画面の起動設定のリストに表示されます。下図に示すように：
![](https://main.qcloudimg.com/raw/7b25c445cf77fecdcf9c67b1f5431a70.png)

## スケーリンググループの作成

スケーリンググループは、同じルールに従い、同じユースケースに向けCVMインスタンスのセットです。
1.  [Auto Scalingコンソール](https://console.cloud.tencent.com/autoscaling/config)にログインします。
2. 左側ナビゲーションバーに、【スケーリンググループ】をクリックし、スケーリンググループの管理画面に入ります。

### スケーリンググループの新規作成

1. 【新規作成】をクリックし、ポップアップ画面でスケーリンググループの基本情報を記入します。中に![](https://main.qcloudimg.com/raw/17d2d70b9ba8dcea80f315841bcd71ac.png)は必須項目です。下図に示すように：
![](https://main.qcloudimg.com/raw/09b130b952b426530acbe5ad6288b5d7.png)
 - スケーリンググループの現在のCVMインスタンス数は、最小スケーリング数と最大スケーリング数の間で維持しています。
	- 初期インスタンス数は、スケーリンググループ開始時のCVMインスタンス数を定義します。
	- 現在のCVMインスタンス数が最小スケーリング数より小さい場合、Auto Scalingサービスは、自動的に最小スケーリング数と同じようにインスタンス数を追加します。
	- 現在のCVMインスタンス数が最大スケーリング数より大きい場合、Auto Scalingサービスは、自動的に最大スケーリング数と同じようにインスタンス数を削減します。
 - 既存の起動設定を選択し、起動設定を新規作成することもできます。
 - ネットワーク、アベイラビリティーゾーン、削除ポリシーを選択します。
 - （オプション）既存のCloud Load Balancerポリシーを関連するか、Cloud Load Balancerを新規作成するかを選択します。
2. 設定が完了すると、このエントリは画面のスケーリンググループのリストに表示されます。下図に示すように：
![](https://main.qcloudimg.com/raw/3943d03b316974835be615acef893bd2.png)

### インスタンスの追加（オプション）

バインディング対象のインスタンスをインスタンスリストに追加します。 設定が完了すると、このエントリは画面の起動設定リストに表示されます。例は以下の通り：
![](https://main.qcloudimg.com/raw/741d48877eaef9642dfff2193d540403.png)

>ここで、インスタンスを追加または削除できない状況が発生した場合、設定した最大スケーリング数と最小スケーリング数を確認してください。

## スケーリングポリシーの作成

Auto Scalingグループは、スケーリングポリシーによってCVMの数を増減します：
- **定時タスク**を作成し、定時的にスケーリング処理を実行するために使用され、周期的に実行するかどうかも設定できます。
- **アラームトリッガーポリシー**を作成し、クラウド監視指標（CPU、メモリ使用率など）に基づいてスケーリング処理を行います。

### 定時タスクの作成

負荷の変化が予測可能な場合、定時タスクを設定してデバイスの拡張処理を計画できます。この機能を使用して、CVMインスタンスを定時的および周期的に自動増減させて、サービス負荷の変化を柔軟に対応できます。デバイスの利用率を改善し、デプロイとインスタンスのコストを節約します。

1. 【スケーリンググループ】画面で 「スケーリンググループ」をクリックし、スケーリンググループ管理画面に入りします。
![スケーリンググループ](https://main.qcloudimg.com/raw/2bd1126836549e378ac52a664e107e79.png)
2. 【定時タスク】タブを選択し、【新規作成】をクリックします。
![定時タスク](https://main.qcloudimg.com/raw/50a8f16c5826b2b1886e1e9aabba8671.png)
3. 新規作成の画面で、定時タスクの名称、実行時間、実行アクティビティなどの情報を指定します。【繰り返し】をチェックして周期・定時的にタスクの実行を定義します。
![定時タスクの新規作成](https://main.qcloudimg.com/raw/196e482efed765613323dea3703532e7.png)
4. 設定が完了すると、この定時タスクが画面のリストに表示されます。例は以下の通り：
![定時タスクリスト](https://main.qcloudimg.com/raw/3bd91d894eeefb2b3fc5119500694574.png)

### アラームトリッガーポリシーの作成

CVM指標に従ってサービスデプロイを調整する場合は、アラームトリッガーポリシーをカスタマイズできます。サービスの負荷により指標が閾値に達する時、このポリシーによりCVMインスタンスの数が自動的に増減し、サービス負荷の変化を柔軟に対応できます。デバイスの利用率を高め、デプロイとインスタンスのコストを節約します。

>- 不健康なCVMを置き換えるために、スケーリンググループが設定される時にデフォルトでping到達不能のアラームトリッガーポリシーを作成します。
> - アラームトリッガーポリシーを使用する前に、CVMイメージに新しいバージョンのクラウド監視Agentをインストールする必要があります。 インストール方法については、[モニタリングコンポーネントのインストール](/doc/product/248/モニタリングコンポーネントのインストール）をご参照してください。

1. 【スケーリンググループ】画面にスケーリンググループIDをクリックし、スケーリンググループ管理画面に入ります。
![スケーリンググループ](https://main.qcloudimg.com/raw/2bd1126836549e378ac52a664e107e79.png)
2. 【アラームトリッガーポリシー】タブを選択し、【新規作成】をクリックします。
![](https://main.qcloudimg.com/raw/50a8f16c5826b2b1886e1e9aabba8671.png)
3. 新規作成画面でアラームポリシーを設定して、クラウド監視の性能指標（CPU、メモリ、帯域幅など）に基づいて、スケーリンググルに指定された台数/割合のCVMインスタンスを自動的に増減します。
レプリケーションポリシー（オプション）を通して、既存のスケーリンググループポリシーを現在のスケーリンググループにコピーすることができます。
![アラームトリッガーポリシーの新規作成](https://main.qcloudimg.com/raw/196e482efed765613323dea3703532e7.png)
4. 設定が完了すると、このアラームトリッガーポリシーが画面のリストに表示されます。例は次の通り：
![アラームポリシーリスト](https://main.qcloudimg.com/raw/3bd91d894eeefb2b3fc5119500694574.png)


