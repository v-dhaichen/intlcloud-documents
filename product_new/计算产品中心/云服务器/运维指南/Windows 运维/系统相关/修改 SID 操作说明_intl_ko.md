## 작업 시나리오

보안 식별자(SID)는 컴퓨터와 사용자에 대해 마이크로소프트 운영 체제에 의해 식별됩니다. 동일한 미러 이미지에 기반하여 생산되는 클라우드 서버의 인스턴스인 SID가 같기 때문에 도메인에 입력할 수 없는 문제를 일으킬 수 있습니다. Windows 도메인 환경을 구축해야 하는 경우, SID 수정을 통하여 도메인 입력 목적을 달성해야 합니다.
본 문서는 Windows Server 2012 작업 시스템의 클라우드 서버를 예로 하여, 시스템에서 sysprep 자체적으로 가져오는 것과 sidchg 툴로 SID 수정 방법을 소개합니다.

## 주의 사항

- 본 설명은 Windows Server 2008 R2,Windows Server 2012 및 Windows Server 2016에만 적용됩니다.
- SID를 배치 수정하는 수요가 있는 경우 사용자 정의 이미지를 제작하여("sysprep 미러 이미지 제작 실행" 선택) 해결할 수 있습니다.
- SID를 수정하면 데이터가 분실되거나 시스템이 손상될 수 있으므로 시스템 디스크 스냅샷이나 미러 이미지를 미리 준비할 것을 권장합니다.

## 작업 방식

### sysprep를 사용하여 SID 수정

> 
> - sysprep를 사용하여 SID 수정 후 시스템 파라미터 대부분은 새로 설정되며, 여기에 IP 구성 정보 등이 포함되므로 반드시 수동으로 재설정 하십시오.
> - sysprep를 사용하여 SID 수정 후 C:\Users\Administrator 는 재설정될 것 입니다. 시스템 디스크의 부분 데이터는 삭제되며, 데이터 백업에 주의하십시오.
> 
1. [VNC 방식을 사용하여 텐센트 클라우드 서버에 로그인](https://intl.cloud.tencent.com/document/product/213/32496)
2. 작업 시스템 인터페이스에서 마우스 우클릭으로 <img src="https://main.qcloudimg.com/raw/87d894e564b7e837d9f478298cf2e292.png" style="margin: 0;"> >[실행]을 클릭하고, **cmd**를 입력한 뒤, **Enter**를 눌러 관리자 커맨드 라인 툴을 여십시오.
3. <span id="step_03">관리자 커맨드 라인 툴에서 다음 커맨드를 실행하여 현재 네트워크 구성을 저장하십시오.</span>
```
ipconfig /all
```
4. 관리자 커맨드 라인 툴에서 다음 커맨드를 실행하여 sysprep 툴을 여십시오.
```
C:\Windows\System32\Sysprep\sysprep.exe
```
5. “시스템 준비 툴 3.14” 창에서 다음 구성을 진행하십시오. 아래 이미지를 참조하십시오.
 - [시스템 정리 작업]을[**새로운 시스템 체험 시작 (OOBE)**]로 설정하고[범용]을 선택하십시오.
 - [종료 옵션]을 [**재시작**]으로 설정하십시오.
6.[확인]을 클릭하여 시스템을 자동으로 재시작하십시오.
7. 시작이 완료되면 안내에 따라 구성을 완료하십시오(언어 선택, 암호 재설정 등).
8. 작업 시스템 인터페이스에서 마우스 우클릭으로 <img src="https://main.qcloudimg.com/raw/87d894e564b7e837d9f478298cf2e292.png" style="margin: 0;"> >[실행]을 클릭하고， **cmd**를 입력한 뒤, **Enter**를 눌러 관리자 커맨드 라인 툴을 여십시오.
9. 다음 커맨드를 실행하여 SID 가 수정되었는지 확인하십시오.
```
whoami /user
```
다음과 같은 정보를 리턴한다면 SID 수정이 완료됐다는 표시입니다.
10. [3단계](#step_03)에 저장된 네트워크 구성 정보에 따라 ENI 관련 정보를 재설정하십시오(IP 주소, 게이트웨이 주소, DNS 등).


### sidchg를 사용하여 SID 수정

1. 클라우드 서버에 로그인하십시오.
2. IE 브라우저를 통해 sidchg 툴에 액세스하고 다운로드하십시오.
sidchg 툴 다운로드 주소: `http://www.stratesave.com/html/sidchg.html`
3. 관리자 커맨드 라인 툴을 사용하여 다음 커맨드를 실행하고 sidchg 툴을 여십시오. 아래 이미지를 참조하십시오.
예를 들어，sidchg 툴이 C: 드라이브에 저장되어 있다면，이름은 sidchg64-2.0p.exe 입니다.
![](https://main.qcloudimg.com/raw/284926ae1eae88228fb009f247b82068.png)
그 중에서，`/R` 은 수정 후 자동 재시작을  나타내고,` /S` 는 수정 후 종료를 나타냅니다. 자세한 내용은 [SIDCHG 공식 설명](http://www.stratesave.com/html/sidchg.html)을 참조하십시오.
4. 인터페이스 안내에 따라 license key 또는  trial key입력하고 **Enter**를 누르십시오.
5. 인터페이스 안내에 따라 **Y**를 입력하고  **Enter**를 누르십시오. 아래 이미지를 참조하십시오.
![](https://main.qcloudimg.com/raw/43c19634475517b183402d15fa32e962.png)
6. SID 수정 안내창에서[확인]을 클릭하여 SID 재구성을 진행하십시오. 아래 이미지를 참조하십시오.
재구성 과정에서 시스템은 재시작됩니다.
7. 시작이 완료되면 마우스 우클릭으로 <img src="https://main.qcloudimg.com/raw/87d894e564b7e837d9f478298cf2e292.png" style="margin: 0;"> >[실행]을 클릭하고, **cmd**를 입력한 뒤, **Enter**를 눌러 관리자 커맨드 라인 툴을 여십시오.
8. 다음 커맨드를 실행하여 SID 가 수정되었는지 확인하십시오.
```
whoami /user
```
다음과 같은 정보를 리턴하면 SID 수정이 완료되었음을 의미합니다.
