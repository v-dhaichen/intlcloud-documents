본 문서는 Windows 인스턴스에 연결할 수 없을 때 문제 조사 방법 및 Windows 인스턴스에 연결되지 않는 주요 원인, 조사, 문제 위치 파악을 안내하고 해결 방안을 소개합니다.

## 예상 원인
Windows 인스턴스에 로그인할 수 없는 주요 원인에는 다음 내용이 포함됩니다.
- [비밀번호 문제로 인해 로그인할 수 없을 경우](#CryptographicProblem)
- [대역폭 이용률이 너무 높을 경우](#BandwidthUtilization)
- [서버 고부하](#HighServerLoad)
- [원격 포트 구성이 비정상인 경우](#RemotePortConfiguration)
- [보안 그룹 규칙이 적합하지 않을 경우](#SafetyGroupRule)
- [방화벽 또는 보안 소프트웨어로 인해 로그인 비정상일 경우](#LoginSecuritySoftware)
- [원격 데스크톱 연결 중 인증 오류가 나타날 경우](#AuthenticationError)

## 자가 진단 툴 사용

Tencent Cloud는 대역폭, 방화벽 및 보안 그룹 설정 등의 문제로 인해 Windows 인스턴스 연결이 불가능한 것인지 판단할 수 있는 자가 진단 툴을 제공합니다. 70%의 장애는 툴에 의해 위치가 측정되며, 점검된 원인에 따라 로그인 실패를 일으키는 장애 문제의 위치를 측정할 수 있습니다.
1. [자가 진단](https://console.cloud.tencent.com/workorder/check)을 클릭하여 자가 진단 툴을 여십시오.
2. 진단할 CVM instance-id를 입력하고 [진단 시작]을 클릭하십시오. 아래 이미지를 참조하십시오.

만약 문제가 자가 진단 툴을 통해 진단되지 않으면 [VNC 방식을 통한 로그인](#VNC)으로 CVM 장애를 조사하길 권장합니다.

<span id="TroubleshootingIdeas"></span>
## 장애 처리

<span id="VNC"></span>
### VNC 방식을 통한 로그인

RDP 또는 원격 로그인 소프트웨어를 통해 Windows 인스턴스에 로그인할 수 없을 때 Tencent Cloud VNC 로그인 방식을 사용해 로그인하면 장애 원인 위치를 파악하는 데 도움이 됩니다.
1. [Tencent Cloud 콘솔](https://console.cloud.tencent.com/cvm/index)에 로그인하십시오.
2. 인스턴스 관리 페이지에서 로그인할 인스턴스를 선택하고 [로그인]을 클릭하십시오. 아래 이미지를 참조하십시오.
3. 팝업된 “Windows 인스턴스 로그인” 창에서 [기타 방식(VNC)]을 선택하고 [즉시 로그인]을 클릭하십시오.
> 로그인 과정 중 비밀번호를 잊었을 경우, 콘솔에서 인스턴스 비밀번호를 재설정할 수 있습니다. 자세한 내용은 [인스턴스 비밀번호 재설정](https://intl.cloud.tencent.com/document/product/213/16566)을 참조하십시오.
>
4. 팝업된 로그인 창에서 좌측 상단의 “원격 커맨드 발송”을 선택하고 Ctrl-Alt-Delete를 클릭해 시스템 로그인 인터페이스로 진입하십시오. 아래 이미지를 참조하십시오.

<span id="CryptographicProblem"></span>
### 비밀번호 문제로 인해 로그인할 수 없을 경우

**장애 현상**: 잘못된 비밀번호를 입력하거나 비밀번호를 잊었거나 비밀번호 재설정에 실패할 경우 로그인에 실패합니다.
**해결 방법**: [Tencent Cloud 콘솔](https://console.cloud.tencent.com/cvm/index)에서 인스턴스의 비밀번호를 재설정하고 인스턴스를 재시작하십시오.
**처리 순서**: 인스턴스 비밀번호 재설정 방법은 [인스턴스 비밀번호 재설정](https://intl.cloud.tencent.com/document/product/213/16566)을 참조하십시오.

<span id="BandwidthUtilization"></span>
### 대역폭 이용률이 너무 높을 경우

**장애 현상**: 자가 진단 툴을 통한 진단에서 대역폭 이용률이 너무 높은 것이 문제 원인임을 표시합니다.
**처리 순서**
1. [VNC 로그인](#VNC)을 통해 인스턴스에 로그인하십시오.
2. [높은 대역폭 점유율로 인해 로그인 불가](https://cloud.tencent.com/document/product/213/10334#.E9.92.88.E5.AF.B9-windows-.E6.9C.8D.E5.8A.A1.E5.99.A8)를 참조하여 인스턴스의 대역폭 사용 상황 조회 후 장애를 처리하십시오.

<span id="HighServerLoad"></span>
### 서버 고부하

**장애 현상**: 자가 진단 툴 또는 클라우드 모니터링을 통하여 서버 CPU의 고부하로 인해 시스템 원격 연결 및 액세스 진행 시 심한 렉이 발생한다고 표시합니다.
**예상 원인**: 트로이 목마 바이러스, 타사 바이러스 백신 소프트웨어, 애플리케이션 오류, 드라이버 오류 또는 소프트웨어 백그라운드의 자동 업데이트로 인해 CPU 사용량이 높아져 CVM에 로그인하지 못하거나 액세스 속도가 느려질 수 있습니다.
**처리 순서**
1. [VNC 로그인](#VNC)을 통해 인스턴스에 로그인하십시오.
2. [Windows 인스턴스: CPU 및 메모리의 높은 사용량으로 인해 로그인 불가](https://cloud.tencent.com/document/product/213/10233)를 참조하여 "작업 관리자"의 고부하 프로세스 위치를 측정하십시오.

<span id="RemotePortConfiguration"></span>
### 원격 포트 구성이 비정상일 경우

**장애 현상**: 원격 연결이 불가하거나 원격 액세스 포트가 기본 포트가 아니거나 수정되었거나 3389 포트가 열려 있지 않습니다.
**문제 위치 확인**: 인스턴스의 공용 네트워크 IP를 ping 체크 가능 여부와 telnet 명령어를 통해 포트가 열려 있는지 점검하십시오.
**처리 순서**: 자세한 내용은 [포트 문제로 원격 로그인 불가](https://cloud.tencent.com/document/product/213/10232)를 참조하십시오.

<span id="SafetyGroupRule"></span>
### 보안 그룹 규칙이 적합하지 않을 경우

**장애 현상**: 자체 진단 툴의 진단을 통해 보안 그룹 규칙이 적합하지 않게 설정되어 로그인하지 못하는 것을 발견합니다.
**처리 순서**: [보안 그룹(포트) 진단 툴](https://console.cloud.tencent.com/vpc/helper)을 통해 진단을 진행하십시오.
> 원격 로그인한 Windows 인스턴스는 3389 포트의 개방이 필요합니다.
> 보안 그룹 포트 설정에서 문제가 확인될 경우, 툴의 [원클릭 오픈]을 통해 포트를 개방할 수 있습니다.
보안 그룹 규칙을 사용자 정의로 설정할 경우, [보안 그룹 작업](https://intl.cloud.tencent.com/document/product/213/18197)을 참조하여 새로운 보안 그룹 규칙을 생성하십시오.



<span id="LoginSecuritySoftware"></span>
### 방화벽 또는 보안 소프트웨어로 인해 로그인 비정상이 발생할 경우

**장애 현상**: CVM 방화벽의 구성 또는 보안 소프트웨어로 인해 로그인 비정상 문제가 발생합니다.
**문제 위치 확인**: VNC 로그인 방식을 통해 Windows 인스턴스에 로그인한 뒤, 서버 내부의 방화벽 활성화 여부와 360, safedog 등과 같은 보안 소프트웨어 설치 여부를 점검하십시오.
> 이 작업은 CVM 방화벽의 종료와 관련되어 있으므로 본인에게 작업을 진행할 권한이 있는지 확인해야 합니다.
>
**처리 순서**: 방화벽 또는 설치된 보안 소프트웨어를 종료한 뒤 원격 연결을 다시 시도하여 원격 로그인에 성공하는지 확인하십시오. 다음의 작업은 Windows Server 2016 인스턴스의 방화벽을 예시로 들어 종료하는 방법을 설명합니다.
1. [VNC 로그인](#VNC)을 통해 인스턴스에 로그인하십시오.
2. 운영 체제 인터페이스에서 <img src="https://main.qcloudimg.com/raw/6e36af2ceb4604b81de13cb42f30e859.png" style="margin: 0;"> 클릭 후, [제어판]을 선택하여 제어판 창을 여십시오.
3. [Windows 방화벽]을 클릭해 “Windows 인터페이스”로 진입하십시오.
4. 좌측의 [Windows 방화벽 활성화 및 종료]를 클릭해 “사용자 정의 설정” 인터페이스에 진입하십시오.
5. [개인 네트워크 설정] 및 [공용 네트워크 설정]에서 [Windows 방화벽 종료]로 설정한 뒤, [확인]을 클릭하십시오.
6. 인스턴스를 재시작한 후, 원격 연결을 다시 시도하여 원격 로그인이 성공하는지 확인하십시오.

<span id="AuthenticationError"></span>
### 원격 데스크톱 연결 중 인증 오류가 나타날 경우

**장애 현상**: 원격 데스크톱 연결을 통해 Windows에 로그인할 경우, "함수에 제공한 플래그가 유효하지 않아 인증 오류가 발생했습니다." 또는 "요청 기능이 지원되지 않아 인증 오류가 발생했습니다."의 오류 보고가 나타납니다.
**문제 원인**: Microsoft에서 2018년 3월 보안 업데이트를 배포했습니다. 해당 업데이트는 프로토콜(CredSSP)의 인증 프로세스 중 인증 요청 방식을 수정하여 CredSSP에 존재하는 원격 코드의 취약성을 수정합니다. 클라이언트와 서버 모두 이 업데이트를 설치해야 하며, 그렇지 않을 경우 서술된 상황의 문제가 발생할 수 있습니다.
**처리 순서**: 보안 업데이트를 설치함으로써 해결하길 권장합니다. 자세한 내용은 [Windows 인스턴스: 인증 오류 발생](https://cloud.tencent.com/document/product/213/30813)을 참조하십시오.

## 기타 해결 방법
위에 서술된 방법을 통해서도 Windows 인스턴스 연결이 되지 않을 경우, 자가 진단 결과를 저장한 후 [티켓 제출](https://console.cloud.tencent.com/workorder/category)로 피드백을 진행하십시오.
