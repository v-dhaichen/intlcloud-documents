## 問題説明

ウェブサイトにアクセスする際に、ネット渋滞が発生し、スピードが低下しています。

## 問題解析

HTTPリクエストの全プロセスは、ドメイン名の解析、TCP接続の確立、リクエストの送信、サーバーによるリクエストの受信・処理・処理結果の返し、ブラウザによるHTMLコードの解析・ほかのリソースへのリクエスト、およびページのレンダリング・表示を含んでいます。そのうち、HTTPリクエストはユーザーのローカルクライアント、クライアントとサーバー間のネットワークノード、そしてサーバーを通過しています。この三つの段階のいずれかに問題が発生した場合、ウェブサイトにアクセスする際のスピードが低下する可能性があります。

## ソリューション

### ロカールクライアントの確認
1. ロカールクライアントで [華佗診断分析システム](https://ping.huatuo.qq.com/)にアクセスし、ローカルから各ドメイン名にアクセスするスピードをテストします。
2. テスト結果に基づいて、ロカールネットワークに問題があるかどうかを確認します。
例えば、テスト結果が下図に示すようになっている場合は、
![](https://main.qcloudimg.com/raw/1dfe4866d4572d82841225b60d127a1c.png)
結果から各ドメイン名にアクセスする時のレイテンシーを確認し、ネットワークが正常であるかどうかを確認できます。
 - 正常でない場合は、問題を確定して解決するように、ネットワークサービスのプロバイダーに連絡ください。
 - 正常である場合は、[ネットワークリンクの確認](#CheckNetworkLink)を実行してください。

<span id="CheckNetworkLink"></span>
### ネットワークリンクの確認

1. ローカルクライアントでサーバーのパブリックIPをpingすることで、パケットロスや高いレイテンシーがあるかどうかを確認してください。
 - パケットロスや高いレイテンシーがある場合は、MTRを使って診断してください。具体的な操作は、[サーバーのネットワークディレーとパケットロスの処理](https://intl.cloud.tencent.com/document/product/213/14638)をご参照ください。
 - パケットロスや高いレイテンシーがない場合は、[ステップ2](#CheckNetworkLink_step2)を実行してください。
2. <span id="CheckNetworkLink_step2"> `dig/nslookup` コマンドを使ってDNSの解析を確認し、DNS解析による問題であるかどうかをトラブルシューティングします。</span>
直接にパブリックIPを使って該当のページにアクセスし、ウェブサイトにアクセスする際のネット渋滞とスピード低下の原因がDNSにあるかどうかを調べることもできます。
 - そうである場合は、DNS解析を確認してください。具体的な操作は、 [解析発効について](https://cloud.tencent.com/document/product/302/30597)をご参照ください。
 - そうでない場合は、 [サーバーの確認](#CheckServer)を実行してください。

<span id="CheckServer"></span>
### サーバーの確認

1. [CVMコンソール](https://console.cloud.tencent.com/cvm/index)にログインします。
2. 確認するインスタンスのID/インスタンス名を選択し、該当するインスタンスの詳細ページに入ります。
3. 下図に示すように、インスタンスの詳細ページで【モニタニング】タブを選び、インスタンスのリソース利用状況を確認します。
![](https://main.qcloudimg.com/raw/b8396a4507dd6a9808f9907b90e881fa.png)
 - CPU/メモリの使用率が高すぎる場合は、[Windowsインスタンス：CPUとメモリの使用率が高すぎるためログイン不能](https://cloud.tencent.com/document/product/213/10233) と [Linuxインスタンス：CPUとメモリの使用率が高すぎるためログイン不能](https://cloud.tencent.com/document/product/213/10310)を参照して調べてください。
 - 帯域幅の使用率が高すぎる場合は、[帯域幅の占有率が高すぎるためログイン不能](https://cloud.tencent.com/document/product/213/10334)を参照して調べてください。 
 - インスタンスのリソース利用が正常である場合は、 [ほかの問題の確認](#CheckOtherProblems)を実行してください。

<span id="CheckOtherProblems"></span>
### ほかの問題の確認

インスタンスのリソース利用状況に基づいて、サーバー負荷によるリソース消費の増加であるかどうかを判断します。
 - そうである場合は、サービスプログラムを最適化するか、[サーバー構成のアップデート](https://intl.cloud.tencent.com/document/product/213/2178)を行うことをおすすめします。新しいサーバーを購入して、既存のサーバーの負荷を分担させることもできます。
 - そうでない場合は、ログファイルを確認し、問題を特定してから指向性のある最適化を実行することをおすすめします。

