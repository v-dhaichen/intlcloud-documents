このドキュメントは、ウェブサイトにアクセスできない場合の問題のトラブルシューティングと特定について説明します。

## 可能な原因

ネットワークの問題、ファイアウォールの設定、サーバーの負荷が高すぎるなどの原因によって、ウェブサイトにアクセスできなくなっています。

## 故障の処理
<span id="TroubleshootServer"></span>
### サーバー関連問題のトラブルシューティング
サーバーのシャットダウン、ハードウェアの故障、CPU/メモリ/帯域幅の使用率が高すぎるなどの原因によって、ウェブサイトにアクセスできなくなる可能性があります。そのため、順次にサーバーの稼働状態、CPU/メモリ/帯域幅の使用状況をトラブルシューティングすることをおすすめします。

1. 下図に示すように、[CVMコンソール](https://console.cloud.tencent.com/cvm/index)にログインし、インスタンスの管理ページでインスタンスが正常に実行しているかどうかを確認します。
 - 正常に実行している場合は、[ステップ2](#Server_step02)を実行してください。
 - 正常に実行していない場合は、CVMインスタンスをリスタートしてください。
2. <span id="Server_step02">インスタンスのID/インスタンス名をクリックし、該当するインスタンスの詳細ページに入ります。</span>
3. 下図の示すように、【モニタニング】タブを選択し、CPU/メモリ/帯域幅の使用状況を確認します。
 - CPU/メモリの使用率が高すぎる場合は、[Windowsインスタンス：CPUとメモリの使用率が高すぎるためログイン不能](https://cloud.tencent.com/document/product/213/10233) と [Linuxインスタンス：CPUとメモリの使用率が高すぎるためログイン不能](https://cloud.tencent.com/document/product/213/10310)を参照して調べてください。
 - 帯域幅の使用率が高すぎる場合は、[帯域幅の占有率が高すぎるためログイン不能](https://cloud.tencent.com/document/product/213/10334)を参照して調べてください。
 -  CPU/メモリ/帯域幅の使用状況が正常である場合は、[ステップ4](#Server_step04)を実行してください。
4. <span id="Server_step04">次のコマンドを実行し、Webサービスに対応するポートが正常に監視されているかを確認します。</span>
> HTTPサービスによく使われている80ポートを例として、操作について説明します。
>
 - Linuxインスタンス：下図に示すように、`netstat -ntulp |grep 80`コマンドを実行します。
 ![](https://mc.qcloudimg.com/static/img/ab5fa663197c3fa0738b2ceb3f559fd3/image.png)
 - Windowsインスタンス：下図に示すように、CMDコマンドラインツールを立ち上げ、`netstat -ano|findstr :80`コマンドを実行します。
 ![](https://mc.qcloudimg.com/static/img/c9c32a2e9f12235ad3d2a5aca313f298/image.png)
 - ポートが正常に監視されている場合は、[ステップ5](#Server_step05)を実行してください。
 - ポートが正常に監視されていない場合は、Webサービスプロセスが起動されているか、または正常に構成されているかを確認してください。
5. <span id="Server_step05">Webサービスプロセスに対応するポートがパスできるかどうかと、ファイアウォールの設定を確認します。</span>
 - Linuxインスタンス：iptablesが80ポートをインターネットにオープンしているかどうかを確認するために、`iptables -vnL` コマンドを実行します。
    - 80ポートをインターネットにオープンしている場合は、[ネットワーク関連問題のトラブルシューティング](#TroubleshootNetwork)を実行してください。
    - 80ポートをインターネットにオープンしていない場合は、`iptables -I INPUT 5 -p tcp  --dport 80 -j ACCEPT`コマンドを実行して、80ポートをオープンしてください。
 - Windowsインスタンス：OSのインターフェースで、【スタート】>【コントロールパネル】>【ファイアウォール設定】をクリックし、Windowsファイアウォールが無効になっているかを確認します。
		- 無効になっている場合は、[ネットワーク関連問題のトラブルシューティング](#TroubleshootNetwork)を実行してください。
		- 無効になっていない場合は、ファイアウォール設定をオフにしてください。

<span id="TroubleshootNetwork"></span>
### ネットワーク関連問題のトラブルシューティング
ウェブサイトにアクセスできないのは、ネットワーク関連問題が原因である可能性もあります。次のコマンドを実行し、ネットワークにパケットロスや高いレイテンシーがあるかどうかを確認してください。
```
対象サーバーのパブリックIPをpingします
```
- 次のような結果が返された場合は、パケットロスや高いレイテンシーがあることを示しているため、MTRを使ってさらにトラブルシューティングしてください。具体的な操作は、[CVMのネットディレーとパケットロス](https://intl.cloud.tencent.com/document/product/213/14638)をご参照ください。
![](https://mc.qcloudimg.com/static/img/30d9946522f43cfc1c6731b9035ae9e9/image.png)
- パケットロスや高いレイテンシーがない場合は、 [セキュリティグループ設定の関連問題のトラブルシューティング](#TroubleshootSecurityGroup)を実行してください。。

<span id="TroubleshootSecurityGroup"></span>
### キュリティグループ設定の関連問題のトラブルシューティング
セキュリティグループとは、関連するインスタンスのインバウンド・アウトバウンドトラフィックを制御できる仮想ファイアウォールのことです。そのルールは、プロトコルやポート、ポリシーなどを指定できます。Webプロセス関連のポートをインターネットにオープンしていない場合も、ウェブサイトにアクセスできなくなります。
1. [CVMコンソール](https://console.cloud.tencent.com/cvm/index)にログインし、「インスタンスリスト」ページでインスタンスのID/インスタンス名をクリックすることで、該当するインスタンスの詳細ページに入ります。
2. 下図に示すように、【セキュリティグループ】タブを選択し、Webプロセス関連のポートをインターネットにオープンしているかどうかと、バインドされているセキュリティグループと該当するセキュリティグループのインバウンド・アウトバウンドルールを確認します。
 - オープンしている場合は、 [ドメイン名、ICP申告のトラブルシューティングと関係問題の解析](#TroubleshootDomainFilingOrAnalysis)を実行してください。
 - オープンしていない場合は、Webプロセス関係のポートをインターネットにオープンするために、セキュリティグループの設定を変更してください。

<span id="TroubleshootDomainFilingOrAnalysis"></span>
### ドメイン名、ICP申告のトラブルシューティングと関連問題の解析
[サーバー関連問題](#TroubleshootServer)、[ネットワーク関連問題](#TroubleshootNetwork)と[セキュリティグループ設定の関連問題](#TroubleshootSecurityGroup) をトラブルシューティングしたあと、CVMのパブリックIPを使ってアクセスしてください。IPアドレスでアクセスでき、ドメイン名でアクセスできない場合は、ドメイン名のICP申告や解析の問題による可能性があります。

1. 中華人民共和国工業情報化部の規定によるところ、許可を受けず、ICP申告を取得せずにインターネット情報サービスに従事するウェブサイトは、その行為が違法的なものとなります。ウェブサイトの正常な永続稼働に影響しないために、ウェブサイトを立ち上げる場合は、まずはICP申告を行い、通信管理局からICP申告番号を取得してから、ウェブサイトをアクセスできるようにしてください。
 - ドメイン名がICP申告を取得していない場合は、 [ドメイン名のICP申告](https://console.cloud.tencent.com/beian)を実行してください。
 - Tencent Cloudのドメイン名サービスを使用している場合は、 [ドメイン名管理コンソール](https://console.cloud.tencent.com/domain)にログインして該当するドメイン名を確認できます。
 - ドメイン名がICP申告を取得している場合は、[ステップ2](#Analysis_step02)を実行してください。
2. <span id="Analysis_step02">[解析発効について](https://cloud.tencent.com/document/product/302/30597)を参照し、関連する問題を解析し、トラブルシューティングします。</span>
 - ウェブサイトにアクセスできないという問題が解決された場合、タスクは終了します。
 - ウェブサイトにアクセスできないという問題が解決されていない場合は、 [作業依頼書の提出](https://console.cloud.tencent.com/workorder/category?level1_id=6&level2_id=7&source=0&data_title=%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8CVM&level3_id=497&radio_title=%E7%BD%91%E7%AB%99%E6%97%A0%E6%B3%95%E8%AE%BF%E9%97%AE&queue=15&scene_code=14550&step=2)でフィードバックしてください。


