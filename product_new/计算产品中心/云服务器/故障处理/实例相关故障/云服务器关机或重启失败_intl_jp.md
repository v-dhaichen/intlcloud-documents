CVMをシャットダウンまたは再起動する時、シャットダウンが失敗したり、再起動が失敗したりする可能性は非常に低くなります。このような状況が発生した場合は、次のようにCVMに対し故障確認と処理を行います。

## 可能な原因

- CPUもしくはメモリの使用率が高すぎます。
- Linux OSのCVMはまだACPI管理プログラムをインストールしていません。
- Windows OSのCVMは長時間でシステム更新し続けています。
- 初めてwindowsのCVMを購入した場合は、このCVMは初期化されていません。
- OSはあるソフトウェアをインストールしているか、またはトロイの木馬・ウイルスに感染した後、システムが破壊されたなど。

## 故障処理

### CPU/メモリの使用状況を確認する

1. CVM OSの種類によって、CPU/メモリーの使用状況を確認します。
 - Windows CVM：CVMで、「タスクバー」を右クリックして、【タスクマネージャー】を選択します。
 - Linux CVM:`top` コマンドを実行し、`%CPU` 列と`%MEM` 列の情報を確認します。
2. 実際のCPU/メモリの使用状況によって、使用率が高いCPUまたメモリのプロセスを終了します。
シャットダウン/再起動ができなくなる場合、[強制シャットダウン/再起動機能](##MandatoryShutdownOrRestart)を実行してください。

### ACPI管理プログラムをインストールしているかを確認する
> この操作はLinux OSのCVMに適用する。
>
以下のコマンドを実行して、ACPIプロセスが存在するかを確認します。
```
ps -ef | grep -w "acpid" | grep -v "grep"
```
 -  ACPIプロセスが存在する場合、[強制シャットダウン/再起動機能](#MandatoryShutdownOrRestart)を実行してください。
 -  ACPIプロセスを存在しない場合は、ACPI管理プログラムをインストールしてください。詳細的な操作については、[Linux 電源管理設定](https://intl.cloud.tencent.com/document/product/213/2129)をご参照ください。


### WindowsUpdateが実行しているかを確認する
> この操作はwindows OSのCVMに適用する。
>
Windows CVMのシステムインターフェースで、【スタート】>【コントロールパネル】>【Windows Update】をクリックし、更新されているパッチまたはプログラムは存在するかを確認します。
- Windowsはあるパッチ操作を実行しているため、システムをシャットダウンする時にいくつかの処理を行います。更新時間が長すぎるため、シャットダウン/再起動に失敗する可能性があります。Windowsの更新が完了した後、シャットダウン/再起動の操作を試みることをお勧めします。
- 更新しているパッチまたはプログラムがない場合、[強制シャットダウン/再起動機能](#MandatoryShutdownOrRestart)を実行してください。


### CVMの初期化が完了したかどうかを確認する
> この操作はwindows OSのCVMに適用する。
>
初めてWindows CVMを購入する時、システムはSysprep方式でイメージを配信し、初期化処理は時間かかります。初期化が完了する前に、Windowsはシャットダウン/再起動操作を無視し、シャットダウン/再起動に失敗しました。
- 購入したWindows CVMは初期化している場合、Windows CVMの初期化が完了した後、もう一回強制シャットダウン/再起動機能操作を実行してください。
- CVMは初期化が完了した場合、[強制シャットダウン/再起動機能](#MandatoryShutdownOrRestart)を実行してください。

###　インストールしたソフトウェアが正常であるかを確認する

検査ツールまたはウイルス対策ソフトウェアを利用して、CVMの中でインストールしたソフトウェアがトロイの木馬またはウイルスに感染されたなどを検査します。
- 異常が発生した場合、システムが破壊される可能性があり、シャットダウン/再起動が失敗になります。このソフトウェアをアンインストールすることをお勧めします。ウイルス対策ソフトウェアを利用してスキャンするまたはデータのバックアップした後、システムをリインストールします。
- 異常が発生しない場合、[強制シャットダウン/再起動機能](#MandatoryShutdownOrRestart)を実行してください。

<span id="MandatoryShutdownOrRestart"></span>
### 強制シャットダウン/再起動機能

> Tencent Cloudは強制シャットダウン/再起動機能を提供し、CVMのシャットダウン/再起動が何回も失敗した場合、この機能を利用できます。この操作はCVMに対し強制的にシャットダウン/再起動を行い、CVMのデータ損失またはファイルシステムが破壊される可能性があります。
>
1. [CNMコンソール](https://console.cloud.tencent.com/cvm/index)にログインします。
2. インスタンスの管理画面で、シャットダウンまたは再起動するCVMをを選択し、実際の需要によって異なる操作を実行します。
 - CVMをシャットダウンする：【もっと】>【インスタンス状態】>【シャットダウン】をクリックします。
 - CVMをリスタートする：【もっと】>【インスタンス状態】>【リスタート】をクリックします。
3.ポップアップの「シャットダウン」または 「インスタンスの再起動」のウィンドウで、【強制シャットダウン】または【強制再起動】をチェックし、【OK】をクリックします。
 -【強制シャットダウン】をチェックします。下図に示すように:
 ![](https://main.qcloudimg.com/raw/22db326eebab11c60e6bbcf8baa23144.png)
 -【強制再起動】をチェックします。下図に示すように:
 ![](https://main.qcloudimg.com/raw/61ae4a4185110b7ff86507e15047211f.png)
