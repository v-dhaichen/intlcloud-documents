このドキュメントは、セキュリティグループ及びポート設定に関するよくあるユーザーの問題について説明させていただきます。
- コンソールでセキュリティグループの新規作成、設定及び実行する方法を把握したい場合は、 [セキュリティグループ設定](https://intl.cloud.tencent.com/document/product/213/15377)と[セキュリティグループ操作](https://intl.cloud.tencent.com/document/product/213/18197)をご参照ください。

## ポート関連

### インスタンスにログインする前に、どのポートをオーペンする必要がありますか。
一般的には、 Linux インスタンスは22番のポートを、 Windows インスタンスは3389番のポートをオーペンする必要があります。ほかのインスタンスタイプに適用するポートの詳細情報は、 [代表的なケースの設定](https://intl.cloud.tencent.com/document/product/213/32369)をご参照ください。

### CVMはどんな常用ポートがありますか。

 [サーバーの常用ポート](https://intl.cloud.tencent.com/document/product/213/12451)をご参照ください。

### なぜポートをオーペンしますか。特定のポートをオーペンするには、どうすればいいですか。

セキュリティグループでポートをオーペンしないと、ポートに対応するサービスを使えません。セキュリティグループのポートの設定方法とルールについては、[セキュリティグループの操作](https://intl.cloud.tencent.com/document/product/213/18197)をご参照ください。

### ポートを変更した後にサービスが使えなくなったのは、なぜですか。

サービスのポートを変更してから、対応するセキュリティグループで対応するポートをオーペンする必要があります。そうしないと、サービスが使えなくなります。

### Tencent Cloudはどんなポートに対応していませんか。

- Tencent CloudはデフォルトでTCP:25ポートしか制限していません。 [Tencent Cloudコンソール](https://console.cloud.tencent.com/)にログインし、右上の「【アカウント】 > 【25ポートブロック解除】」を選択し、セルフでブロック解除を申請することができます。
- 一部のポートには潜在的なセキュリティリスクがあるため、Tencent Cloudは特に制限していませんが、キャリアはそのポートをブロックします。そのため、アクセスできなくなることもあります。このような状況を回避するように、ポートを変更することをお薦めします。下記のポートでモニタリングを行わないでください。
<table>
<tr><th>プロトコル</th><th>ブロックされる可能性のあるポート</th></tr>
<tr><td>TCP</td><td>42、135、137、138、139、445、593、1025、1434、1068、3127、3128、3129、3130、4444、5554、9996</td></tr>
<tr><td>UDP</td><td>1026、1027、1434、1068、5554、9996、1028、1433、135 - 139</td></tr>
</table>

## セキュリティグループ関連

### セキュリティグループにデフォルトで拒否ルールがあるのは、なぜですか。

セキュリティグループルールは、上から下へと順次にスクリーニングし発効するものです。前に設定した許可ルールが承認された場合、ほかのルールはデフォルトで拒否されます。すべてのポートをオーペンしている場合は、最後の拒否ルールは発効しません。セキュリティのために、当該のコンフィギュレーションをデフォルトで提供しています。

### セキュリティグループの選択に間違いがある場合、当該セキュリティグループをバインディングされたインスタンスにはどんな影響がありますか。どのように解決しますか。

**問題・潜在的リスク**

- Linuxインスタンスのリモートコネクティング（SSH）、 Windowsインスタンスのデスクトップのリモートログインは失敗する可能性があります。
- 当該セキュリティグループのCVMインスタンスのパブリックIPとプライベートIPをリモートでPingする場合、失敗する可能性があります。
- HTTPで当該セキュリティグループのインスタンスによって暴露されるWeb サービスにアクセスする場合、失敗する可能性があります。
- 当該セキュリティグループのインスタンスはInternetサービスにアクセスできない可能性があります。

**ソリューション**

- 上記問題があった場合、コンソールのセキュリティグループ管理でセキュリティグループのルールを改めて設定してください。例えば、デフォルトのオールポートオーペンセキュリティグループのみをバインドします。
- セキュリティグループの具体的な設定ルールは [セキュリティグループの概要](https://intl.cloud.tencent.com/document/product/213/12452)をご参照ください。

### セキュリティグループの方向及びポリシーは何ですか。

セキュリティグループのポリシー方向はアウトバウンドとインバウンドに分けられています。アウトバウンド方向はCVMの送信トラフィックをフィルタリングし、インバウンド方向はCVMの受信トラフィックをフィルタリングします。
セキュリティグループポリシーはトラフィックの**許可**と**拒否**に分けられています。

### セキュリティグループポリシーの発効順序はどうなっていますか。

上から下です。トラフィックがセキュリティグループを通る際のポリシーマッチング順序は上から下です。一旦マッチングに成功したら、ポリシーが発効になります。

### セキュリティグループの許可していないIPがCVMにアクセスできるのは、なぜですか。

可能な原因は下記の通りです。
 CVM は複数のセキュリティグループをバインディングしており、特定のIPがほかのセキュリティグループの中で許可されています。
- 特定のIPが審査済みのTencent Cloud公共サービスに属しています。

### セキュリティグループを使えば、iptablesを使わなくなりますか？

いいえ。セキュリティグループはiptablesと同時に使えます。顧客のトラフィックは2回フィルタリングされます。トラフィックは下記のような方向となります。
- アウトバウンド方向：インスタンスにおけるプロセス > iptables > セキュリティグループ。
- インバウンド方向：セキュリティグループ > iptables > インスタンスにおけるプロセス。

### CVMをすべてリターンしましたが、なぜセキュリティグループを削除できませんか。

ゴミ箱にCVMがあるかないかを確認してください。ゴミ箱にあるCVMとバインディングしている場合、セキュリティグループも削除できません。

### セキュリティグループをクローンする時に、名前は目標エリアのセキュリティグループと同じでよろしいですか。

いけません。名前は、目標エリアの既存のセキュリティグループの名前と異なる必要があります。

### セキュリティグループはクロスユーザーのクローンに対応していますか。

現時点では対応していません。

### セキュリティグループのクロスプロジェクト・クロスリージョンのクローンはクラウドAPIのサポートがありますか。

現時点では、コンソールを利用するユーザーのために、MCのサポートを提供していますが、直接なクラウドAPIのサポートがありません。一括的にインポート・エクスポートした既存のセキュリティグループルールのクラウドAPIにより、間接的にセキュリティグループのクロスプロジェクト・クロスリージョンのクローンを実現できます。

### セキュリティグループのクロスプロジェクト・クロスリージョンのクローンは、セキュリティグループによって管理しているCVMを一緒にコピーしますか。

いいえ。セキュリティグループのクロスリージョンのクローンは、元セキュリティグループのアウトバウンド・インバウンドルールをクローンするだけで、CVMは別途関連付けを行う必要があります。
