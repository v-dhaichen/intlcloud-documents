## 操作シナリオ

サービスマイグレーションはTencent Cloudが企業ユーザーのために開発したマイグレーションプラットホームです。当該マイグレーションプラットホームはソースエンドホストのOS、アプリケーションやアプリケーションデータなどをTencent Cloud Cloud Virtual MachineまたはCloud Block Storageにマイグレーションすることにより、企業のクラウド・クロスクラウドプラットホームのマイグレーション、クロスアカウント/リージョンのマイグレーション又はハイブリッドクラウドのデプロイなどのサービスニーズを満たすことができます。

現在、サービスマイグレーションはオフラインマイグレーションとオンラインマイグレーションを含んでいます。その内、オフラインマイグレーションは下記の2種類を含んでいます。
- [オフラインのインスタンスマイグレーション](#cvmStep)、即ちシステムディスクイメージを指定したCVMにマイグレーションすることです。
- [オフラインのデータマイグレーション](#csmStep)、即ちデータイメージを指定したCloud Block Storageにマイグレーションすることです。

## 前提条件

オフラインマイグレーションはTencent Cloud Cloud Object Storage（COS）のサポートが必要です。顧客の所在するリージョンが COSの対応する範囲にあることを確保してください。
現在、COSの対応しているリージョン範囲は [リージョン及びアクセスドメイン名](https://intl.cloud.tencent.com/document/product/436/6224)をご参照ください。

## 準備事項

> 
> - 現在、Tencent Cloudのサービスマイグレーションはqcow2、vpc、vmdk、rawのイメージフォーマットに対応しています。転送とマイグレーションの時間を短縮するように、圧縮したイメージフォーマットのご利用をお薦めします。
> - イメージをアップロードするCOSのリージョンはマイグレーション先のCVMのリージョンと一致する必要があります。
> - オフラインマイグレーションを行う際に、アップロードするイメージファイルの容量はマイグレーション先のディスク容量より大きくてはなりません。イメージファイルが50Gの場合は、マイグレーションインスタンスのシステムディスクが少なくとも50Gである必要があります。

- イメージ作成ドキュメントにより、マイグレーションするサーバのイメージファイルを作成してください。
 - Windowsシステムは [Windowsイメージ作成ドキュメンテト](https://intl.cloud.tencent.com/document/product/213/17815)をご参照ください。
 - Linuxシステムは [Linuxイメージ作成ドキュメンテト](https://intl.cloud.tencent.com/document/product/213/17814)をご参照ください。
- 作成したイメージファイルをCOSにアップロードします。  
 - イメージファイルは一般的にサイズが大きく、ページでのアップロードが中断しやすいため、COSCMDでイメージをアップロードしてください。操作詳細については、[COSCMDツールドキュメント](https://intl.cloud.tencent.com/document/product/436/10976)をご参照ください。  
 - ほかのクラウドプラットホームからエクスポートしたイメージが圧縮パッケージ（例えば.tar.gz）である場合は、自分で解凍する必要がなく、直接にCOSにアップロードしマイクレーションすればよいです。
- イメージをアップロードするCOSアドレスを取得します。
 [Cloud Object Storageコンソール](https://console.cloud.tencent.com/cos5/bucket) で、先ほどアップロードしたイメージファイルを見つけ、ファイル情報を確認し、ファイルリンクを取得します。
- マイグレーション先のCVM又はCBSを用意します。
[ここをクリックしてCVMを購入する >>](https://buy.cloud.tencent.com/cvm?tab=custom&step=1&regionId=8)
[ここをクリックしてCBS購入ガイドへ >>](https://intl.cloud.tencent.com/document/product/362/32414)


## 操作手順

<span id="cvmStep"></span>
### オフラインのインスタンスマイグレーション

1.  [CVMコンソール](https://console.cloud.tencent.com/cvm/overview)にログインします。
2. 左側ナビゲーションバーで、【サービスマイグレーション】>【[オフラインのインスタンスマイグレーション](https://console.cloud.tencent.com/csm/cvm)】をクリックします。
3. 【新規作成】をクリックします。
4. マイグレーションの準備が完了してから、【次へ】をクリックします。
5. 下図に示すように、タスク名称、COSリンクとマイグレーション先のCVM等のマイグレーション設定情報を記入し、【完成】をクリックすると、マイグレーションタスクの作成が成功です。
>  
> - COSファイルは先に [パブリックリード・プライベートライト権限](https://intl.cloud.tencent.com/document/product/436/13327)を設定する必要があります。
> - マイグレーション先のインスタンスのシステムディスクの容量がアップロードされるイメージファイルのサイズ以上でなければなりません。そうでないと、タスクは失敗します。
> 
![](https://main.qcloudimg.com/raw/6ec8c8cd4f03bcdc5d8d79efaff5be3d.png)
オフラインデータマイグレーションの管理ページに戻り、マイグレーションタスクの進捗を確認することができます。

<span id="csmStep"></span>
### オフラインのデータマイグレーション

1. [CVMコンソール](https://console.cloud.tencent.com/cvm/overview)にログインします。
2. 左側ナビゲーションバーで、【サービスマイグレーション】>【[オフラインのデータマイグレーション](https://console.cloud.tencent.com/csm/cbs?rid=1)】をクリックします。
3. 【新規作成】をクリックします。
4. マイグレーションの準備が完了してから、【次へ】をクリックします。
5. 下図に示すように、タスク名称、COSリンクとマイグレーション先のCBSなどのマイグレーション設定情報を記入し、【完成】をクリックすると、マイグレーションタスクの作成が成功です。
> マイグレーション先のインスタンスのシステムディスクの容量がアップロードされるイメージファイルのサイズ以上でなければなりません。そうしないと、タスクは失敗します。
>

## よくある質問

詳細については、 [サービスマイグレーション類](https://cloud.tencent.com/document/product/213/32962)をご参照ください。

