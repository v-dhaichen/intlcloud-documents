### 작업 시나리오

미러 이미지를 생성할 때 공용 이미지 또는 마켓플레이스 이미지에서 인스턴스를 시작하고 미러 이미지를 사용자 인스턴스에 연결하여 소프트웨어 시나리오를 직접 배포할 수 있습니다. 인스턴스가 정상적으로 실행할 경우 실제 수요에 따라 기본적으로 새 사용자 정의 이미지를 생성할 수 있습니다. 새 사용자 정의 이미지를 생성한 후 해당 미러 이미지를 사용하여 기존 인스턴스와 동일한 사용자 정의 프로젝트를 구성한 새 인스턴스를 시작할 수 있습니다.

> 
> - 사용자 정의 이미지를 생성할 때 시스템은 관련 스냅샷을 기본적으로 생성하므로 해당 스냅샷을 삭제하기 전 관련 미러 이미지를 삭제해야 합니다. 현재 스냅샷은 상용화되어 사용자 정의 이미지를 유지할 경우 일정한 스냅샷 요금이 발생합니다. 스냅샷 청구 정책에 대한 내용은 [스냅샷 상용화 공지](https://cloud.tencent.com/document/product/362/17935)를 참조하십시오.
> - 2018년7월 이후 공용 이미지를 기반으로 생성된 클라우스 디스크 CVM은 온라인 생성 미러 이미지를 지원합니다(인스턴스가 종료되지 않은 상황에서 미러 이미지 생성).
> - 기타 인스턴스가 사용자 정의 이미지를 생성할 때 먼저 인스턴스를 종료하고 미러 이미지가 현재 인스턴스 배포 환경과 일치 한지 확인하십시오.

### 주의사항

- 각 리전은 현재 10개의 사용자 정의 이미지를 지원합니다.
- 다음 디렉터리/파일은 삭제됩니다.
 - /var/log/  
 - /root/.bash_history、/home/ubuntu/.bash_history（Ubuntu 시스템）
- Linux 인스턴스가 사용자 정의 이미지를 생성할 때 데이터 디스크 구성에 /etc/fstab가 포함되지 않으면 해당 미러 이미지로 생성된 인스턴스가 정상적으로 시작하지 않습니다. 사용자 정의 이미지를 생성하는 Linux 인스턴스가 마운트된 데이터 디스크가 있는 경우 /etc/fstab에서 자체 구성된 데이터 디스크의 관련 구성을 주석 처리하거나 삭제하여야 합니다.
- 제작 프로세스는 10분 또는 그 이상 시간이 소요되며 구체적인 시간은 인스턴스의 데이터 크기와 연관되므로 서비스에 영향을 주지 않도록 미리 준비하십시오.

## 작업 순서

### 콘솔을 사용하여 인스턴스에서 생성

1. [CVM 콘솔](https://console.cloud.tencent.com/cvm/)에 로그인하십시오.
2. 인스턴스 관리 페이지에서 미러 이미지를 생성할 인스턴스를 선택하고[MORE]>[인스턴스 상태]>[종료]를 클릭하십시오. 아래 이미지를 참조하십시오.
![종료](https://main.qcloudimg.com/raw/09102b9c844236d102a7f9e29a7e595c.png)
3. 인스턴스가 종료된 후 인스턴스 행에서[MORE]>[미러 이미지 생성]을 클릭하십시오. 아래 이미지를 참조하십시오.
![](https://main.qcloudimg.com/raw/5f4190da7a8b547fd751c5b5e0790755.png)
4. 팝업된 “사용자 정의 이미지 생성” 창에서，“미러 이미지 이름” 및 “미러 이미지 설명”을 입력하고[미러 이미지 생성]을 클릭하십시오.
> 콘솔의 오른쪽 상단을 클릭하면 <img src="https://main.qcloudimg.com/raw/31b31c7b27848f0378932f17273feff3.png" style="margin: 0;"></img>，미러 이미지 생성 진행률을 조회할 수 있습니다.
>
5. 미러 이미지가 생성된 후 왼쪽 사이드바에서[[미러 이미지](https://console.cloud.tencent.com/cvm/image)]를 클릭하면 관리 페이지로 들어갑니다.
6. 미러 이미지 목록에서 생성한 미러 이미지를 선택하고[인스턴스 생성]을 클릭하면 기존과 동일한 미러링된 서버를 구매할 수 있습니다. 아래 이미지를 참조하십시오.
![사용자 정의 이미지](https://main.qcloudimg.com/raw/31c3ec91fe0e42f7f32d1025e04c5671.png)

### API를 통해 생성

CreateImage 인터페이스를 사용하여 사용자 정의 이미지를 생성할 수 있습니다. 자세한 내용은 [API 미러 이미지 생성](https://cloud.tencent.com/document/api/213/16726)을 참조하십시오. 

## 모범 사례

### 데이터 디스크 데이터 마이그레이션

새 인스턴스를 시작하는 동시 기존 인스턴스 데이터 디스크의 데이터를 유지해야 할 경우 데이터 디스크에서 [스냅샷](https://cloud.tencent.com/document/product/362/5754)을 실행합니다. 새 인스턴스를 시작할 때 해당 데이터 디스크 스냅샷을 사용하여 새 CBS 데이터 디스크를 생성합니다. 
자세한 정보는 [스냅샷으로 CBS 생성](https://cloud.tencent.com/document/product/362/5757)을 참조하십시오.




