## Feature Description
- This API allows you to pull the profile fields of friends and non-friends.
- Pulling [standard profile fields](https://intl.cloud.tencent.com/document/product/1047/33520#.E6.A0.87.E9.85.8D.E8.B5.84.E6.96.99.E5.AD.97.E6.AE.B5) and [custom profile fields](https://intl.cloud.tencent.com/document/product/1047/33520#.E8.87.AA.E5.AE.9A.E4.B9.89.E8.B5.84.E6.96.99.E5.AD.97.E6.AE.B5) is supported.
- We recommend that you pull no more than 100 users at a time to avoid response packet failure due to excessive data volume.
- Ensure that all accounts in the request are imported into IM Console. If the request contains accounts that have not been imported into IM Console, an error appears in IM Console.

## API Invocation Description
### Request URL example
```
https://console.tim.qq.com/v4/profile/portrait_get?sdkappid=88888888&identifier=admin&usersig=xxx&random=99999999&contenttype=json
```
### Request parameters

The following table lists and describes only the parameters to be modified when this API is invoked. For details on other parameters, see [RESTful API Overview](https://intl.cloud.tencent.com/document/product/1047/34620).

| Parameter | Description |
| ------------------ | ------------------------------------ |
| v4/profile/portrait_get | Request API |
| sdkappid | SDKAppID assigned by the IM console when an app is created |
| identifier | This must be the app admin account. For details, see [App Admins](https://intl.cloud.tencent.com/document/product/1047/33517#app-.E7.AE.A1.E7.90.86.E5.91.98). |
| usersig | The signature generated by the app admin account. For details, see [Generating UserSig](https://intl.cloud.tencent.com/document/product/1047/34385). |
| random | Enter a random 32-bit unsigned integer ranging from 0 to 4294967295. |


### Maximum invocation frequency
The maximum invocation frequency is 200 times per second.

### Request packet examples
- **Reading a profile field of a user**
```
{
    "To_Account":["id1"],
    "TagList":
    [
        "Tag_Profile_IM_Nick"
    ]
}
```
- **Reading multiple profile fields of a user**
```
{
    "To_Account":["id1"],
    "TagList":
    [
        "Tag_Profile_IM_Nick",
        "Tag_Profile_IM_AllowType",
        "Tag_Profile_IM_SelfSignature",
        "Tag_Profile_Custom_Test"
    ]
}
```
- **Reading a profile field of multiple users**
```
{
    "To_Account":["id1","id2","id3"],
    "TagList":
    [
        "Tag_Profile_IM_Nick"
    ]
}
```
- **Reading multiple profile fields of multiple users**
```
{
    "To_Account":["id1","id2","id3","id4"],
    "TagList":
    [
        "Tag_Profile_IM_Nick",
        "Tag_Profile_IM_AllowType",
        "Tag_Profile_IM_SelfSignature",
        "Tag_Profile_Custom_Test"
    ]
}
```

### Request packet fields
| Field | Type | Attribute | Description |
|------|------|-----|-------|
| To_Account | Array | Required | The UserID for which profiles are to be pulled. <br />Note: pull no more than 100 users at a time to avoid response packet failure due to excessive data volume. |
| TagList | Array | Required | Tags of the profile fields to be pulled. Supported fields are: <br />1. Standard profile fields. For details, see [Standard Profile Fields](https://intl.cloud.tencent.com/document/product/1047/33520#.E6.A0.87.E9.85.8D.E8.B5.84.E6.96.99.E5.AD.97.E6.AE.B5).<br />2. Custom profile fields. For details, see [Customer Profile Fields](https://intl.cloud.tencent.com/document/product/1047/33520#.E8.87.AA.E5.AE.9A.E4.B9.89.E8.B5.84.E6.96.99.E5.AD.97.E6.AE.B5). |

### Response packet examples
- **Reading a profile field of a user**
```
{
    "UserProfileItem":
    [
        {
            "To_Account":"id1",
            "ProfileItem":
            [
                {
                    "Tag":"Tag_Profile_IM_Nick",
                    "Value":"NickNameTest1"
                }
            ],
            "ResultCode":0,
            "ResultInfo":""
        }
    ],
    "ActionStatus":"OK",
    "ErrorCode":0,
    "ErrorInfo":"",
    "ErrorDisplay":""
}
```
- **Reading multiple profile fields of a user**
```
{
    "UserProfileItem":
    [
        {
            "To_Account":"id1",
            "ProfileItem":
            [
                {
                    "Tag":"Tag_Profile_IM_Nick",
                    "Value":"NickNameTest1"
                },
                {
                    "Tag":"Tag_Profile_IM_AllowType",
                    "Value":"AllowType_Type_NeedConfirm"
                },
                {
                    "Tag":"Tag_Profile_IM_SelfSignature",
                    "Value":"I'm Test1"
                },
                {
                    "Tag":"Tag_Profile_Custom_Test",
                    "Value":"Custom Data1"
                }
            ],
            "ResultCode":0,
            "ResultInfo":""
        }
    ],
    "ActionStatus":"OK",
    "ErrorCode":0,
    "ErrorInfo":"",
    "ErrorDisplay":""
}
```
- **Reading a profile field of multiple users**
```
{
    "UserProfileItem":
    [
        {
            "To_Account":"id1",
            "ProfileItem":
            [
                {
                    "Tag":"Tag_Profile_IM_Nick",
                    "Value":"NickNameTest1"
                }
            ],
            "ResultCode":0,
            "ResultInfo":""
        },
        {
            "To_Account":"id2",
            "ProfileItem":
            [
                {
                    "Tag":"Tag_Profile_IM_Nick",
                    "Value":"NickNameTest2"
                }
            ],
            "ResultCode":0,
            "ResultInfo":""
        },
        {
            "To_Account":"id3",
            "ProfileItem":
            [
                {
                    "Tag":"Tag_Profile_IM_Nick",
                    "Value":"NickNameTest3"
                }
            ],
            "ResultCode":0,
            "ResultInfo":""
        }
    ],
    "ActionStatus":"OK",
    "ErrorCode":0,
    "ErrorInfo":"",
    "ErrorDisplay":""
}
```
- **Reading multiple profile fields of multiple users**
```
{
    "UserProfileItem":
    [
        {
            "To_Account":"id1",
            "ProfileItem":
            [
                {
                    "Tag":"Tag_Profile_IM_Nick",
                    "Value":"NickNameTest1"
                },
                {
                    "Tag":"Tag_Profile_IM_AllowType",
                    "Value":"AllowType_Type_NeedConfirm"
                },
                {
                    "Tag":"Tag_Profile_IM_SelfSignature",
                    "Value":"I'm Test1"
                },
                {
                    "Tag":"Tag_Profile_Custom_Test",
                    "Value":"Custom Data1"
                }
            ],
            "ResultCode":0,
            "ResultInfo":""
        },
        {
            "To_Account":"id2",
            "ProfileItem":
            [
                {
                    "Tag":"Tag_Profile_IM_Nick",
                    "Value":"NickNameTest2"
                },
                {
                    "Tag":"Tag_Profile_IM_AllowType",
                    "Value":"AllowType_Type_DenyAny"
                },
                {
                    "Tag":"Tag_Profile_IM_SelfSignature",
                    "Value":"I'm Test2"
                },
                {
                    "Tag":"Tag_Profile_Custom_Test",
                    "Value":"Custom Data2"
                }
            ],
            "ResultCode":0,
            "ResultInfo":""
        },
        {
            "To_Account":"id3",
            "ProfileItem":
            [
                {
                    "Tag":"Tag_Profile_IM_Nick",
                    "Value":"NickNameTest3"
                },
                {
                    "Tag":"Tag_Profile_IM_AllowType",
                    "Value":"AllowType_Type_AllowAny"
                },
                {
                    "Tag":"Tag_Profile_IM_SelfSignature",
                    "Value":"I'm Test3"
                },
                {
                    "Tag":"Tag_Profile_Custom_Test",
                    "Value":"Custom Data3"
                }
            ],
            "ResultCode":0,
            "ResultInfo":""
        },
        {
            "To_Account":"id4",
            "ResultCode":40006,
            "ResultInfo":"Err_Profile_PortraitGet_Read_Custom_Data_Fail"
        }
    ],
    "Fail_Account":["id4"],
    "ActionStatus":"OK",
    "ErrorCode":0,
    "ErrorInfo":"",
    "ErrorDisplay":""
}
```

### Response packet fields

| Field | Type | Description |
|--- |--- |--- |
| UserProfileItem | Array | The structured information of returned user profiles. |
| To_Account | String | Returned user UserID. |
| ProfileItem | Array | The array of returned user profile objects. Each object in the array includes a Tag field and a Value field. |
| Tag | String | The name of the returned profile object: <br>1. Standard profile fields. For details, see [Standard Profile Fields](https://intl.cloud.tencent.com/document/product/1047/33520#.E6.A0.87.E9.85.8D.E8.B5.84.E6.96.99.E5.AD.97.E6.AE.B5).<br>2. Custom profile fields. For details, see [Custom Profile Fields](https://intl.cloud.tencent.com/document/product/1047/33520#.E8.87.AA.E5.AE.9A.E4.B9.89.E8.B5.84.E6.96.99.E5.AD.97.E6.AE.B5). |
| Value | uint64_t/string/bytes | The value of the pulled profile object. For details, see [Profile Fields](https://intl.cloud.tencent.com/document/product/1047/33520#.E8.B5.84.E6.96.99.E5.AD.97.E6.AE.B5). |
| ResultCode | Integer | The processing result of To_Account. 0: succeeded. Others: failed. |
| ResultInfo | String | The error description for To_Account. This field is empty if the processing was successful. |
| Fail_Account | Array | The list of users for whom the processing failed. This field is returned only when the processing fails for a user. |
| ActionStatus | String | The request processing result. OK: succeeded. FAIL: failed. |
| ErrorCode | Integer | The error code. 0: succeeded. Others: failed. |
| ErrorInfo | String | The detailed error information. |
| ErrorDisplay | String | The detailed error information to be displayed on the client. |

## Error Codes

Unless a network error (such as error 502) occurs, the HTTP return code for this API is always 200. ErrorCode and ErrorInfo in the response packet represent the actual error code and error information, respectively.
For common error codes (60000 to 79999), see [Error Codes](https://intl.cloud.tencent.com/document/product/1047/34348).
The following table describes the error codes specific to this API.

| Error Code | Description |
|---------|---------|
| 40001 | A request parameter is incorrect. In this case, check request parameters based on the error description. |
| 40002 | An request parameter is incorrect. Specifically, To_Account is not specified. |
| 40003 | The requested user account does not exist. |
| 40004 | The request requires app admin permissions. |
| 40006 | An internal server error occurred. In this case, try again later. |
| 40007 | No permission to read profile fields. For details, see [Profile Fields](https://intl.cloud.tencent.com/document/product/1047/33520#.E8.B5.84.E6.96.99.E5.AD.97.E6.AE.B5). |
| 40009 | The tag of a profile field does not exist. |

## API Commissioning Tool
Use the [RESTful online commissioning tool for APIs](https://avc.qcloud.com/im/APITester/APITester.html#v4/im_open_login_svc/multiaccount_import) to commission this API.
## References
Setting a profile ([v4/profile/portrait_set](https://intl.cloud.tencent.com/document/product/1047/34916))
