## 制限事項

### データ量の制限について
リソースの有限性のため、MySQLはユーザー間の性能影響を隔離するために、さまざまな MySQL インスタンスタイプに対して、データ量の制限を設定しています。以下では、大量のデータにおける単一インスタンスおよび単一テーブルの使用へのMySQLの影響を技術の観点から説明します。

**大量データのテーブル**：単一テーブルのデータ量が指定数量以上となった場合、MySQLが単一テーブルのリソースの管理コスト（データ、インデックスなど）を変更するため、テーブルの処理効率に直接影響を与えます。例えば、1つのサービステーブル（InnoDB）のデータ量が5GBに達した場合、更新操作のディレーが著しく大きくなり、サービスの応答時間に直接影響を与えます。この場合は、テーブル分割して移行することで解決する必要があります。

**大量データのインスタンス**：クラウドデータベースのデフォルトのストレージエンジンは InnoDBです。インスタンスにおけるデータとインデックスページがInnoDBのcache、bufferにキャッシュされている場合、MySQLインスタンスでは、大量の同時アクセスがサポートされています。インスタンスのデータ量が大きすぎる場合、cache bufferが頻繁にデータを交換し、MySQLのボトルネックがIOに移行し、アクセスのスループットが大幅に低下します（例えば、あるクラウドデータベースのインスタンスは本来、1秒あたり8000回のアクセス回数が可能だが、データ量がcache、 bufferサイズの2倍になった場合、1秒あたりのアクセス回数が700回となった）。

>単一インスタンスのテーブル数が100万を超えた場合は、バックアップ、監視、アップグレードに失敗する恐れがあり、データベースへの監視にも影響を与えます。そのために、単一インスタンスのテーブル数が100万を超えないようにテーブルの数を適切に管理してください。

### 接続数の制限について
MySQLの接続数の上限は、 MySQLのシステム変数max_connectionsです。MySQLインスタンスの接続数がmax_connectionsを超えると、新規接続が確立できません。
クラウドデータベースの最大デフォルト値が3000、他の値が800です。ユーザーは必要に応じて max_connections の値を調整することができます。但し、接続数が多ければ多いほどシステムリソースの使用量が多くなります。接続数が実際システムの負荷許容範囲を超えると、システムのサービス品質に影響を与えます。
max_connectionsについて、 [MySQL公式ドキュメント](https://dev.mysql.com/doc/)をご参照ください。

## クラウドデータベースのMySQLクライアントに接続する際のバージョン制限
クラウドデータベースのインスタンスを接続する際に、 CVMシステムに組み込まれているMySQLクライアントとlibライブラリーを使用することをお勧めします。

### スローログについて
-  Linux CVMを使用する開発者は、クラウドデータベースのエクスポートツールを使ってスロークエリーログを取得することができます。 [バックアップファイルとログのダウンロード](https://intl.cloud.tencent.com/document/product/236/7274)をご参照ください。
-  Windows CVMを使用する開発者は現在、スロークエリーログを直接に取得することができません。必要な場合、[作業依頼書を提出](https://console.cloud.tencent.com/workorder/category) して、こちらにスロークエリーログファイルの取得を依頼してください。

### クラウドデータベースのbinlog保存期間について
 MySQLのbinlogログファイルの保持期間を7〜732日の範囲で設定できます。デフォルト値は7日です。（自動バックアップ設定では日数を設定可能です。）但し、ログバックアップ保持日数の値はデータバックアップ保持日数の値以下である必要があります。 
binlog長時間保存されているか、或いは急増している場合、バックアップスペースが大きくなります。バックアップスペースがシステムのフリークォータを超えた場合、料金が発生します。（現在、フリークォータを超えているバックアップスペースに対して課金していません、課金時期と課金方法について、別途通知いたします。） 


### 文字セットについて

クラウドデータベースはMySQLデータベースと同様に、デフォルトで文字セットエンコードの形式がlatin1、すなわち、 ISO-8859-1エンコード形式になっています。
クラウドデータベースはデフォルトの文字セットエンコードの設定をサポートしますが、テーブルを作成するとき、テーブルのエンコードを明示的に指定し、接続の確立時に接続のエンコーディングを指定することをお勧めします。そうすることで、アプリケーションに移植性が向上します。
MySQL文字セットに関連するリソースについては、MySQL公式マニュアルをご参照ください。

以下では、クラウドデータベースの文字セット変更方法について説明します。
1. 下記の文を実行すると、クラウドデータベースインスタンスのデフォルトの文字セットエンコードを変更することができます。
```
SET @@global.character_set_client = utf8;
SET @@global.character_set_results = utf8;
SET @@global.character_set_connection = utf8;
SET @@global.character_set_server = utf8;
```
この場合、@@global.character_set_server は10分ぐらい自動的にローカルファイルに同期し、永続化（他の3つの変数はローカルファイルに同期しない）されます。移行或いは再起動を実行することで設定後の値を保持します。
2. 下記の文を実行すると、現在接続されている文字セットエンコードを変更することができます。
```
SET @@session.character_set_client = utf8;
SET @@session.character_set_results = utf8;
SET @@session.character_set_connection = utf8;
```
或いは
```
SET names utf8;
```
3. PHPプログラムに対して、下記の関数を使って、現在接続されている文字セットエンコードを設定することができます。
```
bool mysqli::set_charset(string charset);
```
或いは
```
bool mysqli_set_charset(mysqli link, string charset);
```
4.  Javaプログラムに対して、下記の方法を使って現在接続されている文字セットエンコードを設定することができます。
```
jdbc:mysql://localhost:3306/dbname?useUnicode=true&characterEncoding=UTF-8
```

### 操作の制限について
1. MySQLインスタンスの既存アカウントの情報と権限を変更しないでください。変更すると、一部のクラスターサービスが無効になる場合があります。
2. データベースとテーブルを作成する際に、InnoDBエンジンを使用することをお勧めします。それにより、インスタンスは、高度なアクセス機能を通じてより優れたパフォーマンスを実現することができます。
3.  master-slave関係を変更・停止しないでください。変更すると、ホットバックアップが無効になる場合があります。

### データベーステーブル名の制限について
中国語のテーブル名がサポートされていないため、テーブルを作成する際にご注意ください。中国語のテーブル名を作成すると、ロールバック、アップグレードなどの処理に失敗する可能性があります。

## 注意事項
### データベースアカウント権限
MySQLは、ユーザーにインスタンスsuper user権限を提供しなくなりました。super user権限がないと変更できないパラメータについては、コンソールのパラメータ設定機能と作業依頼書サブミットの2種類の方法で変更することができますが、 一部のパラメータが変更できません。

### データベースエンジン
性能及びセキュリティーを確保するために、なるべくInnoDBストレージエンジンを使用することをお勧めします。MySQL 5.6以降のバージョンはMyISAMエンジンをサポートしません。

### ネットワークの選択
- Virtual Private Cloudと基幹ネットワークの比較については、 [Virtual Private Cloudについて](/doc/product/215#2.-.E7.A7.81.E6.9C.89.E7.BD.91.E7.BB.9C.E4.B8.8E.E5.9F.BA.E7.A1.80.E7.BD.91.E7.BB.9C)をご参照ください。
- Virtual Private Cloudと基幹ネットワークは相互通信できない、それぞれのネットワークにおけるインスタンスにのみアクセスできます。
