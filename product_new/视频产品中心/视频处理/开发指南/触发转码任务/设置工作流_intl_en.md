Complete the following steps to set a workflow:
- Set both trigger and output bucket and path
- Select the task items. Selections include transcoding, screenshot, animated image generating, and more.
- Set the CMQ address for event notification.

Created templates are used in task configuration. You can go to [MPS Console > Template Settings](https://console.cloud.tencent.com/mps/templates) for a complete list of parameter templates. For more information on how to create a custom parameter template, please see [Parameter Templates](https://intl.cloud.tencent.com/document/product/1041/33494).

## Creating a Workflow

### <span id ="p1">- Set both trigger and output bucket and path

- Trigger bucket: the bucket where a source file is stored. Select a region and select the bucket located in the region.
- Trigger bucket directory: the directory that will trigger transcoding. The default value is the root directory, i.e., transcoding will be triggered for files in all directories in the bucket. **If this parameter is set, transcoding tasks will be initiated only for files in the specified directory.**
- Output bucket: the bucket where the output file will be stored. **Output buckets must be in the same region as the trigger bucket.**
- Output directory: the directory where the output file will be stored. The output path is the same as the source path by default. In this case, you need to ensure that the output file has a name different from that of the source file; otherwise, the source file will be overwritten. If this parameter is set, output files will be stored in the specified directory.
  
  > If you set the output path in each task's configuration separately, the path settings in the task configuration will prevail.

### Configuring event notification
MPS uses the queue model in CMQ as the event notification model. This is a messaging model where messages are written to one end and read from the other end. The writer is the producer, and the reader is the consumer.
In this model, each message can only be consumed once. In the simplest case, there are only one producer and one consumer. In complex cases, there can be multiple producers and multiple consumers, and each consumer will receive an equal portion of all messages.
> Only COS v4 regions are supported, i.e., Shanghai (`sh`), Guangzhou (`gz`), Chengdu (`cd`), Chongqing (`cq`), and Beijing (`bj`).

For more information on CMQ, please see [CMQ Overview](https://intl.cloud.tencent.com/document/product/406/4541).

### Configuring a transcoding task
Transcoding task configuration includes configuring tasks such as video transcoding, audio transcoding, and watermarks. You simply need to select the corresponding transcoding template.

**Output path settings**

| Path Type | Description | Configuration Example | Output Example |
| --- | --- | --- | ---- |
| Root directory | Ignores [the set "output path"](#p1) | Output directory: <br>`/output/` <br> Output path: <br>`/transcode/{inputName}_{definition}.{format}`  |  Output file: <br>`/transcode/testvideo_20.mp4` |
| Relative directory | Utilizes [the set "output path"](#p1) as the directory prefix | Output directory: <br>`/output/` <br> Output path: <br>`transcode/{inputName}_{definition}.{format}` | Output file: <br>`/output/transcode/testvideo_20.mp4` |

### Configuring a screenshot task
Screenshot task configuration includes configuring tasks such as sampled screenshot, time point screenshot, and generating image sprite.
- Sampled screenshot: The system captures screenshots at a regular interval, which can be a fixed time or percent value, e.g., 1s or 1%.
- Time point screenshot: The system captures screenshots at specified time points, e.g., taking screenshots at 00:00:00, 00:05:00, and 00:15:30, respectively (three screenshots in total).
- Generating image sprite: The system combines multiple screenshots into a larger image. You can set the width and height of each screenshot.

### Configuring an animated image generating task
Animated images are generated by taking screenshots of a video and combining them into an animated image in GIF or WEBP format. You can set the start and end time points for screencapturing.
