Content Delivery NetworkサービスはTencent CloudのCloud Access Managementシステムを導入しています。 [アクセス管理](https://console.cloud.tencent.com/cam/overview) コンソールでユーザーグループ、ユーザー、ロール、ポリシー等の一連の関連管理操作を行うことができます。

現在、CDNサービスは権限システムのアップグレードの過渡期にあるため、ユーザーは下記のような幾つかの方式でサブユーザーとロールに対しCDN管理権限をアサインできます。

## デフォルトポリシー
現在、CDNサービスに対応できるデフォルトポリシーは下記の通りです。
- AdministratorAccess：当該ポリシーに関連付けられたサブユーザーは、アカウントにおけるすべてのクラウドサービス資産（CDNサービスを含む）、財務関連情報、ユーザー及び権限を管理することができます。
- QCloudResourceFullAccess：当該ポリシーに関連付けられたサブユーザーは、アカウントにおけるすべてのクラウドサービス資産（CDNサービスを含む）を管理することができます。



##  プロジェクト権限
### プロジェクト管理認可
CDNサービスはプロジェクトごとに権限を割り当てることをサポートします（つまり、プロジェクト管理者を設定します）。[プロジェクト管理]ポリシーを作成してプロジェクトを割り当てることにより、サブユーザーはプロジェクトにおけるすべてのCDNリソースの管理権限を持つことができます。
作成の手順は次のとおりです：

1. 【製品の機能又はプロジェクト権限に基づき作成する】をクリックします。
2. ポリシーに名前を付けます、サービスタイプで【プロジェクト管理】をクリックします。
3. 【CDNサービスプロジェクトにおけるクラウドリソースを管理する】をオンにします。
4. 指定したプロジェクトに関連付けられています。

上記のポリシーが作成され、サブユーザーに関連付けられた後、関連付けられたサブユーザーは、このプロジェクトのすべてのクラウドリソース（CDNサービスを含む）を操作することができます。


## 機能-プロジェクト認証

CDNサービスは、事前設定された機能セットに従ってプロジェクトレベルの認可操作を行うことをサポートします。[Content Delivery Network]サービスポリシーを作成することにより、サブユーザーは当該プロジェクトの指定された機能に対する権限を持つことができます。作成の手順は次のとおりです。

1. 【製品の機能又はプロジェクト権限ごとに承認する】をクリックします。
2. ポリシーに名前を付けます、サービスタイプで【Content Delivery Network】をクリックします。
3. 【消費データと統計量の確認】などの必要な機能セットをオンにします。
4. 指定したプロジェクトに関連付けられています。

上記のポリシーが作成され、サブユーザーに関連付けられた後、関連付けられたサブユーザーは、次のインターフェイスを介してプロジェクト内のリソース（ドメイン名）に対応する統計データを照会することができます。


### API に関する注意事項

現在、CDNサービスが外部に提供しているインタフェースの大部分はAPI3.0インタフェースであり、プロジェクトレベルのリソース認証を実行するサブユーザーは、関連する操作のために以下のAPIインターフェースのみを呼び出すことができます。リストに載っていないAPIインターフェイスは、現時点では子ユーザーの呼び出しをサポートしていません。



| 権限セット             | API3.0                                                       | 授権する必要があるか |
| :-------------------- | :----------------------------------------------------------- | :----------- |
| 消費データ及び統計量をクエリーする  | DescribeCdnData DescribeOriginData ListTopData DescribeIpVisit | はい           |
| ドメイン名情報をクエリーする         | オンラインしていない                                                     | はい          |
| CDN ログのダウンロードリンクをクエリーする | オンラインしていない                                                        | はい          |
| ドメイン名を追加する         | オンラインしていない                                                       | はい           |
| ドメイン名のオンライン / オフライン          | オンラインしていない                                                     | はい          |
| ドメイン名を削除する           | オンラインしていない                                                    | はい         |
| ドメイン名の設定を変更する            | オンラインしていない                                                    | はい          |
| 更新予熱             | オンラインしていない                                              | はい          |
| サービスクエリー           | オンラインしていない                                                    |　いいえ   　 |


### コンソールに関する注意事項

- 消費データ及び統計量を確認する：ポリシーで【消費データ及び統計量を確認する】をオンにし、プロジェクトに関連付けられた後に、コンソールの下記モジュール情報を確認することができます：

  - 概要ページ
  - 統計分析：リアルタイム監視
  - 統計分析：データ分析
  - ネットワーク全体のデータ監視

- ドメイン名情報をクエリーする：ポリシーで【ドメイン名情報をクエリーする】をオンにし、プロジェクトに関連付けられた後に、コンソールの【ドメイン名管理】ページで権限を持つプロジェクトのドメイン名リスト及び詳しい設定情報を照会することができます。


- CDNログのダウンロードリンクをクエリーする：ポリシーで【CDNログのダウンロードリンクをクエリーする】をオンにし、プロジェクトに関連付けられた後に、コンソールの【ログ管理】ページで、アクセスログのダウンロードリンクを照会することができます。

- ドメイン名を追加する：ポリシーでは【ドメイン名を追加する】をオンにし、プロジェクトに関連付けられた後に、指定したプロジェクトにドメイン名を追加できます。



- ドメイン名のオンライン / オフライン ：ポリシーで【ドメイン名のオンライン / オフライン】をオンにし、プロジェクトに関連付けられた後に、指定したプロジェクトの加速ドメイン名をオンライン / オフラインできます。

- ドメイン名を削除する：ポリシーで【ドメイン名を削除する】をオンにし、プロジェクトに関連付けられた後に、指定したプロジェクトの加速ドメイン名を削除することができます。ドメイン名の削除はオフライン状態にある必要があります。そのため、オンライン状態にあるドメイン名を削除するには、【ドメイン名のオンライン / オフライン】権限を有する必要があります。
 

- ドメイン名の設定を変更する：ポリシーでは【ドメイン名の設定を変更する】をオンにし、プロジェクトに関連付けられた後に、指定されたプロジェクトの加速ドメイン名の設定を変更することができます。
 > ご注意：
  
  > コンソールの【証明書管理】ページで、対応するHTTPS設定を変更できますが、API 2.0インターフェースは現在サポートされていません。


- 更新予熱：ポリシーで【更新予熱】をオンにし、プロジェクトに関連付けられた後に、【更新キャッシュ】ページで対応する更新、予熱（ホワイトリスト）タスクをサブミットし、更新予熱タスクの実行状態を確認することができます。



## ドメイン名権限

ユーザーがドンメイン名のクエリーや管理権限をより細かく設定できるように、CDNシステムは権限ポリシーのアップグレードを行っています。これからポリシー文法能力を対応するようになると、ユーザーがポリシーセンテンスをカスタマイズすることにより、ドンメイン名レベルの権限アサインを実現することが可能となります。

現在、新規追加したAPI3.0インターフェース及び新しいバージョンの統計分析コンソールは、既にポリシー文法を全面的に対応しています。対応するActionは下記の通りです。

- DescribeCdnData
- DescribeOriginData
- ListTopData
- DescribeIpVisit


### ポリシーの構文

        ポリシー構文を使用してドメイン名の権限を付与する場合場合、構文は次のとおりです。
- 

```
{
    "version": "2.0",
    "statement": [
        {
            "action": [
                "*"
            ],
            "resource": [
                "qcs::cdn::uin/987654321:domain/www.test.com"
            ],
            "effect": "allow"
        }
    ]
}
```
**構文の説明

- action：認証が必要なActionを示します、DescribeCdnData、DescribeOriginData、ListTopData、DescribeIpVisitの4つのAction認証のみをサポートします。詳細については、[ドメイン名権限](https://intl.cloud.tencent.com/document/product/228/12722#ymqx)をご参照ください。

- resource：認証が必要なオブジェクトを示します、CDNサービスの場合、ドメインレベルの認証のみがサポートされています。フォーマットは例に示すとおりである必要があります。

- effect： denyを設定した場合、リソースにアクションを呼び出すことは禁止されています。

- statement ：複数の設定が許可されており、ドメイン名にdeny とallowの設定が重複している場合、denyが優先されます。

> ご注意：
>
> - ポリシー構文は上記記載のDescribeCdnData、DescribeOriginData、ListTopData、DescribeIpVisitの4つの認証しか対応していない、詳細については、[ドメイン名権限](https://intl.cloud.tencent.com/document/product/228/12722#ymqx)をご参照ください。`*`として設定されている場合、これらのアクションが許可されていることを意味します。
>


> 

- プロジェクトに基づく授権、ポリシー構文に基づくドメイン名レベル授権を同時に行うことが可能です。プロジェクトAのデータアクセス権限を授権したが、ポリシー構文によりプロジェクトAにおけるaドメイン名のデータクエリー権限を拒否した場合は、プロジェクトAの権限を持っていないが、プロジェクトAにおけるほかのドメイン名の権限を持っています。
