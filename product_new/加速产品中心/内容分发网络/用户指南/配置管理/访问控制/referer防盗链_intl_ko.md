비즈니스 자원에 대한 액세스 소스를 제어하려는 경우, CDN은 referer 링크 도용 방지 구성 기능을 제공합니다. 사용자의 HTTP Request Header에서 참조 필드의 값에 대한 액세스 제어 정책을 설정하면 액세스 소스가 제한되고 악의적으로 도용할 수 없습니다.
## 구성 안내

1. [CDN 콘솔](https://console.cloud.tencent.com/cdn)에 로그인하여 왼쪽 디렉터리 [도메인 관리]를 클릭합니다. 관리 페이지로 이동하여 목록에서 편집해야 하는 도메인 이름을 찾아 작업표시줄에서 [관리]를 클릭하십시오.
2. [액세스 제어] 탭을 클릭하여 링크 도용 방지 구성 모듈에서 구성하십시오. 기본적으로 링크 도용 방지는 활성화되어 있지 않으며 블랙리스트/화이트리스트가 없습니다.
referer 블랙리스트, 화이트리스트 호환되지 않으며 한 번에 하나의 유혀만 유효합니다. 최대 400개 입력 가능하며, 개행으로 구분하며 한 줄에 1개만 입력합니다.
>- 링크 도용 방지은 도메인 이름/IP 규칙을 지원합니다. 구성 방법은 접두사 구성법입니다(경로만 지원되는 경우 도메인 이름의 접두사 일치가 지원되지 않음). 즉, 구성 목록이 'www.abc.com'인 경우, `www.abc.com/123` 은 구성되지만, `www.abc.com.cn`은 구성되지 않습니다. 구성 목록이 127.0.0.1이라고 가정하면, 127.0.0.11/123도 구성됩니다.
> - 링크 도용 방지는 와일드카드 구성을 지원합니다. 즉, 목록이 `* .qq.com` 인 것으로 가정하면, `www.qq.com`과 `a.qq.com`이 모두 구성됩니다.

### referer 화이트리스트
1. **링크 도용 방지 **를 클릭하여 활성화하고 [referer 화이트리스트]를 선택하여 referer 화이트리스트를 구성하십시오.
   사용자가 도메인 `www.test.com`에 referer 화이트리스트로 구성했다면, 화이트리스트 내용은 다음과 같습니다. `www.abc.com` 및 **선택하지 않음**“빈 referer포함”,사용자가 referer  값을 `www.abc.com`의 요청 액세스만 허용하고 다른 모든 요청은 403을 리턴합니다.
>- 요청된 referer 필드가 화이트리스트 설정의 내용과 일치하면 CDN 노드는 일반적으로 요청 정보를 리턴합니다.
>- 요청된 referer 필드가 화이트리스트 설정의 내용과 일치하지 않으면 CDN 노드는 요청 정보를 반환하지 않고, 상태 코드 403을 직접 리턴합니다.
>- 화이트리스트를 설정할 때, CDN 노드는 화이트리스트의 문자열 내용과 일치하는 요청만 반환할 수 있습니다.
>- **선택** "빈 referer 포함" 옵션을 확인할 때, referer 필드가 비어 있거나 referer 필드가 없는 경우(예: 브라우저 요청) , CDN은 요청 정보를 정상적으로 리턴합니다.
2. 구성이 완료되면 스위치가 활성화되고 유효한 referer 화이트리스트 구성 정보가 하단에 표시됩니다. [편집]을 클릭하여 구성 정보를 변경할 수 있습니다.
3. **링크 도용 방지** 스위치가 꺼져 있으면, 아래 구성 정보가 유효하지 않아 링크 도용 방지가 활성화되지 않습니다. 수동으로 다시 켤 수 있습니다.

### referer 블랙리스트
1. **링크 도용 방지**를 클릭하여 활성화하고 [referer 블랙리스트]를 선택하여 referer 블랙리스트를  구성하십시오.
   사용자가 도메인 'www.abc.com'에 referer 블랙리스트로 구성했다면, 블랙리스트 내용은 다음과 같습니다: `www.test.com` 및 ** 선택하지 않음 ** "빈 referer 포함", referer값은 `www .test.com`에 대한 요청은 403을 반환하고, 다른 요청은 일반 콘텐츠를 리턴합니다.
>- 요청된 referer 필드가 블랙리스트에 설정된 콘텐츠와 일치하면, CDN 노드는 요청 정보 반환을 거부하고 403 상태 코드를 직접 리턴합니다.
>- 요청된 referer가 블랙리스트에 설정된 내용과 일치하지 않으면, CDN 노드는 요청 정보를 정상적으로 리턴합니다.
>- "빈 referer 포함"옵션을 선택하면, referer 필드가 비어 있거나 referer 필드가 없는 경우(예: 브라우저 요청), CDN 노드는 요청 메시지 반환을 거부하고 403 상태 코드를 리턴합니다.
2. 구성이 완료되면 스위치가 활성화되고 유효한 referer 블랙리스트 구성 정보가 하단에 표시됩니다. [편집]을 클릭하여 구성 정보를 변경할 수 있습니다.
3. **링크 도용 방지** 스위치가 꺼져 있으면, 아래 구성 정보가 유효하지 않아 링크 도용 방지가 활성화되지 않습니다. 수동으로 다시 켤 수 있습니다.


## 구성 사례
도메인 이름 referer가 다음과 같이 구성된 경우
- 사용자는 URL을 'http://www.test.com/1.jpg?version=1.1'의 리소스로 요청하고, 브라우저 액세스를 통해 referer를 비우기를 요청하면, 다시 원래 콘텐츠로 돌아갑니다.
- 사용자는 URL을 'http://www.test.com/1.jpg?version=1.1'의 리소스로 요청하고, referer를 `www.abcd.com`로 요청하면, 화이트리스트에 없을 경우, 직접 403을 리턴합니다.

