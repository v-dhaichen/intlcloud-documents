CDN provides a fault self-diagnosis tool to help you troubleshoot URL access failure. The fault self-diagnosis process includes detection of DNS resolution, linkage quality, node status, origin server, and data access consistency, enabling you to identify problems and offering relevant solutions.

>! The resource URL to be diagnosed should be an **activated** domain name under your account. The bandwidth incurred in the diagnosis process is billable bandwidth. It is recommended that the diagnosed resource should be no more than 200 MBytes in size.



## Fault Diagnosis
### Diagnosis Process

If a resource URL cannot be accessed, you can initiate diagnosis through **Fault Self-diagnosis** in the following steps:
1. Log in to the [CDN Console](https://console.cloud.tencent.com/cdn) and click **Diagnosis Tool** > **Fault Self-diagnosis**.
2. On the "Fault Self-diagnosis" page, enter the exceptional URL to be diagnosed, which should begin with ```http://``` or `https://`.
 ![](https://main.qcloudimg.com/raw/85de28335bf2fe801e42526eefca43c2/diagnose1.png)
3. Click **Generate a Diagnosis Link** and the link address will appear on the page.
 ![](https://main.qcloudimg.com/raw/1069bfb78be59fe452e412206e91b39b/diagnose2.png)
4. Click the link to open the diagnosis page where diagnosis information will be collected. Do not close the page in the diagnosis progress. You can manually close it after the diagnosis is completed.
    ![](https://main.qcloudimg.com/raw/c18f789338712abb37dd63495993c7b8.png)
5. You can also send the diagnosis link to others for local fault diagnosis. After the diagnosis is completed, you need to close the webpage manually.

>
- The diagnosis link is valid for 24 hours and supports up to 10 clicks for fault diagnosis.
- You can copy the available diagnosis links on the "Diagnosis report" page.

## Diagnosis Report
### Viewing a Report
1. After the diagnosis is completed, click **Diagnosis Report** to view the reports, which are displayed in a table in chronological order. The contents in the table include:
 - The URL for which a diagnosis link is generated.
 - The diagnosis link corresponding to the URL.
 - Time when the diagnosis link was generated.
 - Expiration time of the diagnosis link.
 - Number of remaining available diagnoses of the diagnosis link.
![](https://main.qcloudimg.com/raw/3118676991d4e8a805985df957db5530/diagnose3.png)

2. Click **Expand** in the operation column to view the report generated by each diagnosis and the diagnosis results.
![](https://main.qcloudimg.com/raw/b19edb9de8b792a3a3ba8b30ca50ef93/diagnose4.png)

3. The diagnosis reports will make overall assessment based on the diagnosis in each step, as shown below:
 - Normal.
 - Exceptional.
 -Diagnosis page is closed abnormally (mostly because the page is closed before diagnosis is completed).
4. Click **View Report** on the right to view diagnosis details and suggestions.

### Report Interpretation
1. The first part of the report displays diagnosis information, including:
 - Diagnosis report ID.
 - URL to be diagnosed.
 - Time when diagnosis was triggered.
![](https://main.qcloudimg.com/raw/1e1117ffc01e57ac8f481ab5e2c4c626/diagnose5.png)

2. The second part gives an overview of the diagnosis process and the results of each diagnosis module, where you can see clearly which module is exceptional. Diagnosis modules include:
 - Client information detection result.
 - DNS detection result.
 - CNAME detection result.
 - Network linkage detection result.
 - Access node detection result.
 - Origin-pull node detection result.
 - Origin server detection result.
![](https://main.qcloudimg.com/raw/cbe32c5c202ce902316f32ffc9b16fdb/diagnose6.png)

3. The third part elaborates on the diagnosis results.
 #### Section 1. Client Information
Information such as client IP, district/ISP, and User-Agent, Referer, and Request Mode of the initiated HTTP/HTTPS request. Without client information, some subsequent detections cannot be conducted.
![](https://main.qcloudimg.com/raw/ae317826bef6070dd6da62a7c0b0735d/diagnose7.png)

 #### Section 2. DNS Detection
The client's DNS IP is collected and checked against the client IP, to determine whether any exceptions in local DNS configuration have made it unable to schedule the requests to the optimal cache nodes.
![](https://main.qcloudimg.com/raw/ebfe238ab7cc50bcc04af9fb2c695f41/diagnose8.png)

 #### Section 3. CNAME Detection
The CNAME configuration of the domain name is obtained. The CNAME resolution of the domain name needs to be configured with the correct domain name suffixed with *.cdn.dnsv1.com (default); otherwise, requests will be unable to reach CDN nodes.
![](https://main.qcloudimg.com/raw/7e2be6762595049b2073a042e3748672/fb71f6db1c7c48214b4275c55d81b539.png)
>! If CNAME configuration detection fails, the requests will not reach CDN nodes and subsequent diagnoses will not be conducted.

 #### Section 4. Network Linkage Detection
Multiple websites are checked locally to obtain the client's network status. If a website cannot be accessed due to local proxy configuration, the network linkage detection will fail, and subsequent diagnoses will not be conducted.
![](https://main.qcloudimg.com/raw/49e938c70f66e86ae692860f7f0619d7.png)

 #### Section 5. Access Node Detection
After a client request reaches a CDN node, node information will be collected, including node IP, node district/ISP, status code returned by node, hit status, and resource MD5.
 - If a resource has already been cached on a CDN node, it will directly be hit, and origin-pull node detection will not be conducted.
 - In case of a cache miss, origin-pull node detection will ensue.
 - If the status code returned by the URL is 301, 302, or 504, node detection information will be not be obtained, and the subsequent detection will not be conducted.
 - If an ACL has been configured for the domain name, the access node will directly return 403, and the hit status is **hit**.
![](https://main.qcloudimg.com/raw/a4296e85ad8d27350425352f34ea6c7e/diagnose9.png)

 #### Section 6. Origin-pull Node Detection
 1. If the resource is directly returned by a CDN node, the hit status of both the access node and the origin-pull node is **hit**, and CDN will proceed to detect the origin server to help check whether the status codes and contents returned from the origin server are the same as those of the node.
![](https://main.qcloudimg.com/raw/fed165f59474d52b25b6eedaef173406/diagnose10.png)
 2. If the resource is not directly returned by a CDN node, the hit status of both the access node and the origin-pull node is **missed**, and the contents will be returned by the origin server.
![](https://main.qcloudimg.com/raw/bc140f9d8257208785910d0a5c452adc/diagnose11.png)
 3. If an exceptional status code is generated at this time, you can compare the origin server status code and file MD5 value against those returned by the access module to determine whether the exception is caused by a CDN node or by the origin server, and then fix the problem accordingly.

>If the diagnosis report cannot help you solve the problem, please [submit a ticket](https://console.cloud.tencent.com/workorder/category) or contact Tencent Cloud technical support.

